/data/happythgus/LDA/DC
/data/opt/anaconda3/bin/python
moana-r3
/data/happythgus/LDA/DC/main.py:91: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
/data/happythgus/LDA/DC/main.py:91: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at ../torch/csrc/utils/tensor_new.cpp:245.)
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
eval_it_pool:  [0, 500, 1000]
Files already downloaded and verified
Files already downloaded and verified

================== Exp 0 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7fa1146ebc40>, 'dsa': False}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-17 03:20:45] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-17 03:20:49] Evaluate_00: epoch = 0300 train time = 2 s train loss = 0.003751 train acc = 1.0000, test acc = 0.0759
[2023-10-17 03:20:52] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.003778 train acc = 1.0000, test acc = 0.0675
[2023-10-17 03:20:55] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.003748 train acc = 1.0000, test acc = 0.0468
[2023-10-17 03:20:58] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.003765 train acc = 1.0000, test acc = 0.0767
[2023-10-17 03:21:01] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.003729 train acc = 1.0000, test acc = 0.0780
[2023-10-17 03:21:04] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.003661 train acc = 1.0000, test acc = 0.0686
[2023-10-17 03:21:07] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.003672 train acc = 1.0000, test acc = 0.0822
[2023-10-17 03:21:10] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.003637 train acc = 1.0000, test acc = 0.0823
[2023-10-17 03:21:14] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.003698 train acc = 1.0000, test acc = 0.0597
[2023-10-17 03:21:17] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.003645 train acc = 1.0000, test acc = 0.0879
[2023-10-17 03:21:20] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.003721 train acc = 1.0000, test acc = 0.0655
[2023-10-17 03:21:23] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.003736 train acc = 1.0000, test acc = 0.0725
[2023-10-17 03:21:26] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.003678 train acc = 1.0000, test acc = 0.0644
[2023-10-17 03:21:29] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.003555 train acc = 1.0000, test acc = 0.0518
[2023-10-17 03:21:32] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.003610 train acc = 1.0000, test acc = 0.0675
[2023-10-17 03:21:35] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.003783 train acc = 1.0000, test acc = 0.0738
[2023-10-17 03:21:38] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.003732 train acc = 1.0000, test acc = 0.0744
[2023-10-17 03:21:41] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.003573 train acc = 1.0000, test acc = 0.0868
[2023-10-17 03:21:44] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.003672 train acc = 1.0000, test acc = 0.0690
[2023-10-17 03:21:47] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.003684 train acc = 1.0000, test acc = 0.0691
Evaluate 20 random ConvNet, mean = 0.0710 std = 0.0103
-------------------------
[2023-10-17 03:21:51] iter = 0000, loss = 268.9394
[2023-10-17 03:22:30] iter = 0010, loss = 217.6257
[2023-10-17 03:23:09] iter = 0020, loss = 195.1775
[2023-10-17 03:23:48] iter = 0030, loss = 171.1387
[2023-10-17 03:24:27] iter = 0040, loss = 150.5803
[2023-10-17 03:25:06] iter = 0050, loss = 135.5056
[2023-10-17 03:25:45] iter = 0060, loss = 127.7748
[2023-10-17 03:26:23] iter = 0070, loss = 114.5654
[2023-10-17 03:27:02] iter = 0080, loss = 109.7871
[2023-10-17 03:27:41] iter = 0090, loss = 108.8137
[2023-10-17 03:28:19] iter = 0100, loss = 100.8077
[2023-10-17 03:28:58] iter = 0110, loss = 94.6466
[2023-10-17 03:29:37] iter = 0120, loss = 99.9297
[2023-10-17 03:30:16] iter = 0130, loss = 92.3303
[2023-10-17 03:30:55] iter = 0140, loss = 91.2484
[2023-10-17 03:31:33] iter = 0150, loss = 87.3495
[2023-10-17 03:32:12] iter = 0160, loss = 78.7971
[2023-10-17 03:32:51] iter = 0170, loss = 74.3023
[2023-10-17 03:33:30] iter = 0180, loss = 82.4454
[2023-10-17 03:34:09] iter = 0190, loss = 78.0515
[2023-10-17 03:34:48] iter = 0200, loss = 73.6214
[2023-10-17 03:35:27] iter = 0210, loss = 71.5131
[2023-10-17 03:36:05] iter = 0220, loss = 68.0617
[2023-10-17 03:36:44] iter = 0230, loss = 69.9431
[2023-10-17 03:37:23] iter = 0240, loss = 71.5818
[2023-10-17 03:38:02] iter = 0250, loss = 67.3588
[2023-10-17 03:38:41] iter = 0260, loss = 66.6615
[2023-10-17 03:39:19] iter = 0270, loss = 64.4095
[2023-10-17 03:39:58] iter = 0280, loss = 66.2721
[2023-10-17 03:40:37] iter = 0290, loss = 63.6857
[2023-10-17 03:41:16] iter = 0300, loss = 67.7685
[2023-10-17 03:41:55] iter = 0310, loss = 65.2577
[2023-10-17 03:42:33] iter = 0320, loss = 61.6133
[2023-10-17 03:43:12] iter = 0330, loss = 62.0275
[2023-10-17 03:43:51] iter = 0340, loss = 61.2159
[2023-10-17 03:44:30] iter = 0350, loss = 63.7845
[2023-10-17 03:45:09] iter = 0360, loss = 62.3261
[2023-10-17 03:45:48] iter = 0370, loss = 62.2870
[2023-10-17 03:46:27] iter = 0380, loss = 61.3732
[2023-10-17 03:47:06] iter = 0390, loss = 60.6448
[2023-10-17 03:47:44] iter = 0400, loss = 58.0189
[2023-10-17 03:48:23] iter = 0410, loss = 58.9128
[2023-10-17 03:49:02] iter = 0420, loss = 56.3640
[2023-10-17 03:49:41] iter = 0430, loss = 58.8681
[2023-10-17 03:50:20] iter = 0440, loss = 57.7057
[2023-10-17 03:50:59] iter = 0450, loss = 59.1944
[2023-10-17 03:51:38] iter = 0460, loss = 60.7986
[2023-10-17 03:52:17] iter = 0470, loss = 58.0503
[2023-10-17 03:52:55] iter = 0480, loss = 59.1243
[2023-10-17 03:53:34] iter = 0490, loss = 55.5805
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-17 03:54:12] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.008597 train acc = 1.0000, test acc = 0.3886
[2023-10-17 03:54:15] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.008757 train acc = 1.0000, test acc = 0.3956
[2023-10-17 03:54:19] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.008847 train acc = 1.0000, test acc = 0.3932
[2023-10-17 03:54:22] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.008810 train acc = 1.0000, test acc = 0.3878
[2023-10-17 03:54:25] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.008831 train acc = 1.0000, test acc = 0.4025
[2023-10-17 03:54:28] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.009199 train acc = 1.0000, test acc = 0.3787
[2023-10-17 03:54:31] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.009074 train acc = 1.0000, test acc = 0.3959
[2023-10-17 03:54:34] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.008653 train acc = 1.0000, test acc = 0.3916
[2023-10-17 03:54:37] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.009036 train acc = 1.0000, test acc = 0.3849
[2023-10-17 03:54:40] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.008719 train acc = 1.0000, test acc = 0.3833
[2023-10-17 03:54:43] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.008700 train acc = 1.0000, test acc = 0.4024
[2023-10-17 03:54:46] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.008585 train acc = 1.0000, test acc = 0.3814
[2023-10-17 03:54:49] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.008854 train acc = 1.0000, test acc = 0.3921
[2023-10-17 03:54:52] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.008495 train acc = 1.0000, test acc = 0.4007
[2023-10-17 03:54:56] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.008787 train acc = 1.0000, test acc = 0.3916
[2023-10-17 03:54:59] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.008924 train acc = 1.0000, test acc = 0.3964
[2023-10-17 03:55:02] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.008579 train acc = 1.0000, test acc = 0.3889
[2023-10-17 03:55:05] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.009118 train acc = 1.0000, test acc = 0.4009
[2023-10-17 03:55:08] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.008642 train acc = 1.0000, test acc = 0.3890
[2023-10-17 03:55:11] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.008727 train acc = 1.0000, test acc = 0.3795
Evaluate 20 random ConvNet, mean = 0.3912 std = 0.0072
-------------------------
[2023-10-17 03:55:15] iter = 0500, loss = 58.1958
[2023-10-17 03:55:54] iter = 0510, loss = 56.4912
[2023-10-17 03:56:32] iter = 0520, loss = 57.0470
[2023-10-17 03:57:11] iter = 0530, loss = 58.9368
[2023-10-17 03:57:50] iter = 0540, loss = 56.5087
[2023-10-17 03:58:29] iter = 0550, loss = 55.8149
[2023-10-17 03:59:08] iter = 0560, loss = 56.1526
[2023-10-17 03:59:46] iter = 0570, loss = 53.8019
[2023-10-17 04:00:25] iter = 0580, loss = 54.7859
[2023-10-17 04:01:04] iter = 0590, loss = 56.1973
[2023-10-17 04:01:43] iter = 0600, loss = 53.1872
[2023-10-17 04:02:22] iter = 0610, loss = 57.8928
[2023-10-17 04:03:00] iter = 0620, loss = 54.0438
[2023-10-17 04:03:39] iter = 0630, loss = 55.9257
[2023-10-17 04:04:18] iter = 0640, loss = 53.5718
[2023-10-17 04:04:57] iter = 0650, loss = 52.3443
[2023-10-17 04:05:35] iter = 0660, loss = 51.5505
[2023-10-17 04:06:14] iter = 0670, loss = 54.3586
[2023-10-17 04:06:53] iter = 0680, loss = 54.4722
[2023-10-17 04:07:32] iter = 0690, loss = 53.4979
[2023-10-17 04:08:11] iter = 0700, loss = 51.6059
[2023-10-17 04:08:50] iter = 0710, loss = 52.8276
[2023-10-17 04:09:28] iter = 0720, loss = 53.9959
[2023-10-17 04:10:07] iter = 0730, loss = 52.4137
[2023-10-17 04:10:46] iter = 0740, loss = 55.8962
[2023-10-17 04:11:25] iter = 0750, loss = 54.3663
[2023-10-17 04:12:04] iter = 0760, loss = 51.0184
[2023-10-17 04:12:42] iter = 0770, loss = 57.3262
[2023-10-17 04:13:21] iter = 0780, loss = 52.8692
[2023-10-17 04:14:00] iter = 0790, loss = 52.0552
[2023-10-17 04:14:39] iter = 0800, loss = 54.3487
[2023-10-17 04:15:17] iter = 0810, loss = 48.8107
[2023-10-17 04:15:56] iter = 0820, loss = 55.9800
[2023-10-17 04:16:35] iter = 0830, loss = 55.3454
[2023-10-17 04:17:14] iter = 0840, loss = 53.7247
[2023-10-17 04:17:53] iter = 0850, loss = 51.7614
[2023-10-17 04:18:31] iter = 0860, loss = 55.7411
[2023-10-17 04:19:10] iter = 0870, loss = 53.1364
[2023-10-17 04:19:49] iter = 0880, loss = 51.3211
[2023-10-17 04:20:28] iter = 0890, loss = 49.3064
[2023-10-17 04:21:06] iter = 0900, loss = 54.7274
[2023-10-17 04:21:45] iter = 0910, loss = 51.3733
[2023-10-17 04:22:24] iter = 0920, loss = 49.9240
[2023-10-17 04:23:03] iter = 0930, loss = 47.8145
[2023-10-17 04:23:42] iter = 0940, loss = 48.9372
[2023-10-17 04:24:20] iter = 0950, loss = 52.6235
[2023-10-17 04:24:59] iter = 0960, loss = 55.2308
[2023-10-17 04:25:38] iter = 0970, loss = 51.1943
[2023-10-17 04:26:17] iter = 0980, loss = 53.4960
[2023-10-17 04:26:56] iter = 0990, loss = 50.8266
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-17 04:27:33] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.008407 train acc = 1.0000, test acc = 0.4342
[2023-10-17 04:27:37] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.008831 train acc = 1.0000, test acc = 0.4117
[2023-10-17 04:27:40] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.008821 train acc = 1.0000, test acc = 0.4126
[2023-10-17 04:27:43] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.008808 train acc = 1.0000, test acc = 0.4148
[2023-10-17 04:27:46] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.008562 train acc = 1.0000, test acc = 0.4049
[2023-10-17 04:27:49] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.008874 train acc = 1.0000, test acc = 0.4128
[2023-10-17 04:27:52] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.008500 train acc = 1.0000, test acc = 0.4247
[2023-10-17 04:27:55] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.008617 train acc = 1.0000, test acc = 0.4181
[2023-10-17 04:27:58] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.008866 train acc = 1.0000, test acc = 0.4293
[2023-10-17 04:28:01] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.008828 train acc = 1.0000, test acc = 0.4033
[2023-10-17 04:28:04] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.008654 train acc = 1.0000, test acc = 0.4128
[2023-10-17 04:28:07] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.008662 train acc = 1.0000, test acc = 0.4135
[2023-10-17 04:28:10] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.008617 train acc = 1.0000, test acc = 0.4068
[2023-10-17 04:28:14] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.008908 train acc = 1.0000, test acc = 0.4241
[2023-10-17 04:28:17] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.008830 train acc = 1.0000, test acc = 0.4258
[2023-10-17 04:28:20] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.008715 train acc = 1.0000, test acc = 0.4221
[2023-10-17 04:28:23] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.008603 train acc = 1.0000, test acc = 0.4195
[2023-10-17 04:28:26] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.009055 train acc = 1.0000, test acc = 0.4149
[2023-10-17 04:28:29] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.008809 train acc = 1.0000, test acc = 0.4224
[2023-10-17 04:28:32] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.008807 train acc = 1.0000, test acc = 0.4019
Evaluate 20 random ConvNet, mean = 0.4165 std = 0.0086
-------------------------
[2023-10-17 04:28:36] iter = 1000, loss = 52.0576

================== Exp 1 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7fa1146ebc40>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-17 04:28:54] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-17 04:28:57] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.003731 train acc = 1.0000, test acc = 0.1373
[2023-10-17 04:29:00] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.003676 train acc = 1.0000, test acc = 0.1256
[2023-10-17 04:29:03] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.003655 train acc = 1.0000, test acc = 0.1342
[2023-10-17 04:29:06] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.003698 train acc = 1.0000, test acc = 0.1345
[2023-10-17 04:29:09] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.003692 train acc = 1.0000, test acc = 0.1211
[2023-10-17 04:29:12] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.003704 train acc = 1.0000, test acc = 0.1245
[2023-10-17 04:29:15] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.003630 train acc = 1.0000, test acc = 0.1308
[2023-10-17 04:29:18] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.003760 train acc = 1.0000, test acc = 0.1391
[2023-10-17 04:29:21] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.003662 train acc = 1.0000, test acc = 0.1308
[2023-10-17 04:29:24] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.003728 train acc = 1.0000, test acc = 0.1328
[2023-10-17 04:29:27] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.003790 train acc = 1.0000, test acc = 0.1233
[2023-10-17 04:29:30] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.003666 train acc = 1.0000, test acc = 0.1346
[2023-10-17 04:29:33] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.003603 train acc = 1.0000, test acc = 0.1092
[2023-10-17 04:29:37] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.003626 train acc = 1.0000, test acc = 0.1317
[2023-10-17 04:29:40] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.003681 train acc = 1.0000, test acc = 0.1321
[2023-10-17 04:29:43] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.003679 train acc = 1.0000, test acc = 0.1353
[2023-10-17 04:29:46] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.003733 train acc = 1.0000, test acc = 0.1335
[2023-10-17 04:29:49] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.003720 train acc = 1.0000, test acc = 0.1303
[2023-10-17 04:29:52] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.003748 train acc = 1.0000, test acc = 0.1243
[2023-10-17 04:29:55] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.003716 train acc = 1.0000, test acc = 0.1108
Evaluate 20 random ConvNet, mean = 0.1288 std = 0.0078
-------------------------
[2023-10-17 04:29:59] iter = 0000, loss = 249.5147
[2023-10-17 04:30:38] iter = 0010, loss = 212.3158
[2023-10-17 04:31:16] iter = 0020, loss = 188.7632
[2023-10-17 04:31:55] iter = 0030, loss = 170.8386
[2023-10-17 04:32:34] iter = 0040, loss = 150.8457
[2023-10-17 04:33:13] iter = 0050, loss = 135.0598
[2023-10-17 04:33:52] iter = 0060, loss = 125.0036
[2023-10-17 04:34:30] iter = 0070, loss = 114.0613
[2023-10-17 04:35:09] iter = 0080, loss = 114.8334
[2023-10-17 04:35:48] iter = 0090, loss = 106.0739
[2023-10-17 04:36:27] iter = 0100, loss = 105.4708
[2023-10-17 04:37:05] iter = 0110, loss = 98.2788
[2023-10-17 04:37:44] iter = 0120, loss = 99.0482
[2023-10-17 04:38:23] iter = 0130, loss = 93.9658
[2023-10-17 04:39:02] iter = 0140, loss = 92.9037
[2023-10-17 04:39:41] iter = 0150, loss = 85.9092
[2023-10-17 04:40:20] iter = 0160, loss = 80.8535
[2023-10-17 04:40:59] iter = 0170, loss = 80.1432
[2023-10-17 04:41:37] iter = 0180, loss = 82.6074
[2023-10-17 04:42:16] iter = 0190, loss = 75.8733
[2023-10-17 04:42:55] iter = 0200, loss = 77.1404
[2023-10-17 04:43:34] iter = 0210, loss = 75.0837
[2023-10-17 04:44:13] iter = 0220, loss = 66.5684
[2023-10-17 04:44:52] iter = 0230, loss = 67.1029
[2023-10-17 04:45:31] iter = 0240, loss = 69.2181
[2023-10-17 04:46:09] iter = 0250, loss = 69.5914
[2023-10-17 04:46:48] iter = 0260, loss = 63.0653
[2023-10-17 04:47:28] iter = 0270, loss = 63.5677
[2023-10-17 04:48:06] iter = 0280, loss = 64.8100
[2023-10-17 04:48:46] iter = 0290, loss = 64.9148
[2023-10-17 04:49:25] iter = 0300, loss = 65.2149
[2023-10-17 04:50:03] iter = 0310, loss = 63.6161
[2023-10-17 04:50:42] iter = 0320, loss = 64.8427
[2023-10-17 04:51:21] iter = 0330, loss = 64.8647
[2023-10-17 04:51:59] iter = 0340, loss = 61.2051
[2023-10-17 04:52:38] iter = 0350, loss = 63.6670
[2023-10-17 04:53:17] iter = 0360, loss = 59.8832
[2023-10-17 04:53:55] iter = 0370, loss = 64.9047
[2023-10-17 04:54:34] iter = 0380, loss = 60.9600
[2023-10-17 04:55:13] iter = 0390, loss = 55.7582
[2023-10-17 04:55:51] iter = 0400, loss = 58.6113
[2023-10-17 04:56:30] iter = 0410, loss = 57.0851
[2023-10-17 04:57:09] iter = 0420, loss = 59.3454
[2023-10-17 04:57:47] iter = 0430, loss = 59.3098
[2023-10-17 04:58:26] iter = 0440, loss = 58.4150
[2023-10-17 04:59:05] iter = 0450, loss = 60.2765
[2023-10-17 04:59:44] iter = 0460, loss = 60.8456
[2023-10-17 05:00:23] iter = 0470, loss = 54.7507
[2023-10-17 05:01:02] iter = 0480, loss = 58.0847
[2023-10-17 05:01:41] iter = 0490, loss = 57.2428
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-17 05:02:19] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.008509 train acc = 1.0000, test acc = 0.4084
[2023-10-17 05:02:22] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.008965 train acc = 1.0000, test acc = 0.3904
[2023-10-17 05:02:25] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.009145 train acc = 1.0000, test acc = 0.3992
[2023-10-17 05:02:28] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.008507 train acc = 1.0000, test acc = 0.4064
[2023-10-17 05:02:32] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.008597 train acc = 1.0000, test acc = 0.3964
[2023-10-17 05:02:35] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.008577 train acc = 1.0000, test acc = 0.3988
[2023-10-17 05:02:38] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.008530 train acc = 1.0000, test acc = 0.4065
[2023-10-17 05:02:41] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.008877 train acc = 1.0000, test acc = 0.3968
[2023-10-17 05:02:44] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.008731 train acc = 1.0000, test acc = 0.4018
[2023-10-17 05:02:47] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.008554 train acc = 1.0000, test acc = 0.4048
[2023-10-17 05:02:50] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.008851 train acc = 1.0000, test acc = 0.3939
[2023-10-17 05:02:53] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.008584 train acc = 1.0000, test acc = 0.3966
[2023-10-17 05:02:56] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.008894 train acc = 1.0000, test acc = 0.4079
[2023-10-17 05:02:59] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.008794 train acc = 1.0000, test acc = 0.4009
[2023-10-17 05:03:02] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.008510 train acc = 1.0000, test acc = 0.3959
[2023-10-17 05:03:05] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.009043 train acc = 1.0000, test acc = 0.4014
[2023-10-17 05:03:08] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.008454 train acc = 1.0000, test acc = 0.4025
[2023-10-17 05:03:12] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.008518 train acc = 1.0000, test acc = 0.4002
[2023-10-17 05:03:15] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.008362 train acc = 1.0000, test acc = 0.4132
[2023-10-17 05:03:18] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.008154 train acc = 1.0000, test acc = 0.4078
Evaluate 20 random ConvNet, mean = 0.4015 std = 0.0056
-------------------------
[2023-10-17 05:03:22] iter = 0500, loss = 55.3359
[2023-10-17 05:04:00] iter = 0510, loss = 55.4161
[2023-10-17 05:04:39] iter = 0520, loss = 58.9351
[2023-10-17 05:05:18] iter = 0530, loss = 60.4853
[2023-10-17 05:05:57] iter = 0540, loss = 58.5981
[2023-10-17 05:06:36] iter = 0550, loss = 56.9058
[2023-10-17 05:07:15] iter = 0560, loss = 55.3644
[2023-10-17 05:07:54] iter = 0570, loss = 57.4658
[2023-10-17 05:08:32] iter = 0580, loss = 53.7512
[2023-10-17 05:09:11] iter = 0590, loss = 57.4538
[2023-10-17 05:09:50] iter = 0600, loss = 54.5690
[2023-10-17 05:10:29] iter = 0610, loss = 53.5283
[2023-10-17 05:11:08] iter = 0620, loss = 53.6243
[2023-10-17 05:11:47] iter = 0630, loss = 52.9855
[2023-10-17 05:12:26] iter = 0640, loss = 53.1180
[2023-10-17 05:13:05] iter = 0650, loss = 52.1317
[2023-10-17 05:13:43] iter = 0660, loss = 55.1261
[2023-10-17 05:14:22] iter = 0670, loss = 54.1348
[2023-10-17 05:15:01] iter = 0680, loss = 56.4770
[2023-10-17 05:15:40] iter = 0690, loss = 51.6345
[2023-10-17 05:16:19] iter = 0700, loss = 51.6067
[2023-10-17 05:16:58] iter = 0710, loss = 51.8353
[2023-10-17 05:17:37] iter = 0720, loss = 55.6750
[2023-10-17 05:18:16] iter = 0730, loss = 53.2264
[2023-10-17 05:18:54] iter = 0740, loss = 53.7529
[2023-10-17 05:19:33] iter = 0750, loss = 52.6327
[2023-10-17 05:20:12] iter = 0760, loss = 53.0523
[2023-10-17 05:20:51] iter = 0770, loss = 50.4942
[2023-10-17 05:21:30] iter = 0780, loss = 52.5639
[2023-10-17 05:22:09] iter = 0790, loss = 51.5543
[2023-10-17 05:22:48] iter = 0800, loss = 53.6680
[2023-10-17 05:23:27] iter = 0810, loss = 51.0022
[2023-10-17 05:24:06] iter = 0820, loss = 50.2796
[2023-10-17 05:24:45] iter = 0830, loss = 55.5016
[2023-10-17 05:25:23] iter = 0840, loss = 50.2790
[2023-10-17 05:26:02] iter = 0850, loss = 51.2387
[2023-10-17 05:26:41] iter = 0860, loss = 54.7700
[2023-10-17 05:27:20] iter = 0870, loss = 51.5830
[2023-10-17 05:27:59] iter = 0880, loss = 51.9696
[2023-10-17 05:28:38] iter = 0890, loss = 50.8566
[2023-10-17 05:29:17] iter = 0900, loss = 48.7564
[2023-10-17 05:29:56] iter = 0910, loss = 52.0027
[2023-10-17 05:30:35] iter = 0920, loss = 51.8370
[2023-10-17 05:31:14] iter = 0930, loss = 50.7021
[2023-10-17 05:31:53] iter = 0940, loss = 50.3325
[2023-10-17 05:32:31] iter = 0950, loss = 52.9659
[2023-10-17 05:33:10] iter = 0960, loss = 51.5828
[2023-10-17 05:33:49] iter = 0970, loss = 50.2432
[2023-10-17 05:34:28] iter = 0980, loss = 51.4156
[2023-10-17 05:35:06] iter = 0990, loss = 48.4947
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-17 05:35:44] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.009299 train acc = 1.0000, test acc = 0.4178
[2023-10-17 05:35:48] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.008636 train acc = 1.0000, test acc = 0.4147
[2023-10-17 05:35:51] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.008300 train acc = 1.0000, test acc = 0.4269
[2023-10-17 05:35:54] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.008535 train acc = 1.0000, test acc = 0.4036
[2023-10-17 05:35:57] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.008990 train acc = 1.0000, test acc = 0.4166
[2023-10-17 05:36:00] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.008899 train acc = 1.0000, test acc = 0.4187
[2023-10-17 05:36:03] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.009077 train acc = 1.0000, test acc = 0.4169
[2023-10-17 05:36:06] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.008781 train acc = 1.0000, test acc = 0.4209
[2023-10-17 05:36:09] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.008538 train acc = 1.0000, test acc = 0.4227
[2023-10-17 05:36:12] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.008520 train acc = 1.0000, test acc = 0.4365
[2023-10-17 05:36:15] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.008916 train acc = 1.0000, test acc = 0.4320
[2023-10-17 05:36:18] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.008495 train acc = 1.0000, test acc = 0.4270
[2023-10-17 05:36:21] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.008740 train acc = 1.0000, test acc = 0.4360
[2023-10-17 05:36:24] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.008922 train acc = 1.0000, test acc = 0.4110
[2023-10-17 05:36:28] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.008725 train acc = 1.0000, test acc = 0.4148
[2023-10-17 05:36:31] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.008778 train acc = 1.0000, test acc = 0.4199
[2023-10-17 05:36:34] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.008771 train acc = 1.0000, test acc = 0.4147
[2023-10-17 05:36:37] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.008564 train acc = 1.0000, test acc = 0.4221
[2023-10-17 05:36:40] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.008779 train acc = 1.0000, test acc = 0.4274
[2023-10-17 05:36:43] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.008783 train acc = 1.0000, test acc = 0.4030
Evaluate 20 random ConvNet, mean = 0.4202 std = 0.0089
-------------------------
[2023-10-17 05:36:47] iter = 1000, loss = 49.1161

================== Exp 2 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7fa1146ebc40>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-17 05:37:04] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-17 05:37:07] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.003653 train acc = 1.0000, test acc = 0.0927
[2023-10-17 05:37:10] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.003704 train acc = 1.0000, test acc = 0.0782
[2023-10-17 05:37:13] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.003590 train acc = 1.0000, test acc = 0.0851
[2023-10-17 05:37:16] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.003627 train acc = 1.0000, test acc = 0.0764
[2023-10-17 05:37:19] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.003622 train acc = 1.0000, test acc = 0.0825
[2023-10-17 05:37:23] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.003693 train acc = 1.0000, test acc = 0.0828
[2023-10-17 05:37:26] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.003641 train acc = 1.0000, test acc = 0.0939
[2023-10-17 05:37:29] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.003737 train acc = 1.0000, test acc = 0.0662
[2023-10-17 05:37:32] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.003626 train acc = 1.0000, test acc = 0.0830
[2023-10-17 05:37:35] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.003779 train acc = 1.0000, test acc = 0.0817
[2023-10-17 05:37:38] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.003679 train acc = 1.0000, test acc = 0.0947
[2023-10-17 05:37:41] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.003792 train acc = 1.0000, test acc = 0.0777
[2023-10-17 05:37:44] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.003647 train acc = 1.0000, test acc = 0.0871
[2023-10-17 05:37:47] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.003705 train acc = 1.0000, test acc = 0.0790
[2023-10-17 05:37:50] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.003586 train acc = 1.0000, test acc = 0.0881
[2023-10-17 05:37:53] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.003765 train acc = 1.0000, test acc = 0.1021
[2023-10-17 05:37:56] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.003604 train acc = 1.0000, test acc = 0.0921
[2023-10-17 05:37:59] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.003702 train acc = 1.0000, test acc = 0.0941
[2023-10-17 05:38:02] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.003677 train acc = 1.0000, test acc = 0.0857
[2023-10-17 05:38:06] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.003630 train acc = 1.0000, test acc = 0.0845
Evaluate 20 random ConvNet, mean = 0.0854 std = 0.0079
-------------------------
[2023-10-17 05:38:09] iter = 0000, loss = 260.0399
[2023-10-17 05:38:48] iter = 0010, loss = 204.6806
[2023-10-17 05:39:27] iter = 0020, loss = 190.1824
[2023-10-17 05:40:06] iter = 0030, loss = 172.1606
[2023-10-17 05:40:45] iter = 0040, loss = 156.4847
[2023-10-17 05:41:24] iter = 0050, loss = 136.4070
[2023-10-17 05:42:03] iter = 0060, loss = 140.1084
[2023-10-17 05:42:42] iter = 0070, loss = 119.0909
[2023-10-17 05:43:21] iter = 0080, loss = 114.7296
[2023-10-17 05:43:59] iter = 0090, loss = 107.4323
[2023-10-17 05:44:46] iter = 0100, loss = 99.8521
[2023-10-17 05:45:25] iter = 0110, loss = 91.3863
[2023-10-17 05:46:04] iter = 0120, loss = 88.6979
[2023-10-17 05:46:43] iter = 0130, loss = 88.6414
[2023-10-17 05:47:21] iter = 0140, loss = 87.0762
[2023-10-17 05:48:00] iter = 0150, loss = 82.2878
[2023-10-17 05:48:39] iter = 0160, loss = 77.9383
[2023-10-17 05:49:18] iter = 0170, loss = 77.1225
[2023-10-17 05:49:57] iter = 0180, loss = 77.9931
[2023-10-17 05:50:36] iter = 0190, loss = 73.7749
[2023-10-17 05:51:15] iter = 0200, loss = 75.9848
[2023-10-17 05:51:53] iter = 0210, loss = 70.2949
[2023-10-17 05:52:32] iter = 0220, loss = 70.8287
[2023-10-17 05:53:11] iter = 0230, loss = 72.0898
[2023-10-17 05:53:50] iter = 0240, loss = 67.3410
[2023-10-17 05:54:29] iter = 0250, loss = 65.1989
[2023-10-17 05:55:08] iter = 0260, loss = 66.4550
[2023-10-17 05:55:47] iter = 0270, loss = 68.1040
[2023-10-17 05:56:26] iter = 0280, loss = 62.1779
[2023-10-17 05:57:17] iter = 0290, loss = 65.3443
[2023-10-17 05:57:56] iter = 0300, loss = 63.1966
[2023-10-17 05:58:35] iter = 0310, loss = 67.2191
[2023-10-17 05:59:13] iter = 0320, loss = 61.0585
[2023-10-17 05:59:52] iter = 0330, loss = 59.6366
[2023-10-17 06:00:31] iter = 0340, loss = 61.8797
[2023-10-17 06:01:10] iter = 0350, loss = 64.1475
[2023-10-17 06:01:49] iter = 0360, loss = 61.4901
[2023-10-17 06:02:28] iter = 0370, loss = 59.3843
[2023-10-17 06:03:07] iter = 0380, loss = 58.0243
[2023-10-17 06:03:46] iter = 0390, loss = 61.0345
[2023-10-17 06:04:25] iter = 0400, loss = 56.5053
[2023-10-17 06:05:04] iter = 0410, loss = 62.1066
[2023-10-17 06:05:42] iter = 0420, loss = 55.5982
[2023-10-17 06:06:21] iter = 0430, loss = 56.8848
[2023-10-17 06:07:00] iter = 0440, loss = 59.3828
[2023-10-17 06:07:39] iter = 0450, loss = 54.7627
[2023-10-17 06:08:18] iter = 0460, loss = 56.6307
[2023-10-17 06:08:57] iter = 0470, loss = 57.4347
[2023-10-17 06:09:35] iter = 0480, loss = 58.1286
[2023-10-17 06:10:14] iter = 0490, loss = 56.9345
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-17 06:10:52] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.009074 train acc = 1.0000, test acc = 0.3853
[2023-10-17 06:10:55] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.008832 train acc = 1.0000, test acc = 0.3969
[2023-10-17 06:10:59] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.009309 train acc = 1.0000, test acc = 0.4140
[2023-10-17 06:11:02] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.009147 train acc = 1.0000, test acc = 0.4017
[2023-10-17 06:11:05] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.009008 train acc = 1.0000, test acc = 0.3905
[2023-10-17 06:11:08] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.008682 train acc = 1.0000, test acc = 0.3908
[2023-10-17 06:11:11] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.008826 train acc = 1.0000, test acc = 0.3925
[2023-10-17 06:11:14] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.009025 train acc = 1.0000, test acc = 0.4025
[2023-10-17 06:11:17] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.009079 train acc = 1.0000, test acc = 0.4016
[2023-10-17 06:11:20] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.008675 train acc = 1.0000, test acc = 0.3990
[2023-10-17 06:11:23] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.009211 train acc = 1.0000, test acc = 0.3871
[2023-10-17 06:11:26] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.008774 train acc = 1.0000, test acc = 0.3883
[2023-10-17 06:11:29] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.008830 train acc = 1.0000, test acc = 0.3907
[2023-10-17 06:11:32] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.008669 train acc = 1.0000, test acc = 0.3938
[2023-10-17 06:11:35] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.008982 train acc = 1.0000, test acc = 0.3922
[2023-10-17 06:11:39] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.009140 train acc = 1.0000, test acc = 0.3869
[2023-10-17 06:11:42] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.009254 train acc = 1.0000, test acc = 0.3759
[2023-10-17 06:11:45] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.009061 train acc = 1.0000, test acc = 0.4037
[2023-10-17 06:11:48] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.009107 train acc = 1.0000, test acc = 0.3990
[2023-10-17 06:11:51] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.008838 train acc = 1.0000, test acc = 0.3907
Evaluate 20 random ConvNet, mean = 0.3942 std = 0.0081
-------------------------
[2023-10-17 06:11:55] iter = 0500, loss = 57.6516
[2023-10-17 06:12:33] iter = 0510, loss = 55.1560
[2023-10-17 06:13:12] iter = 0520, loss = 53.8544
[2023-10-17 06:13:51] iter = 0530, loss = 51.4788
[2023-10-17 06:14:30] iter = 0540, loss = 58.1427
[2023-10-17 06:15:10] iter = 0550, loss = 58.5612
[2023-10-17 06:15:59] iter = 0560, loss = 55.7858
[2023-10-17 06:16:37] iter = 0570, loss = 54.3875
[2023-10-17 06:17:16] iter = 0580, loss = 53.7583
[2023-10-17 06:17:55] iter = 0590, loss = 52.9625
[2023-10-17 06:19:06] iter = 0600, loss = 53.4629
[2023-10-17 06:20:19] iter = 0610, loss = 54.2830
[2023-10-17 06:21:32] iter = 0620, loss = 52.7101
[2023-10-17 06:22:25] iter = 0630, loss = 54.8161
[2023-10-17 06:23:04] iter = 0640, loss = 54.4216
[2023-10-17 06:24:08] iter = 0650, loss = 55.5546
[2023-10-17 06:25:22] iter = 0660, loss = 52.7430
[2023-10-17 06:26:35] iter = 0670, loss = 54.4618
[2023-10-17 06:27:49] iter = 0680, loss = 53.9520
[2023-10-17 06:29:02] iter = 0690, loss = 55.2071
[2023-10-17 06:30:16] iter = 0700, loss = 52.7611
[2023-10-17 06:31:29] iter = 0710, loss = 53.5628
[2023-10-17 06:32:31] iter = 0720, loss = 54.7303
[2023-10-17 06:33:31] iter = 0730, loss = 55.9976
[2023-10-17 06:34:45] iter = 0740, loss = 57.8427
[2023-10-17 06:35:58] iter = 0750, loss = 52.7121
[2023-10-17 06:37:12] iter = 0760, loss = 52.1804
[2023-10-17 06:38:25] iter = 0770, loss = 53.1947
[2023-10-17 06:39:39] iter = 0780, loss = 53.3817
[2023-10-17 06:40:53] iter = 0790, loss = 53.1111
[2023-10-17 06:42:03] iter = 0800, loss = 52.8524
[2023-10-17 06:43:01] iter = 0810, loss = 51.1714
[2023-10-17 06:44:08] iter = 0820, loss = 50.7665
[2023-10-17 06:45:21] iter = 0830, loss = 52.0882
[2023-10-17 06:46:35] iter = 0840, loss = 50.7747
[2023-10-17 06:47:49] iter = 0850, loss = 48.7110
[2023-10-17 06:49:01] iter = 0860, loss = 55.1705
[2023-10-17 06:50:16] iter = 0870, loss = 51.9452
[2023-10-17 06:51:29] iter = 0880, loss = 52.1399
[2023-10-17 06:52:34] iter = 0890, loss = 50.5619
[2023-10-17 06:53:31] iter = 0900, loss = 48.4404
[2023-10-17 06:54:44] iter = 0910, loss = 49.6946
[2023-10-17 06:55:57] iter = 0920, loss = 49.4478
[2023-10-17 06:57:10] iter = 0930, loss = 49.2482
[2023-10-17 06:58:23] iter = 0940, loss = 52.4003
[2023-10-17 06:59:36] iter = 0950, loss = 48.8327
[2023-10-17 07:00:49] iter = 0960, loss = 51.9721
[2023-10-17 07:02:03] iter = 0970, loss = 48.5027
[2023-10-17 07:03:01] iter = 0980, loss = 49.7422
[2023-10-17 07:04:04] iter = 0990, loss = 49.0574
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-17 07:05:14] Evaluate_00: epoch = 0300 train time = 2 s train loss = 0.008703 train acc = 1.0000, test acc = 0.4147
[2023-10-17 07:05:18] Evaluate_01: epoch = 0300 train time = 2 s train loss = 0.009030 train acc = 1.0000, test acc = 0.4191
[2023-10-17 07:05:22] Evaluate_02: epoch = 0300 train time = 2 s train loss = 0.009164 train acc = 1.0000, test acc = 0.4062
[2023-10-17 07:05:26] Evaluate_03: epoch = 0300 train time = 2 s train loss = 0.009285 train acc = 1.0000, test acc = 0.4355
[2023-10-17 07:05:31] Evaluate_04: epoch = 0300 train time = 2 s train loss = 0.009537 train acc = 1.0000, test acc = 0.4285
[2023-10-17 07:05:35] Evaluate_05: epoch = 0300 train time = 2 s train loss = 0.009017 train acc = 1.0000, test acc = 0.4106
[2023-10-17 07:05:39] Evaluate_06: epoch = 0300 train time = 2 s train loss = 0.008799 train acc = 1.0000, test acc = 0.4200
[2023-10-17 07:05:43] Evaluate_07: epoch = 0300 train time = 2 s train loss = 0.009292 train acc = 1.0000, test acc = 0.4173
[2023-10-17 07:05:47] Evaluate_08: epoch = 0300 train time = 2 s train loss = 0.009111 train acc = 1.0000, test acc = 0.4160
[2023-10-17 07:05:51] Evaluate_09: epoch = 0300 train time = 2 s train loss = 0.008722 train acc = 1.0000, test acc = 0.4210
[2023-10-17 07:05:55] Evaluate_10: epoch = 0300 train time = 2 s train loss = 0.009148 train acc = 1.0000, test acc = 0.4192
[2023-10-17 07:05:59] Evaluate_11: epoch = 0300 train time = 2 s train loss = 0.009475 train acc = 1.0000, test acc = 0.4046
[2023-10-17 07:06:04] Evaluate_12: epoch = 0300 train time = 2 s train loss = 0.008532 train acc = 1.0000, test acc = 0.4371
[2023-10-17 07:06:08] Evaluate_13: epoch = 0300 train time = 2 s train loss = 0.008434 train acc = 1.0000, test acc = 0.4287
[2023-10-17 07:06:12] Evaluate_14: epoch = 0300 train time = 2 s train loss = 0.009549 train acc = 1.0000, test acc = 0.4175
[2023-10-17 07:06:16] Evaluate_15: epoch = 0300 train time = 2 s train loss = 0.009375 train acc = 1.0000, test acc = 0.4051
[2023-10-17 07:06:20] Evaluate_16: epoch = 0300 train time = 2 s train loss = 0.008943 train acc = 1.0000, test acc = 0.4141
[2023-10-17 07:06:24] Evaluate_17: epoch = 0300 train time = 2 s train loss = 0.008959 train acc = 1.0000, test acc = 0.4189
[2023-10-17 07:06:28] Evaluate_18: epoch = 0300 train time = 2 s train loss = 0.009301 train acc = 1.0000, test acc = 0.4074
[2023-10-17 07:06:32] Evaluate_19: epoch = 0300 train time = 2 s train loss = 0.008682 train acc = 1.0000, test acc = 0.4245
Evaluate 20 random ConvNet, mean = 0.4183 std = 0.0090
-------------------------
[2023-10-17 07:06:40] iter = 1000, loss = 53.2335

================== Exp 3 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7fa1146ebc40>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-17 07:06:57] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-17 07:07:01] Evaluate_00: epoch = 0300 train time = 2 s train loss = 0.003527 train acc = 1.0000, test acc = 0.1293
[2023-10-17 07:07:05] Evaluate_01: epoch = 0300 train time = 2 s train loss = 0.003728 train acc = 1.0000, test acc = 0.0905
[2023-10-17 07:07:09] Evaluate_02: epoch = 0300 train time = 2 s train loss = 0.003718 train acc = 1.0000, test acc = 0.0859
[2023-10-17 07:07:13] Evaluate_03: epoch = 0300 train time = 2 s train loss = 0.003673 train acc = 1.0000, test acc = 0.1152
[2023-10-17 07:07:17] Evaluate_04: epoch = 0300 train time = 2 s train loss = 0.003641 train acc = 1.0000, test acc = 0.1029
[2023-10-17 07:07:21] Evaluate_05: epoch = 0300 train time = 2 s train loss = 0.003632 train acc = 1.0000, test acc = 0.1197
[2023-10-17 07:07:26] Evaluate_06: epoch = 0300 train time = 2 s train loss = 0.003683 train acc = 1.0000, test acc = 0.1108
[2023-10-17 07:07:30] Evaluate_07: epoch = 0300 train time = 2 s train loss = 0.003700 train acc = 1.0000, test acc = 0.0915
[2023-10-17 07:07:34] Evaluate_08: epoch = 0300 train time = 2 s train loss = 0.003614 train acc = 1.0000, test acc = 0.1211
[2023-10-17 07:07:38] Evaluate_09: epoch = 0300 train time = 2 s train loss = 0.003664 train acc = 1.0000, test acc = 0.0903
[2023-10-17 07:07:42] Evaluate_10: epoch = 0300 train time = 2 s train loss = 0.003641 train acc = 1.0000, test acc = 0.1020
[2023-10-17 07:07:46] Evaluate_11: epoch = 0300 train time = 2 s train loss = 0.003593 train acc = 1.0000, test acc = 0.1111
[2023-10-17 07:07:50] Evaluate_12: epoch = 0300 train time = 2 s train loss = 0.003601 train acc = 1.0000, test acc = 0.1070
[2023-10-17 07:07:55] Evaluate_13: epoch = 0300 train time = 2 s train loss = 0.003691 train acc = 1.0000, test acc = 0.1135
[2023-10-17 07:07:59] Evaluate_14: epoch = 0300 train time = 2 s train loss = 0.003749 train acc = 1.0000, test acc = 0.1207
[2023-10-17 07:08:03] Evaluate_15: epoch = 0300 train time = 2 s train loss = 0.003634 train acc = 1.0000, test acc = 0.1018
[2023-10-17 07:08:07] Evaluate_16: epoch = 0300 train time = 2 s train loss = 0.003688 train acc = 1.0000, test acc = 0.0907
[2023-10-17 07:08:11] Evaluate_17: epoch = 0300 train time = 2 s train loss = 0.003630 train acc = 1.0000, test acc = 0.0946
[2023-10-17 07:08:16] Evaluate_18: epoch = 0300 train time = 2 s train loss = 0.003600 train acc = 1.0000, test acc = 0.1218
[2023-10-17 07:08:20] Evaluate_19: epoch = 0300 train time = 2 s train loss = 0.003720 train acc = 1.0000, test acc = 0.0997
Evaluate 20 random ConvNet, mean = 0.1060 std = 0.0126
-------------------------
[2023-10-17 07:08:27] iter = 0000, loss = 256.8933
[2023-10-17 07:09:40] iter = 0010, loss = 206.2869
[2023-10-17 07:10:53] iter = 0020, loss = 179.1155
[2023-10-17 07:12:02] iter = 0030, loss = 171.6761
[2023-10-17 07:13:00] iter = 0040, loss = 152.9208
[2023-10-17 07:14:08] iter = 0050, loss = 137.8251
[2023-10-17 07:15:21] iter = 0060, loss = 125.6915
[2023-10-17 07:16:34] iter = 0070, loss = 112.5228
[2023-10-17 07:17:47] iter = 0080, loss = 114.6872
[2023-10-17 07:19:01] iter = 0090, loss = 101.9465
[2023-10-17 07:20:15] iter = 0100, loss = 97.9239
[2023-10-17 07:21:28] iter = 0110, loss = 93.0645
[2023-10-17 07:22:32] iter = 0120, loss = 94.8168
[2023-10-17 07:23:30] iter = 0130, loss = 85.2467
[2023-10-17 07:24:43] iter = 0140, loss = 87.7726
[2023-10-17 07:25:56] iter = 0150, loss = 85.8292
[2023-10-17 07:27:09] iter = 0160, loss = 82.5635
[2023-10-17 07:28:22] iter = 0170, loss = 78.4283
[2023-10-17 07:29:35] iter = 0180, loss = 78.8743
[2023-10-17 07:30:48] iter = 0190, loss = 76.9925
[2023-10-17 07:32:01] iter = 0200, loss = 70.1692
[2023-10-17 07:33:00] iter = 0210, loss = 75.8828
[2023-10-17 07:34:03] iter = 0220, loss = 70.2685
[2023-10-17 07:35:16] iter = 0230, loss = 71.0175
[2023-10-17 07:36:28] iter = 0240, loss = 67.3084
[2023-10-17 07:37:41] iter = 0250, loss = 64.2393
[2023-10-17 07:38:55] iter = 0260, loss = 69.3019
[2023-10-17 07:40:09] iter = 0270, loss = 67.6357
[2023-10-17 07:41:23] iter = 0280, loss = 64.3761
[2023-10-17 07:42:31] iter = 0290, loss = 68.5360
[2023-10-17 07:43:29] iter = 0300, loss = 64.0224
[2023-10-17 07:44:37] iter = 0310, loss = 67.5959
[2023-10-17 07:45:51] iter = 0320, loss = 62.1412
[2023-10-17 07:47:03] iter = 0330, loss = 62.8003
[2023-10-17 07:48:16] iter = 0340, loss = 59.5521
[2023-10-17 07:49:29] iter = 0350, loss = 62.4787
[2023-10-17 07:50:42] iter = 0360, loss = 59.0980
[2023-10-17 07:51:55] iter = 0370, loss = 60.9706
[2023-10-17 07:52:58] iter = 0380, loss = 60.1909
[2023-10-17 07:53:56] iter = 0390, loss = 60.3134
[2023-10-17 07:55:09] iter = 0400, loss = 56.3224
[2023-10-17 07:56:23] iter = 0410, loss = 58.4446
[2023-10-17 07:57:36] iter = 0420, loss = 60.9419
[2023-10-17 07:58:49] iter = 0430, loss = 58.4392
[2023-10-17 08:00:03] iter = 0440, loss = 54.4963
[2023-10-17 08:01:16] iter = 0450, loss = 56.7197
[2023-10-17 08:02:29] iter = 0460, loss = 55.8300
[2023-10-17 08:03:27] iter = 0470, loss = 58.7673
[2023-10-17 08:04:33] iter = 0480, loss = 58.8908
[2023-10-17 08:05:46] iter = 0490, loss = 56.8091
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-17 08:06:55] Evaluate_00: epoch = 0300 train time = 2 s train loss = 0.008380 train acc = 1.0000, test acc = 0.4085
[2023-10-17 08:06:59] Evaluate_01: epoch = 0300 train time = 2 s train loss = 0.008372 train acc = 1.0000, test acc = 0.4051
[2023-10-17 08:07:04] Evaluate_02: epoch = 0300 train time = 2 s train loss = 0.008054 train acc = 1.0000, test acc = 0.4174
[2023-10-17 08:07:08] Evaluate_03: epoch = 0300 train time = 2 s train loss = 0.008461 train acc = 1.0000, test acc = 0.3964
[2023-10-17 08:07:12] Evaluate_04: epoch = 0300 train time = 2 s train loss = 0.008373 train acc = 1.0000, test acc = 0.3853
[2023-10-17 08:07:16] Evaluate_05: epoch = 0300 train time = 2 s train loss = 0.008555 train acc = 1.0000, test acc = 0.3901
[2023-10-17 08:07:20] Evaluate_06: epoch = 0300 train time = 2 s train loss = 0.008308 train acc = 1.0000, test acc = 0.3978
[2023-10-17 08:07:24] Evaluate_07: epoch = 0300 train time = 2 s train loss = 0.008100 train acc = 1.0000, test acc = 0.4223
[2023-10-17 08:07:29] Evaluate_08: epoch = 0300 train time = 2 s train loss = 0.008283 train acc = 1.0000, test acc = 0.4172
[2023-10-17 08:07:33] Evaluate_09: epoch = 0300 train time = 2 s train loss = 0.008713 train acc = 1.0000, test acc = 0.4149
[2023-10-17 08:07:37] Evaluate_10: epoch = 0300 train time = 2 s train loss = 0.008613 train acc = 1.0000, test acc = 0.4040
[2023-10-17 08:07:41] Evaluate_11: epoch = 0300 train time = 2 s train loss = 0.008727 train acc = 1.0000, test acc = 0.4116
[2023-10-17 08:07:45] Evaluate_12: epoch = 0300 train time = 2 s train loss = 0.008200 train acc = 1.0000, test acc = 0.4066
[2023-10-17 08:07:49] Evaluate_13: epoch = 0300 train time = 2 s train loss = 0.008600 train acc = 1.0000, test acc = 0.4053
[2023-10-17 08:07:53] Evaluate_14: epoch = 0300 train time = 2 s train loss = 0.008258 train acc = 1.0000, test acc = 0.4065
[2023-10-17 08:07:57] Evaluate_15: epoch = 0300 train time = 2 s train loss = 0.008059 train acc = 1.0000, test acc = 0.4137
[2023-10-17 08:08:02] Evaluate_16: epoch = 0300 train time = 2 s train loss = 0.008226 train acc = 1.0000, test acc = 0.4102
[2023-10-17 08:08:06] Evaluate_17: epoch = 0300 train time = 2 s train loss = 0.008121 train acc = 1.0000, test acc = 0.4105
[2023-10-17 08:08:10] Evaluate_18: epoch = 0300 train time = 2 s train loss = 0.008574 train acc = 1.0000, test acc = 0.4125
[2023-10-17 08:08:14] Evaluate_19: epoch = 0300 train time = 2 s train loss = 0.008471 train acc = 1.0000, test acc = 0.4171
Evaluate 20 random ConvNet, mean = 0.4076 std = 0.0092
-------------------------
[2023-10-17 08:08:21] iter = 0500, loss = 59.6083
[2023-10-17 08:09:34] iter = 0510, loss = 56.8760
[2023-10-17 08:10:46] iter = 0520, loss = 54.7567
[2023-10-17 08:11:58] iter = 0530, loss = 57.9854
[2023-10-17 08:13:02] iter = 0540, loss = 53.6996
[2023-10-17 08:13:59] iter = 0550, loss = 52.3997
[2023-10-17 08:15:13] iter = 0560, loss = 51.7405
[2023-10-17 08:16:26] iter = 0570, loss = 52.6745
[2023-10-17 08:17:39] iter = 0580, loss = 55.4489
[2023-10-17 08:18:52] iter = 0590, loss = 55.2380
[2023-10-17 08:20:06] iter = 0600, loss = 55.8996
[2023-10-17 08:21:19] iter = 0610, loss = 56.2580
[2023-10-17 08:22:32] iter = 0620, loss = 54.7295
[2023-10-17 08:23:30] iter = 0630, loss = 55.4568
[2023-10-17 08:24:34] iter = 0640, loss = 54.3849
[2023-10-17 08:25:47] iter = 0650, loss = 51.7012
[2023-10-17 08:26:59] iter = 0660, loss = 53.4107
[2023-10-17 08:28:12] iter = 0670, loss = 56.1060
[2023-10-17 08:29:24] iter = 0680, loss = 55.0014
[2023-10-17 08:30:37] iter = 0690, loss = 54.2545
[2023-10-17 08:31:50] iter = 0700, loss = 53.1240
[2023-10-17 08:32:59] iter = 0710, loss = 54.9777
[2023-10-17 08:33:57] iter = 0720, loss = 54.7654
[2023-10-17 08:35:04] iter = 0730, loss = 56.6162
[2023-10-17 08:36:18] iter = 0740, loss = 51.5811
[2023-10-17 08:37:32] iter = 0750, loss = 54.5068
[2023-10-17 08:38:45] iter = 0760, loss = 52.4800
[2023-10-17 08:39:58] iter = 0770, loss = 52.9651
[2023-10-17 08:41:12] iter = 0780, loss = 52.3339
[2023-10-17 08:42:25] iter = 0790, loss = 54.4388
[2023-10-17 08:43:29] iter = 0800, loss = 51.7693
[2023-10-17 08:44:28] iter = 0810, loss = 51.8506
[2023-10-17 08:45:40] iter = 0820, loss = 50.3423
[2023-10-17 08:46:52] iter = 0830, loss = 50.4103
[2023-10-17 08:48:05] iter = 0840, loss = 50.6432
[2023-10-17 08:49:17] iter = 0850, loss = 52.6832
[2023-10-17 08:50:29] iter = 0860, loss = 51.4563
[2023-10-17 08:51:42] iter = 0870, loss = 51.1675
[2023-10-17 08:52:55] iter = 0880, loss = 53.3881
[2023-10-17 08:53:54] iter = 0890, loss = 51.3397
[2023-10-17 08:54:56] iter = 0900, loss = 49.8227
[2023-10-17 08:56:10] iter = 0910, loss = 48.8832
[2023-10-17 08:57:24] iter = 0920, loss = 54.1616
[2023-10-17 08:58:37] iter = 0930, loss = 51.8992
[2023-10-17 08:59:50] iter = 0940, loss = 50.3242
[2023-10-17 09:01:04] iter = 0950, loss = 52.4206
[2023-10-17 09:02:17] iter = 0960, loss = 54.1490
[2023-10-17 09:03:27] iter = 0970, loss = 52.2253
[2023-10-17 09:04:25] iter = 0980, loss = 48.8557
[2023-10-17 09:05:32] iter = 0990, loss = 51.6625
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-17 09:06:42] Evaluate_00: epoch = 0300 train time = 2 s train loss = 0.008384 train acc = 1.0000, test acc = 0.4099
[2023-10-17 09:06:46] Evaluate_01: epoch = 0300 train time = 2 s train loss = 0.008265 train acc = 1.0000, test acc = 0.4218
[2023-10-17 09:06:50] Evaluate_02: epoch = 0300 train time = 2 s train loss = 0.008683 train acc = 1.0000, test acc = 0.4177
[2023-10-17 09:06:54] Evaluate_03: epoch = 0300 train time = 2 s train loss = 0.008398 train acc = 1.0000, test acc = 0.4078
[2023-10-17 09:06:58] Evaluate_04: epoch = 0300 train time = 2 s train loss = 0.008715 train acc = 1.0000, test acc = 0.4196
[2023-10-17 09:07:02] Evaluate_05: epoch = 0300 train time = 2 s train loss = 0.008295 train acc = 1.0000, test acc = 0.4223
[2023-10-17 09:07:07] Evaluate_06: epoch = 0300 train time = 2 s train loss = 0.008145 train acc = 1.0000, test acc = 0.4150
[2023-10-17 09:07:11] Evaluate_07: epoch = 0300 train time = 2 s train loss = 0.008394 train acc = 1.0000, test acc = 0.4308
[2023-10-17 09:07:15] Evaluate_08: epoch = 0300 train time = 2 s train loss = 0.008871 train acc = 1.0000, test acc = 0.4297
[2023-10-17 09:07:19] Evaluate_09: epoch = 0300 train time = 2 s train loss = 0.008106 train acc = 1.0000, test acc = 0.4120
[2023-10-17 09:07:23] Evaluate_10: epoch = 0300 train time = 2 s train loss = 0.008611 train acc = 1.0000, test acc = 0.4150
[2023-10-17 09:07:27] Evaluate_11: epoch = 0300 train time = 2 s train loss = 0.008080 train acc = 1.0000, test acc = 0.4105
[2023-10-17 09:07:32] Evaluate_12: epoch = 0300 train time = 2 s train loss = 0.008708 train acc = 1.0000, test acc = 0.4099
[2023-10-17 09:07:36] Evaluate_13: epoch = 0300 train time = 2 s train loss = 0.008373 train acc = 1.0000, test acc = 0.4055
[2023-10-17 09:07:40] Evaluate_14: epoch = 0300 train time = 2 s train loss = 0.008423 train acc = 1.0000, test acc = 0.4135
[2023-10-17 09:07:44] Evaluate_15: epoch = 0300 train time = 2 s train loss = 0.008369 train acc = 1.0000, test acc = 0.4051
[2023-10-17 09:07:48] Evaluate_16: epoch = 0300 train time = 2 s train loss = 0.008820 train acc = 1.0000, test acc = 0.4183
[2023-10-17 09:07:52] Evaluate_17: epoch = 0300 train time = 2 s train loss = 0.008445 train acc = 1.0000, test acc = 0.4183
[2023-10-17 09:07:57] Evaluate_18: epoch = 0300 train time = 2 s train loss = 0.008630 train acc = 1.0000, test acc = 0.4183
[2023-10-17 09:08:01] Evaluate_19: epoch = 0300 train time = 2 s train loss = 0.008937 train acc = 1.0000, test acc = 0.4182
Evaluate 20 random ConvNet, mean = 0.4160 std = 0.0069
-------------------------
[2023-10-17 09:08:08] iter = 1000, loss = 52.4406

================== Exp 4 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7fa1146ebc40>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-17 09:08:25] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-17 09:08:29] Evaluate_00: epoch = 0300 train time = 2 s train loss = 0.003737 train acc = 1.0000, test acc = 0.1282
[2023-10-17 09:08:33] Evaluate_01: epoch = 0300 train time = 2 s train loss = 0.003656 train acc = 1.0000, test acc = 0.1450
[2023-10-17 09:08:38] Evaluate_02: epoch = 0300 train time = 2 s train loss = 0.003727 train acc = 1.0000, test acc = 0.1186
[2023-10-17 09:08:42] Evaluate_03: epoch = 0300 train time = 2 s train loss = 0.003631 train acc = 1.0000, test acc = 0.1224
[2023-10-17 09:08:46] Evaluate_04: epoch = 0300 train time = 2 s train loss = 0.003782 train acc = 1.0000, test acc = 0.1094
[2023-10-17 09:08:50] Evaluate_05: epoch = 0300 train time = 2 s train loss = 0.003733 train acc = 1.0000, test acc = 0.1384
[2023-10-17 09:08:54] Evaluate_06: epoch = 0300 train time = 2 s train loss = 0.003624 train acc = 1.0000, test acc = 0.1236
[2023-10-17 09:08:58] Evaluate_07: epoch = 0300 train time = 2 s train loss = 0.003556 train acc = 1.0000, test acc = 0.1247
[2023-10-17 09:09:03] Evaluate_08: epoch = 0300 train time = 2 s train loss = 0.003707 train acc = 1.0000, test acc = 0.1334
[2023-10-17 09:09:07] Evaluate_09: epoch = 0300 train time = 2 s train loss = 0.003672 train acc = 1.0000, test acc = 0.1243
[2023-10-17 09:09:11] Evaluate_10: epoch = 0300 train time = 2 s train loss = 0.003696 train acc = 1.0000, test acc = 0.1404
[2023-10-17 09:09:15] Evaluate_11: epoch = 0300 train time = 2 s train loss = 0.003736 train acc = 1.0000, test acc = 0.1156
[2023-10-17 09:09:19] Evaluate_12: epoch = 0300 train time = 2 s train loss = 0.003695 train acc = 1.0000, test acc = 0.1028
[2023-10-17 09:09:23] Evaluate_13: epoch = 0300 train time = 2 s train loss = 0.003727 train acc = 1.0000, test acc = 0.1282
[2023-10-17 09:09:28] Evaluate_14: epoch = 0300 train time = 2 s train loss = 0.003652 train acc = 1.0000, test acc = 0.1269
[2023-10-17 09:09:32] Evaluate_15: epoch = 0300 train time = 2 s train loss = 0.003751 train acc = 1.0000, test acc = 0.1131
[2023-10-17 09:09:36] Evaluate_16: epoch = 0300 train time = 2 s train loss = 0.003620 train acc = 1.0000, test acc = 0.1357
[2023-10-17 09:09:40] Evaluate_17: epoch = 0300 train time = 2 s train loss = 0.003664 train acc = 1.0000, test acc = 0.1198
[2023-10-17 09:09:44] Evaluate_18: epoch = 0300 train time = 2 s train loss = 0.003681 train acc = 1.0000, test acc = 0.1387
[2023-10-17 09:09:49] Evaluate_19: epoch = 0300 train time = 2 s train loss = 0.003727 train acc = 1.0000, test acc = 0.1166
Evaluate 20 random ConvNet, mean = 0.1253 std = 0.0108
-------------------------
[2023-10-17 09:09:56] iter = 0000, loss = 257.4510
[2023-10-17 09:11:09] iter = 0010, loss = 200.8951
[2023-10-17 09:12:21] iter = 0020, loss = 196.9870
[2023-10-17 09:13:26] iter = 0030, loss = 162.8484
[2023-10-17 09:14:24] iter = 0040, loss = 151.0646
[2023-10-17 09:15:36] iter = 0050, loss = 138.6695
[2023-10-17 09:16:50] iter = 0060, loss = 131.8365
[2023-10-17 09:18:03] iter = 0070, loss = 122.7446
[2023-10-17 09:19:16] iter = 0080, loss = 113.5785
[2023-10-17 09:20:30] iter = 0090, loss = 103.9453
[2023-10-17 09:21:43] iter = 0100, loss = 95.4200
[2023-10-17 09:22:56] iter = 0110, loss = 97.6884
[2023-10-17 09:23:55] iter = 0120, loss = 93.2417
[2023-10-17 09:24:57] iter = 0130, loss = 85.3207
[2023-10-17 09:26:11] iter = 0140, loss = 86.3880
[2023-10-17 09:27:24] iter = 0150, loss = 87.0285
[2023-10-17 09:28:37] iter = 0160, loss = 75.7112
[2023-10-17 09:29:49] iter = 0170, loss = 81.7257
[2023-10-17 09:31:02] iter = 0180, loss = 74.4406
[2023-10-17 09:32:15] iter = 0190, loss = 74.1337
[2023-10-17 09:33:25] iter = 0200, loss = 73.8346
[2023-10-17 09:34:23] iter = 0210, loss = 71.8616
[2023-10-17 09:35:31] iter = 0220, loss = 68.3869
[2023-10-17 09:36:44] iter = 0230, loss = 67.4656
[2023-10-17 09:37:56] iter = 0240, loss = 69.2499
[2023-10-17 09:39:08] iter = 0250, loss = 67.6223
[2023-10-17 09:40:21] iter = 0260, loss = 64.4477
[2023-10-17 09:41:33] iter = 0270, loss = 66.8448
[2023-10-17 09:42:46] iter = 0280, loss = 63.5050
[2023-10-17 09:43:52] iter = 0290, loss = 63.5672
[2023-10-17 09:44:50] iter = 0300, loss = 60.2379
[2023-10-17 09:46:01] iter = 0310, loss = 60.0197
[2023-10-17 09:47:15] iter = 0320, loss = 61.7442
[2023-10-17 09:48:29] iter = 0330, loss = 58.1414
[2023-10-17 09:49:42] iter = 0340, loss = 66.4859
[2023-10-17 09:50:56] iter = 0350, loss = 64.9437
[2023-10-17 09:52:10] iter = 0360, loss = 62.9856
[2023-10-17 09:53:23] iter = 0370, loss = 59.9815
[2023-10-17 09:54:22] iter = 0380, loss = 61.0046
[2023-10-17 09:55:25] iter = 0390, loss = 59.5801
[2023-10-17 09:56:38] iter = 0400, loss = 59.2139
[2023-10-17 09:57:52] iter = 0410, loss = 58.4557
[2023-10-17 09:59:04] iter = 0420, loss = 61.7990
[2023-10-17 10:00:17] iter = 0430, loss = 54.4433
[2023-10-17 10:01:30] iter = 0440, loss = 55.5548
[2023-10-17 10:02:42] iter = 0450, loss = 55.8830
[2023-10-17 10:03:51] iter = 0460, loss = 55.5519
[2023-10-17 10:04:49] iter = 0470, loss = 56.5760
[2023-10-17 10:05:55] iter = 0480, loss = 55.6552
[2023-10-17 10:07:09] iter = 0490, loss = 58.5347
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-17 10:08:18] Evaluate_00: epoch = 0300 train time = 2 s train loss = 0.008518 train acc = 1.0000, test acc = 0.4153
[2023-10-17 10:08:23] Evaluate_01: epoch = 0300 train time = 2 s train loss = 0.008437 train acc = 1.0000, test acc = 0.4067
[2023-10-17 10:08:27] Evaluate_02: epoch = 0300 train time = 2 s train loss = 0.007744 train acc = 1.0000, test acc = 0.4165
[2023-10-17 10:08:31] Evaluate_03: epoch = 0300 train time = 2 s train loss = 0.008502 train acc = 1.0000, test acc = 0.4128
[2023-10-17 10:08:35] Evaluate_04: epoch = 0300 train time = 2 s train loss = 0.008464 train acc = 1.0000, test acc = 0.4116
[2023-10-17 10:08:39] Evaluate_05: epoch = 0300 train time = 2 s train loss = 0.008433 train acc = 1.0000, test acc = 0.4241
[2023-10-17 10:08:44] Evaluate_06: epoch = 0300 train time = 2 s train loss = 0.008133 train acc = 1.0000, test acc = 0.4131
[2023-10-17 10:08:48] Evaluate_07: epoch = 0300 train time = 2 s train loss = 0.008274 train acc = 1.0000, test acc = 0.4122
[2023-10-17 10:08:52] Evaluate_08: epoch = 0300 train time = 2 s train loss = 0.008172 train acc = 1.0000, test acc = 0.4144
[2023-10-17 10:08:56] Evaluate_09: epoch = 0300 train time = 2 s train loss = 0.008444 train acc = 1.0000, test acc = 0.4014
[2023-10-17 10:09:00] Evaluate_10: epoch = 0300 train time = 2 s train loss = 0.008415 train acc = 1.0000, test acc = 0.4054
[2023-10-17 10:09:04] Evaluate_11: epoch = 0300 train time = 2 s train loss = 0.008704 train acc = 1.0000, test acc = 0.4044
[2023-10-17 10:09:08] Evaluate_12: epoch = 0300 train time = 2 s train loss = 0.008753 train acc = 1.0000, test acc = 0.4122
[2023-10-17 10:09:12] Evaluate_13: epoch = 0300 train time = 2 s train loss = 0.008418 train acc = 1.0000, test acc = 0.4185
[2023-10-17 10:09:17] Evaluate_14: epoch = 0300 train time = 2 s train loss = 0.008579 train acc = 1.0000, test acc = 0.4178
[2023-10-17 10:09:21] Evaluate_15: epoch = 0300 train time = 2 s train loss = 0.008190 train acc = 1.0000, test acc = 0.4314
[2023-10-17 10:09:25] Evaluate_16: epoch = 0300 train time = 2 s train loss = 0.008373 train acc = 1.0000, test acc = 0.4169
[2023-10-17 10:09:29] Evaluate_17: epoch = 0300 train time = 2 s train loss = 0.008334 train acc = 1.0000, test acc = 0.4043
[2023-10-17 10:09:33] Evaluate_18: epoch = 0300 train time = 2 s train loss = 0.008367 train acc = 1.0000, test acc = 0.4312
[2023-10-17 10:09:38] Evaluate_19: epoch = 0300 train time = 2 s train loss = 0.008937 train acc = 1.0000, test acc = 0.4043
Evaluate 20 random ConvNet, mean = 0.4137 std = 0.0082
-------------------------
[2023-10-17 10:09:45] iter = 0500, loss = 55.0909
[2023-10-17 10:10:58] iter = 0510, loss = 55.8564
[2023-10-17 10:12:11] iter = 0520, loss = 56.2773
[2023-10-17 10:13:24] iter = 0530, loss = 55.8862
[2023-10-17 10:14:26] iter = 0540, loss = 55.7746
[2023-10-17 10:15:25] iter = 0550, loss = 55.9204
[2023-10-17 10:16:39] iter = 0560, loss = 52.7056
[2023-10-17 10:17:52] iter = 0570, loss = 54.6430
[2023-10-17 10:19:06] iter = 0580, loss = 55.8173
[2023-10-17 10:20:19] iter = 0590, loss = 54.4994
[2023-10-17 10:21:33] iter = 0600, loss = 55.3319
[2023-10-17 10:22:46] iter = 0610, loss = 53.0272
[2023-10-17 10:23:57] iter = 0620, loss = 53.9570
[2023-10-17 10:24:55] iter = 0630, loss = 51.6994
[2023-10-17 10:26:02] iter = 0640, loss = 54.7656
[2023-10-17 10:27:15] iter = 0650, loss = 51.8908
[2023-10-17 10:28:27] iter = 0660, loss = 52.2977
[2023-10-17 10:29:40] iter = 0670, loss = 52.7998
[2023-10-17 10:30:52] iter = 0680, loss = 50.4360
[2023-10-17 10:32:05] iter = 0690, loss = 54.8820
[2023-10-17 10:33:17] iter = 0700, loss = 51.9833
[2023-10-17 10:34:24] iter = 0710, loss = 54.8238
[2023-10-17 10:35:22] iter = 0720, loss = 53.8397
[2023-10-17 10:36:31] iter = 0730, loss = 52.3738
[2023-10-17 10:37:43] iter = 0740, loss = 53.1739
[2023-10-17 10:38:56] iter = 0750, loss = 49.5912
[2023-10-17 10:40:10] iter = 0760, loss = 52.1268
[2023-10-17 10:41:22] iter = 0770, loss = 52.1328
[2023-10-17 10:42:36] iter = 0780, loss = 54.6691
[2023-10-17 10:43:49] iter = 0790, loss = 54.2541
[2023-10-17 10:44:52] iter = 0800, loss = 52.5124
[2023-10-17 10:45:52] iter = 0810, loss = 54.3637
[2023-10-17 10:47:05] iter = 0820, loss = 52.4959
[2023-10-17 10:48:17] iter = 0830, loss = 50.6755
[2023-10-17 10:49:29] iter = 0840, loss = 50.7127
[2023-10-17 10:50:42] iter = 0850, loss = 52.4635
[2023-10-17 10:51:54] iter = 0860, loss = 50.0568
[2023-10-17 10:53:07] iter = 0870, loss = 53.5398
[2023-10-17 10:54:19] iter = 0880, loss = 51.4411
[2023-10-17 10:55:18] iter = 0890, loss = 52.0541
[2023-10-17 10:56:22] iter = 0900, loss = 51.4362
[2023-10-17 10:57:34] iter = 0910, loss = 48.1172
[2023-10-17 10:58:48] iter = 0920, loss = 50.3542
[2023-10-17 11:00:01] iter = 0930, loss = 52.3165
[2023-10-17 11:01:13] iter = 0940, loss = 48.0442
[2023-10-17 11:02:26] iter = 0950, loss = 48.0200
[2023-10-17 11:03:39] iter = 0960, loss = 49.7864
[2023-10-17 11:04:47] iter = 0970, loss = 50.0777
[2023-10-17 11:05:45] iter = 0980, loss = 49.7700
[2023-10-17 11:06:53] iter = 0990, loss = 51.3844
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-17 11:08:03] Evaluate_00: epoch = 0300 train time = 2 s train loss = 0.008437 train acc = 1.0000, test acc = 0.4331
[2023-10-17 11:08:07] Evaluate_01: epoch = 0300 train time = 2 s train loss = 0.008867 train acc = 1.0000, test acc = 0.4112
[2023-10-17 11:08:11] Evaluate_02: epoch = 0300 train time = 2 s train loss = 0.008836 train acc = 1.0000, test acc = 0.4278
[2023-10-17 11:08:15] Evaluate_03: epoch = 0300 train time = 2 s train loss = 0.008535 train acc = 1.0000, test acc = 0.4228
[2023-10-17 11:08:19] Evaluate_04: epoch = 0300 train time = 2 s train loss = 0.009028 train acc = 1.0000, test acc = 0.4213
[2023-10-17 11:08:24] Evaluate_05: epoch = 0300 train time = 2 s train loss = 0.009091 train acc = 1.0000, test acc = 0.4013
[2023-10-17 11:08:28] Evaluate_06: epoch = 0300 train time = 2 s train loss = 0.008829 train acc = 1.0000, test acc = 0.4164
[2023-10-17 11:08:32] Evaluate_07: epoch = 0300 train time = 2 s train loss = 0.008312 train acc = 1.0000, test acc = 0.4194
[2023-10-17 11:08:36] Evaluate_08: epoch = 0300 train time = 2 s train loss = 0.008687 train acc = 1.0000, test acc = 0.4306
[2023-10-17 11:08:40] Evaluate_09: epoch = 0300 train time = 2 s train loss = 0.008798 train acc = 1.0000, test acc = 0.4248
[2023-10-17 11:08:44] Evaluate_10: epoch = 0300 train time = 2 s train loss = 0.008607 train acc = 1.0000, test acc = 0.4098
[2023-10-17 11:08:49] Evaluate_11: epoch = 0300 train time = 2 s train loss = 0.008514 train acc = 1.0000, test acc = 0.4213
[2023-10-17 11:08:53] Evaluate_12: epoch = 0300 train time = 2 s train loss = 0.008732 train acc = 1.0000, test acc = 0.4126
[2023-10-17 11:08:57] Evaluate_13: epoch = 0300 train time = 2 s train loss = 0.009214 train acc = 1.0000, test acc = 0.4175
[2023-10-17 11:09:01] Evaluate_14: epoch = 0300 train time = 2 s train loss = 0.008810 train acc = 1.0000, test acc = 0.4205
[2023-10-17 11:09:05] Evaluate_15: epoch = 0300 train time = 2 s train loss = 0.008451 train acc = 1.0000, test acc = 0.4374
[2023-10-17 11:09:10] Evaluate_16: epoch = 0300 train time = 2 s train loss = 0.008800 train acc = 1.0000, test acc = 0.4112
[2023-10-17 11:09:14] Evaluate_17: epoch = 0300 train time = 2 s train loss = 0.008560 train acc = 1.0000, test acc = 0.4261
[2023-10-17 11:09:18] Evaluate_18: epoch = 0300 train time = 2 s train loss = 0.009090 train acc = 1.0000, test acc = 0.4143
[2023-10-17 11:09:22] Evaluate_19: epoch = 0300 train time = 2 s train loss = 0.008786 train acc = 1.0000, test acc = 0.4093
Evaluate 20 random ConvNet, mean = 0.4194 std = 0.0088
-------------------------
[2023-10-17 11:09:29] iter = 1000, loss = 51.4248

==================== Final Results ====================

Run 5 experiments, train on ConvNet, evaluate 100 random ConvNet, mean  = 41.81%  std = 0.86%
