/data/happythgus/newLDA/DC
/data/opt/anaconda3/envs/pytorch1.12.1_p38/bin/python
moana-r3
main.py:94: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
main.py:94: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484810403/work/torch/csrc/utils/tensor_new.cpp:201.)
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
eval_it_pool:  [0, 500, 1000]
Files already downloaded and verified
Files already downloaded and verified

================== Exp 0 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 1, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 1, 'inner_loop': 1, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7fdedb0d5ca0>, 'dsa': False}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-26 10:39:45] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 10:39:50] Evaluate_00: epoch = 0300 train time = 2 s train loss = 0.000445 train acc = 1.0000, test acc = 0.1004
[2023-10-26 10:39:53] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000460 train acc = 1.0000, test acc = 0.1022
[2023-10-26 10:39:56] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000454 train acc = 1.0000, test acc = 0.1132
[2023-10-26 10:39:59] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000445 train acc = 1.0000, test acc = 0.0935
[2023-10-26 10:40:01] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000451 train acc = 1.0000, test acc = 0.1031
[2023-10-26 10:40:04] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000456 train acc = 1.0000, test acc = 0.0846
[2023-10-26 10:40:07] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000449 train acc = 1.0000, test acc = 0.1047
[2023-10-26 10:40:10] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000444 train acc = 1.0000, test acc = 0.0894
[2023-10-26 10:40:13] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000422 train acc = 1.0000, test acc = 0.0847
[2023-10-26 10:40:16] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000437 train acc = 1.0000, test acc = 0.0991
[2023-10-26 10:40:19] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000444 train acc = 1.0000, test acc = 0.1076
[2023-10-26 10:40:21] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000439 train acc = 1.0000, test acc = 0.1046
[2023-10-26 10:40:24] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000436 train acc = 1.0000, test acc = 0.1127
[2023-10-26 10:40:27] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000423 train acc = 1.0000, test acc = 0.1021
[2023-10-26 10:40:30] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000442 train acc = 1.0000, test acc = 0.1095
[2023-10-26 10:40:33] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000444 train acc = 1.0000, test acc = 0.1083
[2023-10-26 10:40:36] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000442 train acc = 1.0000, test acc = 0.0961
[2023-10-26 10:40:39] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000443 train acc = 1.0000, test acc = 0.0924
[2023-10-26 10:40:41] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000436 train acc = 1.0000, test acc = 0.1041
[2023-10-26 10:40:44] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000444 train acc = 1.0000, test acc = 0.0897
Evaluate 20 random ConvNet, mean = 0.1001 std = 0.0085
-------------------------
[2023-10-26 10:40:44] iter = 0000, loss = 320.0248
[2023-10-26 10:40:46] iter = 0010, loss = 245.2927
[2023-10-26 10:40:48] iter = 0020, loss = 229.4471
[2023-10-26 10:40:50] iter = 0030, loss = 226.0270
[2023-10-26 10:40:52] iter = 0040, loss = 215.3340
[2023-10-26 10:40:54] iter = 0050, loss = 209.2445
[2023-10-26 10:40:56] iter = 0060, loss = 209.7984
[2023-10-26 10:40:58] iter = 0070, loss = 207.9458
[2023-10-26 10:41:00] iter = 0080, loss = 203.9190
[2023-10-26 10:41:02] iter = 0090, loss = 210.8102
[2023-10-26 10:41:04] iter = 0100, loss = 199.5885
[2023-10-26 10:41:06] iter = 0110, loss = 202.3575
[2023-10-26 10:41:08] iter = 0120, loss = 200.9363
[2023-10-26 10:41:10] iter = 0130, loss = 198.8298
[2023-10-26 10:41:11] iter = 0140, loss = 204.6851
[2023-10-26 10:41:13] iter = 0150, loss = 191.7787
[2023-10-26 10:41:15] iter = 0160, loss = 199.9159
[2023-10-26 10:41:17] iter = 0170, loss = 197.7830
[2023-10-26 10:41:19] iter = 0180, loss = 196.0998
[2023-10-26 10:41:21] iter = 0190, loss = 198.5428
[2023-10-26 10:41:23] iter = 0200, loss = 197.7582
[2023-10-26 10:41:25] iter = 0210, loss = 193.0102
[2023-10-26 10:41:27] iter = 0220, loss = 197.6883
[2023-10-26 10:41:29] iter = 0230, loss = 197.2345
[2023-10-26 10:41:31] iter = 0240, loss = 199.4537
[2023-10-26 10:41:33] iter = 0250, loss = 193.9905
[2023-10-26 10:41:35] iter = 0260, loss = 193.5019
[2023-10-26 10:41:37] iter = 0270, loss = 192.9201
[2023-10-26 10:41:38] iter = 0280, loss = 199.0767
[2023-10-26 10:41:40] iter = 0290, loss = 193.0752
[2023-10-26 10:41:42] iter = 0300, loss = 185.2925
[2023-10-26 10:41:44] iter = 0310, loss = 196.8250
[2023-10-26 10:41:46] iter = 0320, loss = 191.7434
[2023-10-26 10:41:48] iter = 0330, loss = 187.3505
[2023-10-26 10:41:50] iter = 0340, loss = 181.6175
[2023-10-26 10:41:52] iter = 0350, loss = 191.9967
[2023-10-26 10:41:54] iter = 0360, loss = 195.7095
[2023-10-26 10:41:56] iter = 0370, loss = 188.8335
[2023-10-26 10:41:58] iter = 0380, loss = 186.5584
[2023-10-26 10:42:00] iter = 0390, loss = 183.7257
[2023-10-26 10:42:02] iter = 0400, loss = 195.7292
[2023-10-26 10:42:04] iter = 0410, loss = 182.2435
[2023-10-26 10:42:05] iter = 0420, loss = 185.7891
[2023-10-26 10:42:07] iter = 0430, loss = 188.6310
[2023-10-26 10:42:09] iter = 0440, loss = 190.6111
[2023-10-26 10:42:11] iter = 0450, loss = 191.8796
[2023-10-26 10:42:13] iter = 0460, loss = 185.1706
[2023-10-26 10:42:15] iter = 0470, loss = 186.2802
[2023-10-26 10:42:17] iter = 0480, loss = 181.3930
[2023-10-26 10:42:19] iter = 0490, loss = 185.1646
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 10:42:24] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000504 train acc = 1.0000, test acc = 0.2886
[2023-10-26 10:42:26] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000563 train acc = 1.0000, test acc = 0.2806
[2023-10-26 10:42:29] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000559 train acc = 1.0000, test acc = 0.2841
[2023-10-26 10:42:32] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000595 train acc = 1.0000, test acc = 0.2755
[2023-10-26 10:42:35] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000539 train acc = 1.0000, test acc = 0.2855
[2023-10-26 10:42:38] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000580 train acc = 1.0000, test acc = 0.2801
[2023-10-26 10:42:41] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000554 train acc = 1.0000, test acc = 0.2753
[2023-10-26 10:42:44] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000566 train acc = 1.0000, test acc = 0.2814
[2023-10-26 10:42:46] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000540 train acc = 1.0000, test acc = 0.2886
[2023-10-26 10:42:49] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000541 train acc = 1.0000, test acc = 0.2853
[2023-10-26 10:42:52] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000592 train acc = 1.0000, test acc = 0.2807
[2023-10-26 10:42:55] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000567 train acc = 1.0000, test acc = 0.2847
[2023-10-26 10:42:58] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000531 train acc = 1.0000, test acc = 0.2794
[2023-10-26 10:43:01] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000545 train acc = 1.0000, test acc = 0.2903
[2023-10-26 10:43:04] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000555 train acc = 1.0000, test acc = 0.2809
[2023-10-26 10:43:06] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000550 train acc = 1.0000, test acc = 0.2809
[2023-10-26 10:43:09] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000505 train acc = 1.0000, test acc = 0.2839
[2023-10-26 10:43:12] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000556 train acc = 1.0000, test acc = 0.2940
[2023-10-26 10:43:15] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000564 train acc = 1.0000, test acc = 0.2835
[2023-10-26 10:43:18] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000569 train acc = 1.0000, test acc = 0.2850
Evaluate 20 random ConvNet, mean = 0.2834 std = 0.0045
-------------------------
[2023-10-26 10:43:18] iter = 0500, loss = 183.0080
[2023-10-26 10:43:20] iter = 0510, loss = 182.5935
[2023-10-26 10:43:22] iter = 0520, loss = 180.5535
[2023-10-26 10:43:24] iter = 0530, loss = 187.6194
[2023-10-26 10:43:26] iter = 0540, loss = 183.9310
[2023-10-26 10:43:28] iter = 0550, loss = 187.3967
[2023-10-26 10:43:30] iter = 0560, loss = 186.6141
[2023-10-26 10:43:32] iter = 0570, loss = 182.5129
[2023-10-26 10:43:34] iter = 0580, loss = 186.5007
[2023-10-26 10:43:36] iter = 0590, loss = 188.1155
[2023-10-26 10:43:37] iter = 0600, loss = 181.9646
[2023-10-26 10:43:39] iter = 0610, loss = 181.3980
[2023-10-26 10:43:41] iter = 0620, loss = 187.9746
[2023-10-26 10:43:43] iter = 0630, loss = 193.9926
[2023-10-26 10:43:45] iter = 0640, loss = 179.9914
[2023-10-26 10:43:47] iter = 0650, loss = 183.7175
[2023-10-26 10:43:49] iter = 0660, loss = 177.0619
[2023-10-26 10:43:51] iter = 0670, loss = 187.5491
[2023-10-26 10:43:53] iter = 0680, loss = 187.5042
[2023-10-26 10:43:55] iter = 0690, loss = 183.4868
[2023-10-26 10:43:57] iter = 0700, loss = 187.5991
[2023-10-26 10:43:59] iter = 0710, loss = 182.7798
[2023-10-26 10:44:01] iter = 0720, loss = 186.7262
[2023-10-26 10:44:03] iter = 0730, loss = 178.5071
[2023-10-26 10:44:04] iter = 0740, loss = 177.5240
[2023-10-26 10:44:06] iter = 0750, loss = 179.9981
[2023-10-26 10:44:08] iter = 0760, loss = 181.2818
[2023-10-26 10:44:10] iter = 0770, loss = 184.2498
[2023-10-26 10:44:12] iter = 0780, loss = 186.1409
[2023-10-26 10:44:14] iter = 0790, loss = 184.6874
[2023-10-26 10:44:16] iter = 0800, loss = 186.2922
[2023-10-26 10:44:18] iter = 0810, loss = 185.2095
[2023-10-26 10:44:20] iter = 0820, loss = 186.6122
[2023-10-26 10:44:22] iter = 0830, loss = 183.2649
[2023-10-26 10:44:24] iter = 0840, loss = 180.9879
[2023-10-26 10:44:26] iter = 0850, loss = 181.2201
[2023-10-26 10:44:28] iter = 0860, loss = 178.4953
[2023-10-26 10:44:30] iter = 0870, loss = 185.4623
[2023-10-26 10:44:31] iter = 0880, loss = 187.4409
[2023-10-26 10:44:33] iter = 0890, loss = 179.2623
[2023-10-26 10:44:35] iter = 0900, loss = 180.1821
[2023-10-26 10:44:37] iter = 0910, loss = 181.5094
[2023-10-26 10:44:39] iter = 0920, loss = 181.9846
[2023-10-26 10:44:41] iter = 0930, loss = 181.3822
[2023-10-26 10:44:43] iter = 0940, loss = 179.8154
[2023-10-26 10:44:45] iter = 0950, loss = 179.2267
[2023-10-26 10:44:47] iter = 0960, loss = 179.8874
[2023-10-26 10:44:49] iter = 0970, loss = 178.6492
[2023-10-26 10:44:51] iter = 0980, loss = 177.0755
[2023-10-26 10:44:53] iter = 0990, loss = 182.4811
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 10:44:57] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000578 train acc = 1.0000, test acc = 0.2803
[2023-10-26 10:45:00] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000537 train acc = 1.0000, test acc = 0.2903
[2023-10-26 10:45:03] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000569 train acc = 1.0000, test acc = 0.2825
[2023-10-26 10:45:06] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000591 train acc = 1.0000, test acc = 0.2805
[2023-10-26 10:45:09] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000589 train acc = 1.0000, test acc = 0.2744
[2023-10-26 10:45:12] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000602 train acc = 1.0000, test acc = 0.2852
[2023-10-26 10:45:15] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000576 train acc = 1.0000, test acc = 0.2828
[2023-10-26 10:45:17] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000620 train acc = 1.0000, test acc = 0.2823
[2023-10-26 10:45:20] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000606 train acc = 1.0000, test acc = 0.2822
[2023-10-26 10:45:23] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000543 train acc = 1.0000, test acc = 0.2725
[2023-10-26 10:45:26] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000611 train acc = 1.0000, test acc = 0.2812
[2023-10-26 10:45:29] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000566 train acc = 1.0000, test acc = 0.2857
[2023-10-26 10:45:32] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000563 train acc = 1.0000, test acc = 0.2758
[2023-10-26 10:45:35] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000575 train acc = 1.0000, test acc = 0.2735
[2023-10-26 10:45:37] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000578 train acc = 1.0000, test acc = 0.2856
[2023-10-26 10:45:40] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000597 train acc = 1.0000, test acc = 0.2825
[2023-10-26 10:45:43] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000579 train acc = 1.0000, test acc = 0.2781
[2023-10-26 10:45:46] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000563 train acc = 1.0000, test acc = 0.2832
[2023-10-26 10:45:49] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000597 train acc = 1.0000, test acc = 0.2785
[2023-10-26 10:45:52] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000637 train acc = 1.0000, test acc = 0.2775
Evaluate 20 random ConvNet, mean = 0.2807 std = 0.0044
-------------------------
[2023-10-26 10:45:52] iter = 1000, loss = 181.5923

================== Exp 1 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 1, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 1, 'inner_loop': 1, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7fdedb0d5ca0>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-26 10:46:08] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 10:46:11] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000430 train acc = 1.0000, test acc = 0.0975
[2023-10-26 10:46:14] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000448 train acc = 1.0000, test acc = 0.1151
[2023-10-26 10:46:17] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000435 train acc = 1.0000, test acc = 0.0860
[2023-10-26 10:46:20] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000442 train acc = 1.0000, test acc = 0.1016
[2023-10-26 10:46:22] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000418 train acc = 1.0000, test acc = 0.0960
[2023-10-26 10:46:25] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000465 train acc = 1.0000, test acc = 0.1047
[2023-10-26 10:46:28] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000438 train acc = 1.0000, test acc = 0.1014
[2023-10-26 10:46:31] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000449 train acc = 1.0000, test acc = 0.1083
[2023-10-26 10:46:34] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000447 train acc = 1.0000, test acc = 0.1088
[2023-10-26 10:46:37] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000443 train acc = 1.0000, test acc = 0.1056
[2023-10-26 10:46:40] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000459 train acc = 1.0000, test acc = 0.1095
[2023-10-26 10:46:42] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000460 train acc = 1.0000, test acc = 0.1215
[2023-10-26 10:46:45] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000460 train acc = 1.0000, test acc = 0.0955
[2023-10-26 10:46:48] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000441 train acc = 1.0000, test acc = 0.0973
[2023-10-26 10:46:51] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000454 train acc = 1.0000, test acc = 0.1030
[2023-10-26 10:46:54] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000459 train acc = 1.0000, test acc = 0.1079
[2023-10-26 10:46:57] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000449 train acc = 1.0000, test acc = 0.1046
[2023-10-26 10:47:00] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000449 train acc = 1.0000, test acc = 0.1063
[2023-10-26 10:47:02] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000452 train acc = 1.0000, test acc = 0.1133
[2023-10-26 10:47:05] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000438 train acc = 1.0000, test acc = 0.1121
Evaluate 20 random ConvNet, mean = 0.1048 std = 0.0078
-------------------------
[2023-10-26 10:47:05] iter = 0000, loss = 316.7502
[2023-10-26 10:47:07] iter = 0010, loss = 254.8758
[2023-10-26 10:47:09] iter = 0020, loss = 229.5504
[2023-10-26 10:47:11] iter = 0030, loss = 218.3111
[2023-10-26 10:47:13] iter = 0040, loss = 220.8867
[2023-10-26 10:47:15] iter = 0050, loss = 221.1711
[2023-10-26 10:47:16] iter = 0060, loss = 213.2872
[2023-10-26 10:47:18] iter = 0070, loss = 210.5221
[2023-10-26 10:47:20] iter = 0080, loss = 208.4651
[2023-10-26 10:47:22] iter = 0090, loss = 208.9661
[2023-10-26 10:47:24] iter = 0100, loss = 206.2928
[2023-10-26 10:47:26] iter = 0110, loss = 201.0989
[2023-10-26 10:47:28] iter = 0120, loss = 205.7615
[2023-10-26 10:47:30] iter = 0130, loss = 200.2008
[2023-10-26 10:47:32] iter = 0140, loss = 197.6182
[2023-10-26 10:47:34] iter = 0150, loss = 201.8216
[2023-10-26 10:47:36] iter = 0160, loss = 199.4067
[2023-10-26 10:47:38] iter = 0170, loss = 197.8682
[2023-10-26 10:47:40] iter = 0180, loss = 191.7527
[2023-10-26 10:47:42] iter = 0190, loss = 200.1888
[2023-10-26 10:47:43] iter = 0200, loss = 192.6420
[2023-10-26 10:47:45] iter = 0210, loss = 190.2615
[2023-10-26 10:47:47] iter = 0220, loss = 191.9366
[2023-10-26 10:47:49] iter = 0230, loss = 197.9968
[2023-10-26 10:47:51] iter = 0240, loss = 187.9571
[2023-10-26 10:47:53] iter = 0250, loss = 191.5086
[2023-10-26 10:47:55] iter = 0260, loss = 195.5236
[2023-10-26 10:47:57] iter = 0270, loss = 194.6466
[2023-10-26 10:47:59] iter = 0280, loss = 192.3225
[2023-10-26 10:48:01] iter = 0290, loss = 194.9022
[2023-10-26 10:48:03] iter = 0300, loss = 194.2881
[2023-10-26 10:48:05] iter = 0310, loss = 189.2334
[2023-10-26 10:48:07] iter = 0320, loss = 189.3724
[2023-10-26 10:48:09] iter = 0330, loss = 189.1256
[2023-10-26 10:48:11] iter = 0340, loss = 185.9215
[2023-10-26 10:48:13] iter = 0350, loss = 189.2470
[2023-10-26 10:48:15] iter = 0360, loss = 187.3455
[2023-10-26 10:48:17] iter = 0370, loss = 189.3979
[2023-10-26 10:48:18] iter = 0380, loss = 186.8134
[2023-10-26 10:48:20] iter = 0390, loss = 180.2796
[2023-10-26 10:48:22] iter = 0400, loss = 187.0406
[2023-10-26 10:48:24] iter = 0410, loss = 184.4448
[2023-10-26 10:48:26] iter = 0420, loss = 188.3658
[2023-10-26 10:48:28] iter = 0430, loss = 189.7521
[2023-10-26 10:48:30] iter = 0440, loss = 192.0556
[2023-10-26 10:48:32] iter = 0450, loss = 184.8462
[2023-10-26 10:48:34] iter = 0460, loss = 186.3979
[2023-10-26 10:48:36] iter = 0470, loss = 189.9089
[2023-10-26 10:48:38] iter = 0480, loss = 189.6700
[2023-10-26 10:48:40] iter = 0490, loss = 179.9588
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 10:48:45] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000529 train acc = 1.0000, test acc = 0.2841
[2023-10-26 10:48:47] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000560 train acc = 1.0000, test acc = 0.2825
[2023-10-26 10:48:50] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000596 train acc = 1.0000, test acc = 0.2765
[2023-10-26 10:48:53] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000578 train acc = 1.0000, test acc = 0.2769
[2023-10-26 10:48:56] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000549 train acc = 1.0000, test acc = 0.2748
[2023-10-26 10:48:59] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000562 train acc = 1.0000, test acc = 0.2712
[2023-10-26 10:49:02] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000565 train acc = 1.0000, test acc = 0.2861
[2023-10-26 10:49:05] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000554 train acc = 1.0000, test acc = 0.2693
[2023-10-26 10:49:07] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000579 train acc = 1.0000, test acc = 0.2798
[2023-10-26 10:49:10] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000569 train acc = 1.0000, test acc = 0.2794
[2023-10-26 10:49:13] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000575 train acc = 1.0000, test acc = 0.2826
[2023-10-26 10:49:16] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000559 train acc = 1.0000, test acc = 0.2713
[2023-10-26 10:49:19] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000578 train acc = 1.0000, test acc = 0.2789
[2023-10-26 10:49:22] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000539 train acc = 1.0000, test acc = 0.2770
[2023-10-26 10:49:25] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000597 train acc = 1.0000, test acc = 0.2775
[2023-10-26 10:49:27] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000577 train acc = 1.0000, test acc = 0.2860
[2023-10-26 10:49:30] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000532 train acc = 1.0000, test acc = 0.2822
[2023-10-26 10:49:33] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000514 train acc = 1.0000, test acc = 0.2862
[2023-10-26 10:49:36] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000565 train acc = 1.0000, test acc = 0.2757
[2023-10-26 10:49:39] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000566 train acc = 1.0000, test acc = 0.2743
Evaluate 20 random ConvNet, mean = 0.2786 std = 0.0050
-------------------------
[2023-10-26 10:49:39] iter = 0500, loss = 187.5709
[2023-10-26 10:49:41] iter = 0510, loss = 179.1116
[2023-10-26 10:49:43] iter = 0520, loss = 181.1466
[2023-10-26 10:49:45] iter = 0530, loss = 187.7432
[2023-10-26 10:49:47] iter = 0540, loss = 183.2129
[2023-10-26 10:49:49] iter = 0550, loss = 184.6966
[2023-10-26 10:49:51] iter = 0560, loss = 183.1330
[2023-10-26 10:49:53] iter = 0570, loss = 191.3701
[2023-10-26 10:49:54] iter = 0580, loss = 186.5437
[2023-10-26 10:49:56] iter = 0590, loss = 184.5492
[2023-10-26 10:49:58] iter = 0600, loss = 184.2513
[2023-10-26 10:50:00] iter = 0610, loss = 185.3896
[2023-10-26 10:50:02] iter = 0620, loss = 183.3622
[2023-10-26 10:50:04] iter = 0630, loss = 184.1585
[2023-10-26 10:50:06] iter = 0640, loss = 191.7203
[2023-10-26 10:50:08] iter = 0650, loss = 185.9191
[2023-10-26 10:50:10] iter = 0660, loss = 175.7601
[2023-10-26 10:50:12] iter = 0670, loss = 182.3597
[2023-10-26 10:50:14] iter = 0680, loss = 180.8185
[2023-10-26 10:50:16] iter = 0690, loss = 181.0875
[2023-10-26 10:50:18] iter = 0700, loss = 182.6172
[2023-10-26 10:50:20] iter = 0710, loss = 186.0906
[2023-10-26 10:50:21] iter = 0720, loss = 188.4218
[2023-10-26 10:50:23] iter = 0730, loss = 181.7229
[2023-10-26 10:50:25] iter = 0740, loss = 181.5393
[2023-10-26 10:50:27] iter = 0750, loss = 185.9204
[2023-10-26 10:50:29] iter = 0760, loss = 178.8928
[2023-10-26 10:50:31] iter = 0770, loss = 183.9094
[2023-10-26 10:50:33] iter = 0780, loss = 186.8144
[2023-10-26 10:50:35] iter = 0790, loss = 182.5219
[2023-10-26 10:50:37] iter = 0800, loss = 181.7120
[2023-10-26 10:50:39] iter = 0810, loss = 185.8139
[2023-10-26 10:50:41] iter = 0820, loss = 181.5349
[2023-10-26 10:50:43] iter = 0830, loss = 181.4641
[2023-10-26 10:50:45] iter = 0840, loss = 184.1562
[2023-10-26 10:50:47] iter = 0850, loss = 181.7458
[2023-10-26 10:50:48] iter = 0860, loss = 185.0425
[2023-10-26 10:50:50] iter = 0870, loss = 178.3610
[2023-10-26 10:50:52] iter = 0880, loss = 182.0271
[2023-10-26 10:50:54] iter = 0890, loss = 176.3892
[2023-10-26 10:50:56] iter = 0900, loss = 182.1124
[2023-10-26 10:50:58] iter = 0910, loss = 176.8755
[2023-10-26 10:51:00] iter = 0920, loss = 178.3900
[2023-10-26 10:51:02] iter = 0930, loss = 185.9151
[2023-10-26 10:51:04] iter = 0940, loss = 184.5546
[2023-10-26 10:51:06] iter = 0950, loss = 179.7391
[2023-10-26 10:51:08] iter = 0960, loss = 183.5287
[2023-10-26 10:51:10] iter = 0970, loss = 188.3162
[2023-10-26 10:51:12] iter = 0980, loss = 180.9425
[2023-10-26 10:51:14] iter = 0990, loss = 177.4990
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 10:51:18] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000557 train acc = 1.0000, test acc = 0.2808
[2023-10-26 10:51:21] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000603 train acc = 1.0000, test acc = 0.2697
[2023-10-26 10:51:24] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000581 train acc = 1.0000, test acc = 0.2824
[2023-10-26 10:51:27] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000595 train acc = 1.0000, test acc = 0.2836
[2023-10-26 10:51:30] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000557 train acc = 1.0000, test acc = 0.2782
[2023-10-26 10:51:32] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000603 train acc = 1.0000, test acc = 0.2792
[2023-10-26 10:51:35] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000578 train acc = 1.0000, test acc = 0.2750
[2023-10-26 10:51:38] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000549 train acc = 1.0000, test acc = 0.2763
[2023-10-26 10:51:41] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000585 train acc = 1.0000, test acc = 0.2729
[2023-10-26 10:51:44] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000586 train acc = 1.0000, test acc = 0.2750
[2023-10-26 10:51:47] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000580 train acc = 1.0000, test acc = 0.2777
[2023-10-26 10:51:50] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000556 train acc = 1.0000, test acc = 0.2753
[2023-10-26 10:51:53] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000601 train acc = 1.0000, test acc = 0.2695
[2023-10-26 10:51:55] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000537 train acc = 1.0000, test acc = 0.2852
[2023-10-26 10:51:58] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000558 train acc = 1.0000, test acc = 0.2851
[2023-10-26 10:52:01] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000597 train acc = 1.0000, test acc = 0.2708
[2023-10-26 10:52:04] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000554 train acc = 1.0000, test acc = 0.2964
[2023-10-26 10:52:07] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000572 train acc = 1.0000, test acc = 0.2894
[2023-10-26 10:52:10] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000575 train acc = 1.0000, test acc = 0.2843
[2023-10-26 10:52:13] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000576 train acc = 1.0000, test acc = 0.2839
Evaluate 20 random ConvNet, mean = 0.2795 std = 0.0067
-------------------------
[2023-10-26 10:52:13] iter = 1000, loss = 179.8670

================== Exp 2 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 1, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 1, 'inner_loop': 1, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7fdedb0d5ca0>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-26 10:52:29] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 10:52:32] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000453 train acc = 1.0000, test acc = 0.0868
[2023-10-26 10:52:34] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000447 train acc = 1.0000, test acc = 0.0965
[2023-10-26 10:52:37] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000455 train acc = 1.0000, test acc = 0.0993
[2023-10-26 10:52:40] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000443 train acc = 1.0000, test acc = 0.0942
[2023-10-26 10:52:43] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000456 train acc = 1.0000, test acc = 0.1037
[2023-10-26 10:52:46] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000420 train acc = 1.0000, test acc = 0.0859
[2023-10-26 10:52:49] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000443 train acc = 1.0000, test acc = 0.0982
[2023-10-26 10:52:52] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000434 train acc = 1.0000, test acc = 0.0933
[2023-10-26 10:52:54] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000434 train acc = 1.0000, test acc = 0.1060
[2023-10-26 10:52:57] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000456 train acc = 1.0000, test acc = 0.0881
[2023-10-26 10:53:00] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000443 train acc = 1.0000, test acc = 0.0901
[2023-10-26 10:53:03] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000453 train acc = 1.0000, test acc = 0.0984
[2023-10-26 10:53:06] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000455 train acc = 1.0000, test acc = 0.0970
[2023-10-26 10:53:09] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000436 train acc = 1.0000, test acc = 0.1150
[2023-10-26 10:53:12] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000466 train acc = 1.0000, test acc = 0.0945
[2023-10-26 10:53:14] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000450 train acc = 1.0000, test acc = 0.1054
[2023-10-26 10:53:17] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000445 train acc = 1.0000, test acc = 0.0959
[2023-10-26 10:53:20] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000441 train acc = 1.0000, test acc = 0.0938
[2023-10-26 10:53:23] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000456 train acc = 1.0000, test acc = 0.0918
[2023-10-26 10:53:26] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000456 train acc = 1.0000, test acc = 0.0979
Evaluate 20 random ConvNet, mean = 0.0966 std = 0.0069
-------------------------
[2023-10-26 10:53:26] iter = 0000, loss = 313.5429
[2023-10-26 10:53:28] iter = 0010, loss = 250.9836
[2023-10-26 10:53:30] iter = 0020, loss = 228.9817
[2023-10-26 10:53:32] iter = 0030, loss = 226.6960
[2023-10-26 10:53:34] iter = 0040, loss = 213.5367
[2023-10-26 10:53:36] iter = 0050, loss = 211.6825
[2023-10-26 10:53:38] iter = 0060, loss = 206.6609
[2023-10-26 10:53:40] iter = 0070, loss = 211.1611
[2023-10-26 10:53:42] iter = 0080, loss = 208.4731
[2023-10-26 10:53:43] iter = 0090, loss = 207.4289
[2023-10-26 10:53:45] iter = 0100, loss = 205.5799
[2023-10-26 10:53:47] iter = 0110, loss = 200.9317
[2023-10-26 10:53:49] iter = 0120, loss = 202.7774
[2023-10-26 10:53:51] iter = 0130, loss = 205.0069
[2023-10-26 10:53:53] iter = 0140, loss = 193.7606
[2023-10-26 10:53:55] iter = 0150, loss = 199.5779
[2023-10-26 10:53:57] iter = 0160, loss = 206.1183
[2023-10-26 10:53:59] iter = 0170, loss = 194.3030
[2023-10-26 10:54:01] iter = 0180, loss = 193.1790
[2023-10-26 10:54:03] iter = 0190, loss = 189.8313
[2023-10-26 10:54:05] iter = 0200, loss = 190.4407
[2023-10-26 10:54:07] iter = 0210, loss = 200.7275
[2023-10-26 10:54:09] iter = 0220, loss = 196.8595
[2023-10-26 10:54:11] iter = 0230, loss = 194.1315
[2023-10-26 10:54:13] iter = 0240, loss = 192.3665
[2023-10-26 10:54:15] iter = 0250, loss = 192.3746
[2023-10-26 10:54:16] iter = 0260, loss = 191.2132
[2023-10-26 10:54:18] iter = 0270, loss = 188.6981
[2023-10-26 10:54:20] iter = 0280, loss = 189.1045
[2023-10-26 10:54:22] iter = 0290, loss = 193.6571
[2023-10-26 10:54:24] iter = 0300, loss = 191.4890
[2023-10-26 10:54:26] iter = 0310, loss = 193.7283
[2023-10-26 10:54:28] iter = 0320, loss = 187.4498
[2023-10-26 10:54:30] iter = 0330, loss = 194.2386
[2023-10-26 10:54:32] iter = 0340, loss = 188.3995
[2023-10-26 10:54:34] iter = 0350, loss = 188.8104
[2023-10-26 10:54:36] iter = 0360, loss = 185.9911
[2023-10-26 10:54:38] iter = 0370, loss = 186.8820
[2023-10-26 10:54:40] iter = 0380, loss = 187.2071
[2023-10-26 10:54:42] iter = 0390, loss = 187.1693
[2023-10-26 10:54:44] iter = 0400, loss = 187.6550
[2023-10-26 10:54:46] iter = 0410, loss = 186.9935
[2023-10-26 10:54:48] iter = 0420, loss = 185.7829
[2023-10-26 10:54:50] iter = 0430, loss = 188.8426
[2023-10-26 10:54:52] iter = 0440, loss = 186.4727
[2023-10-26 10:54:54] iter = 0450, loss = 185.1828
[2023-10-26 10:54:56] iter = 0460, loss = 185.5189
[2023-10-26 10:54:58] iter = 0470, loss = 188.2889
[2023-10-26 10:55:00] iter = 0480, loss = 190.3019
[2023-10-26 10:55:02] iter = 0490, loss = 189.1764
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 10:55:07] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000563 train acc = 1.0000, test acc = 0.2786
[2023-10-26 10:55:10] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000574 train acc = 1.0000, test acc = 0.2723
[2023-10-26 10:55:13] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000576 train acc = 1.0000, test acc = 0.2714
[2023-10-26 10:55:16] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000596 train acc = 1.0000, test acc = 0.2707
[2023-10-26 10:55:19] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000526 train acc = 1.0000, test acc = 0.2969
[2023-10-26 10:55:22] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000566 train acc = 1.0000, test acc = 0.2725
[2023-10-26 10:55:25] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000548 train acc = 1.0000, test acc = 0.2822
[2023-10-26 10:55:27] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000608 train acc = 1.0000, test acc = 0.2678
[2023-10-26 10:55:30] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000522 train acc = 1.0000, test acc = 0.2817
[2023-10-26 10:55:33] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000552 train acc = 1.0000, test acc = 0.2842
[2023-10-26 10:55:36] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000555 train acc = 1.0000, test acc = 0.2782
[2023-10-26 10:55:39] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000586 train acc = 1.0000, test acc = 0.2785
[2023-10-26 10:55:42] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000523 train acc = 1.0000, test acc = 0.2803
[2023-10-26 10:55:45] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000600 train acc = 1.0000, test acc = 0.2691
[2023-10-26 10:55:48] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000537 train acc = 1.0000, test acc = 0.2804
[2023-10-26 10:55:51] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000549 train acc = 1.0000, test acc = 0.2705
[2023-10-26 10:55:54] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000545 train acc = 1.0000, test acc = 0.2828
[2023-10-26 10:55:56] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000535 train acc = 1.0000, test acc = 0.2818
[2023-10-26 10:55:59] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000526 train acc = 1.0000, test acc = 0.2808
[2023-10-26 10:56:02] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000536 train acc = 1.0000, test acc = 0.2856
Evaluate 20 random ConvNet, mean = 0.2783 std = 0.0069
-------------------------
[2023-10-26 10:56:03] iter = 0500, loss = 185.6121
[2023-10-26 10:56:05] iter = 0510, loss = 181.4241
[2023-10-26 10:56:07] iter = 0520, loss = 185.2604
[2023-10-26 10:56:09] iter = 0530, loss = 186.0566
[2023-10-26 10:56:11] iter = 0540, loss = 179.9410
[2023-10-26 10:56:14] iter = 0550, loss = 187.2562
[2023-10-26 10:56:16] iter = 0560, loss = 177.7957
[2023-10-26 10:56:18] iter = 0570, loss = 187.5566
[2023-10-26 10:56:20] iter = 0580, loss = 188.2681
[2023-10-26 10:56:23] iter = 0590, loss = 185.7954
[2023-10-26 10:56:25] iter = 0600, loss = 185.5429
[2023-10-26 10:56:27] iter = 0610, loss = 187.6765
[2023-10-26 10:56:29] iter = 0620, loss = 186.4196
[2023-10-26 10:56:32] iter = 0630, loss = 190.1594
[2023-10-26 10:56:34] iter = 0640, loss = 190.4118
[2023-10-26 10:56:36] iter = 0650, loss = 185.1776
[2023-10-26 10:56:38] iter = 0660, loss = 183.5792
[2023-10-26 10:56:40] iter = 0670, loss = 178.8570
[2023-10-26 10:56:43] iter = 0680, loss = 183.1759
[2023-10-26 10:56:45] iter = 0690, loss = 191.6953
[2023-10-26 10:56:47] iter = 0700, loss = 184.7502
[2023-10-26 10:56:49] iter = 0710, loss = 184.7188
[2023-10-26 10:56:52] iter = 0720, loss = 175.2320
[2023-10-26 10:56:54] iter = 0730, loss = 186.2170
[2023-10-26 10:56:56] iter = 0740, loss = 183.8898
[2023-10-26 10:56:58] iter = 0750, loss = 183.2988
[2023-10-26 10:57:01] iter = 0760, loss = 180.9478
[2023-10-26 10:57:03] iter = 0770, loss = 180.9801
[2023-10-26 10:57:05] iter = 0780, loss = 185.5031
[2023-10-26 10:57:07] iter = 0790, loss = 189.7794
[2023-10-26 10:57:10] iter = 0800, loss = 180.2178
[2023-10-26 10:57:12] iter = 0810, loss = 177.8685
[2023-10-26 10:57:14] iter = 0820, loss = 185.0902
[2023-10-26 10:57:16] iter = 0830, loss = 179.4512
[2023-10-26 10:57:19] iter = 0840, loss = 186.9813
[2023-10-26 10:57:21] iter = 0850, loss = 178.8661
[2023-10-26 10:57:23] iter = 0860, loss = 188.6610
[2023-10-26 10:57:26] iter = 0870, loss = 185.7721
[2023-10-26 10:57:28] iter = 0880, loss = 181.4743
[2023-10-26 10:57:30] iter = 0890, loss = 180.7377
[2023-10-26 10:57:32] iter = 0900, loss = 179.5963
[2023-10-26 10:57:35] iter = 0910, loss = 184.8007
[2023-10-26 10:57:37] iter = 0920, loss = 178.1770
[2023-10-26 10:57:39] iter = 0930, loss = 178.2304
[2023-10-26 10:57:41] iter = 0940, loss = 176.1595
[2023-10-26 10:57:44] iter = 0950, loss = 178.2875
[2023-10-26 10:57:46] iter = 0960, loss = 188.3380
[2023-10-26 10:57:48] iter = 0970, loss = 185.1948
[2023-10-26 10:57:50] iter = 0980, loss = 183.8309
[2023-10-26 10:57:53] iter = 0990, loss = 186.4899
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 10:57:58] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000560 train acc = 1.0000, test acc = 0.2823
[2023-10-26 10:58:00] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000597 train acc = 1.0000, test acc = 0.2739
[2023-10-26 10:58:03] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000570 train acc = 1.0000, test acc = 0.2807
[2023-10-26 10:58:06] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000578 train acc = 1.0000, test acc = 0.2813
[2023-10-26 10:58:09] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000631 train acc = 1.0000, test acc = 0.2790
[2023-10-26 10:58:12] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000561 train acc = 1.0000, test acc = 0.2860
[2023-10-26 10:58:15] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000529 train acc = 1.0000, test acc = 0.2811
[2023-10-26 10:58:18] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000608 train acc = 1.0000, test acc = 0.2742
[2023-10-26 10:58:21] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000536 train acc = 1.0000, test acc = 0.2860
[2023-10-26 10:58:24] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000598 train acc = 1.0000, test acc = 0.2743
[2023-10-26 10:58:27] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000594 train acc = 1.0000, test acc = 0.2723
[2023-10-26 10:58:30] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000559 train acc = 1.0000, test acc = 0.2760
[2023-10-26 10:58:33] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000554 train acc = 1.0000, test acc = 0.2769
[2023-10-26 10:58:36] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000587 train acc = 1.0000, test acc = 0.2882
[2023-10-26 10:58:39] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000561 train acc = 1.0000, test acc = 0.2980
[2023-10-26 10:58:41] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000607 train acc = 1.0000, test acc = 0.2770
[2023-10-26 10:58:44] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000580 train acc = 1.0000, test acc = 0.2908
[2023-10-26 10:58:47] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000525 train acc = 1.0000, test acc = 0.2890
[2023-10-26 10:58:50] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000593 train acc = 1.0000, test acc = 0.2787
[2023-10-26 10:58:53] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000580 train acc = 1.0000, test acc = 0.2802
Evaluate 20 random ConvNet, mean = 0.2813 std = 0.0065
-------------------------
[2023-10-26 10:58:53] iter = 1000, loss = 179.5973

================== Exp 3 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 1, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 1, 'inner_loop': 1, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7fdedb0d5ca0>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-26 10:59:09] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 10:59:12] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000454 train acc = 1.0000, test acc = 0.0873
[2023-10-26 10:59:15] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000438 train acc = 1.0000, test acc = 0.0953
[2023-10-26 10:59:18] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000455 train acc = 1.0000, test acc = 0.0879
[2023-10-26 10:59:21] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000405 train acc = 1.0000, test acc = 0.0842
[2023-10-26 10:59:24] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000455 train acc = 1.0000, test acc = 0.0798
[2023-10-26 10:59:27] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000441 train acc = 1.0000, test acc = 0.0890
[2023-10-26 10:59:30] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000422 train acc = 1.0000, test acc = 0.0801
[2023-10-26 10:59:32] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000443 train acc = 1.0000, test acc = 0.0798
[2023-10-26 10:59:35] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000429 train acc = 1.0000, test acc = 0.0917
[2023-10-26 10:59:38] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000433 train acc = 1.0000, test acc = 0.0779
[2023-10-26 10:59:41] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000420 train acc = 1.0000, test acc = 0.0842
[2023-10-26 10:59:44] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000429 train acc = 1.0000, test acc = 0.0785
[2023-10-26 10:59:47] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000450 train acc = 1.0000, test acc = 0.0749
[2023-10-26 10:59:50] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000435 train acc = 1.0000, test acc = 0.0790
[2023-10-26 10:59:53] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000457 train acc = 1.0000, test acc = 0.0926
[2023-10-26 10:59:56] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000431 train acc = 1.0000, test acc = 0.0873
[2023-10-26 10:59:59] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000436 train acc = 1.0000, test acc = 0.0924
[2023-10-26 11:00:02] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000433 train acc = 1.0000, test acc = 0.0995
[2023-10-26 11:00:05] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000424 train acc = 1.0000, test acc = 0.0798
[2023-10-26 11:00:08] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000448 train acc = 1.0000, test acc = 0.0910
Evaluate 20 random ConvNet, mean = 0.0856 std = 0.0066
-------------------------
[2023-10-26 11:00:08] iter = 0000, loss = 329.5062
[2023-10-26 11:00:10] iter = 0010, loss = 250.3129
[2023-10-26 11:00:12] iter = 0020, loss = 237.8716
[2023-10-26 11:00:14] iter = 0030, loss = 222.7185
[2023-10-26 11:00:17] iter = 0040, loss = 210.4542
[2023-10-26 11:00:19] iter = 0050, loss = 212.9850
[2023-10-26 11:00:21] iter = 0060, loss = 210.7487
[2023-10-26 11:00:24] iter = 0070, loss = 209.2688
[2023-10-26 11:00:26] iter = 0080, loss = 206.9461
[2023-10-26 11:00:28] iter = 0090, loss = 207.6231
[2023-10-26 11:00:31] iter = 0100, loss = 207.1668
[2023-10-26 11:00:33] iter = 0110, loss = 198.9287
[2023-10-26 11:00:35] iter = 0120, loss = 201.4746
[2023-10-26 11:00:37] iter = 0130, loss = 202.3471
[2023-10-26 11:00:40] iter = 0140, loss = 204.8626
[2023-10-26 11:00:42] iter = 0150, loss = 195.5208
[2023-10-26 11:00:44] iter = 0160, loss = 197.0424
[2023-10-26 11:00:47] iter = 0170, loss = 202.9332
[2023-10-26 11:00:49] iter = 0180, loss = 194.0569
[2023-10-26 11:00:51] iter = 0190, loss = 197.7027
[2023-10-26 11:00:53] iter = 0200, loss = 196.2617
[2023-10-26 11:00:56] iter = 0210, loss = 188.8620
[2023-10-26 11:00:58] iter = 0220, loss = 197.0636
[2023-10-26 11:01:00] iter = 0230, loss = 194.9891
[2023-10-26 11:01:03] iter = 0240, loss = 193.0070
[2023-10-26 11:01:05] iter = 0250, loss = 198.3419
[2023-10-26 11:01:07] iter = 0260, loss = 193.9190
[2023-10-26 11:01:10] iter = 0270, loss = 190.9748
[2023-10-26 11:01:12] iter = 0280, loss = 191.6015
[2023-10-26 11:01:14] iter = 0290, loss = 183.3415
[2023-10-26 11:01:16] iter = 0300, loss = 193.2466
[2023-10-26 11:01:19] iter = 0310, loss = 184.6557
[2023-10-26 11:01:21] iter = 0320, loss = 192.2407
[2023-10-26 11:01:23] iter = 0330, loss = 189.2090
[2023-10-26 11:01:25] iter = 0340, loss = 192.9541
[2023-10-26 11:01:28] iter = 0350, loss = 193.1064
[2023-10-26 11:01:30] iter = 0360, loss = 187.6474
[2023-10-26 11:01:32] iter = 0370, loss = 194.4242
[2023-10-26 11:01:35] iter = 0380, loss = 192.5223
[2023-10-26 11:01:37] iter = 0390, loss = 190.3596
[2023-10-26 11:01:39] iter = 0400, loss = 196.3481
[2023-10-26 11:01:42] iter = 0410, loss = 187.2968
[2023-10-26 11:01:44] iter = 0420, loss = 184.8562
[2023-10-26 11:01:46] iter = 0430, loss = 190.0312
[2023-10-26 11:01:49] iter = 0440, loss = 185.9900
[2023-10-26 11:01:51] iter = 0450, loss = 189.1196
[2023-10-26 11:01:53] iter = 0460, loss = 189.0764
[2023-10-26 11:01:55] iter = 0470, loss = 183.2310
[2023-10-26 11:01:58] iter = 0480, loss = 184.8070
[2023-10-26 11:02:00] iter = 0490, loss = 187.1551
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 11:02:05] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000572 train acc = 1.0000, test acc = 0.2623
[2023-10-26 11:02:08] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000524 train acc = 1.0000, test acc = 0.2792
[2023-10-26 11:02:11] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000591 train acc = 1.0000, test acc = 0.2796
[2023-10-26 11:02:13] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000536 train acc = 1.0000, test acc = 0.2716
[2023-10-26 11:02:16] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000586 train acc = 1.0000, test acc = 0.2756
[2023-10-26 11:02:19] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000550 train acc = 1.0000, test acc = 0.2858
[2023-10-26 11:02:22] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000547 train acc = 1.0000, test acc = 0.2767
[2023-10-26 11:02:25] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000555 train acc = 1.0000, test acc = 0.2796
[2023-10-26 11:02:28] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000579 train acc = 1.0000, test acc = 0.2807
[2023-10-26 11:02:31] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000566 train acc = 1.0000, test acc = 0.2772
[2023-10-26 11:02:34] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000533 train acc = 1.0000, test acc = 0.2857
[2023-10-26 11:02:37] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000548 train acc = 1.0000, test acc = 0.2852
[2023-10-26 11:02:39] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000561 train acc = 1.0000, test acc = 0.2778
[2023-10-26 11:02:42] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000582 train acc = 1.0000, test acc = 0.2807
[2023-10-26 11:02:45] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000562 train acc = 1.0000, test acc = 0.2778
[2023-10-26 11:02:48] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000558 train acc = 1.0000, test acc = 0.2793
[2023-10-26 11:02:51] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000567 train acc = 1.0000, test acc = 0.2785
[2023-10-26 11:02:54] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000596 train acc = 1.0000, test acc = 0.2769
[2023-10-26 11:02:57] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000559 train acc = 1.0000, test acc = 0.2788
[2023-10-26 11:03:00] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000578 train acc = 1.0000, test acc = 0.2870
Evaluate 20 random ConvNet, mean = 0.2788 std = 0.0053
-------------------------
[2023-10-26 11:03:00] iter = 0500, loss = 184.9755
[2023-10-26 11:03:02] iter = 0510, loss = 183.8825
[2023-10-26 11:03:05] iter = 0520, loss = 188.0363
[2023-10-26 11:03:07] iter = 0530, loss = 188.3529
[2023-10-26 11:03:09] iter = 0540, loss = 186.7111
[2023-10-26 11:03:12] iter = 0550, loss = 184.2348
[2023-10-26 11:03:15] iter = 0560, loss = 188.4064
[2023-10-26 11:03:18] iter = 0570, loss = 189.8804
[2023-10-26 11:03:20] iter = 0580, loss = 186.3984
[2023-10-26 11:03:23] iter = 0590, loss = 181.6915
[2023-10-26 11:03:26] iter = 0600, loss = 183.3716
[2023-10-26 11:03:28] iter = 0610, loss = 185.0337
[2023-10-26 11:03:31] iter = 0620, loss = 181.9817
[2023-10-26 11:03:34] iter = 0630, loss = 186.6626
[2023-10-26 11:03:36] iter = 0640, loss = 183.5156
[2023-10-26 11:03:38] iter = 0650, loss = 180.8680
[2023-10-26 11:03:40] iter = 0660, loss = 186.5577
[2023-10-26 11:03:42] iter = 0670, loss = 184.0261
[2023-10-26 11:03:44] iter = 0680, loss = 185.2992
[2023-10-26 11:03:46] iter = 0690, loss = 182.7246
[2023-10-26 11:03:47] iter = 0700, loss = 185.2081
[2023-10-26 11:03:49] iter = 0710, loss = 184.7357
[2023-10-26 11:03:51] iter = 0720, loss = 171.8573
[2023-10-26 11:03:53] iter = 0730, loss = 184.6246
[2023-10-26 11:03:55] iter = 0740, loss = 179.3987
[2023-10-26 11:03:57] iter = 0750, loss = 179.0431
[2023-10-26 11:03:59] iter = 0760, loss = 185.7998
[2023-10-26 11:04:01] iter = 0770, loss = 182.8771
[2023-10-26 11:04:03] iter = 0780, loss = 180.7432
[2023-10-26 11:04:05] iter = 0790, loss = 181.9398
[2023-10-26 11:04:07] iter = 0800, loss = 185.8437
[2023-10-26 11:04:09] iter = 0810, loss = 185.9606
[2023-10-26 11:04:11] iter = 0820, loss = 180.3617
[2023-10-26 11:04:13] iter = 0830, loss = 190.5206
[2023-10-26 11:04:15] iter = 0840, loss = 177.2563
[2023-10-26 11:04:16] iter = 0850, loss = 183.5884
[2023-10-26 11:04:18] iter = 0860, loss = 179.3336
[2023-10-26 11:04:20] iter = 0870, loss = 180.8061
[2023-10-26 11:04:22] iter = 0880, loss = 180.7362
[2023-10-26 11:04:24] iter = 0890, loss = 178.3347
[2023-10-26 11:04:26] iter = 0900, loss = 185.6321
[2023-10-26 11:04:28] iter = 0910, loss = 180.1548
[2023-10-26 11:04:30] iter = 0920, loss = 190.1952
[2023-10-26 11:04:32] iter = 0930, loss = 179.6210
[2023-10-26 11:04:34] iter = 0940, loss = 183.7043
[2023-10-26 11:04:36] iter = 0950, loss = 176.7985
[2023-10-26 11:04:38] iter = 0960, loss = 186.8116
[2023-10-26 11:04:40] iter = 0970, loss = 176.3759
[2023-10-26 11:04:42] iter = 0980, loss = 183.6899
[2023-10-26 11:04:44] iter = 0990, loss = 187.5308
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 11:04:48] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000584 train acc = 1.0000, test acc = 0.2826
[2023-10-26 11:04:51] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000579 train acc = 1.0000, test acc = 0.2848
[2023-10-26 11:04:54] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000530 train acc = 1.0000, test acc = 0.2862
[2023-10-26 11:04:57] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000560 train acc = 1.0000, test acc = 0.2780
[2023-10-26 11:05:00] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000603 train acc = 1.0000, test acc = 0.2812
[2023-10-26 11:05:02] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000604 train acc = 1.0000, test acc = 0.2628
[2023-10-26 11:05:05] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000558 train acc = 1.0000, test acc = 0.2891
[2023-10-26 11:05:08] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000554 train acc = 1.0000, test acc = 0.2843
[2023-10-26 11:05:11] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000607 train acc = 1.0000, test acc = 0.2797
[2023-10-26 11:05:14] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000571 train acc = 1.0000, test acc = 0.2886
[2023-10-26 11:05:17] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000536 train acc = 1.0000, test acc = 0.2821
[2023-10-26 11:05:20] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000596 train acc = 1.0000, test acc = 0.2728
[2023-10-26 11:05:22] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000561 train acc = 1.0000, test acc = 0.2855
[2023-10-26 11:05:25] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000605 train acc = 1.0000, test acc = 0.2848
[2023-10-26 11:05:28] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000575 train acc = 1.0000, test acc = 0.2862
[2023-10-26 11:05:31] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000607 train acc = 1.0000, test acc = 0.2674
[2023-10-26 11:05:34] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000569 train acc = 1.0000, test acc = 0.2754
[2023-10-26 11:05:37] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000562 train acc = 1.0000, test acc = 0.2951
[2023-10-26 11:05:40] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000542 train acc = 1.0000, test acc = 0.2898
[2023-10-26 11:05:42] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000576 train acc = 1.0000, test acc = 0.2790
Evaluate 20 random ConvNet, mean = 0.2818 std = 0.0075
-------------------------
[2023-10-26 11:05:43] iter = 1000, loss = 184.7988

================== Exp 4 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 1, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 1, 'inner_loop': 1, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7fdedb0d5ca0>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-26 11:05:58] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 11:06:01] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000430 train acc = 1.0000, test acc = 0.1026
[2023-10-26 11:06:04] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000420 train acc = 1.0000, test acc = 0.0861
[2023-10-26 11:06:07] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000442 train acc = 1.0000, test acc = 0.0923
[2023-10-26 11:06:10] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000429 train acc = 1.0000, test acc = 0.0842
[2023-10-26 11:06:13] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000435 train acc = 1.0000, test acc = 0.0910
[2023-10-26 11:06:16] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000446 train acc = 1.0000, test acc = 0.0868
[2023-10-26 11:06:19] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000445 train acc = 1.0000, test acc = 0.0935
[2023-10-26 11:06:21] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000446 train acc = 1.0000, test acc = 0.0906
[2023-10-26 11:06:24] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000435 train acc = 1.0000, test acc = 0.0801
[2023-10-26 11:06:27] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000461 train acc = 1.0000, test acc = 0.0907
[2023-10-26 11:06:30] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000432 train acc = 1.0000, test acc = 0.0979
[2023-10-26 11:06:33] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000443 train acc = 1.0000, test acc = 0.0959
[2023-10-26 11:06:36] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000419 train acc = 1.0000, test acc = 0.0966
[2023-10-26 11:06:39] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000432 train acc = 1.0000, test acc = 0.0978
[2023-10-26 11:06:41] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000446 train acc = 1.0000, test acc = 0.0979
[2023-10-26 11:06:44] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000446 train acc = 1.0000, test acc = 0.0875
[2023-10-26 11:06:47] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000435 train acc = 1.0000, test acc = 0.1025
[2023-10-26 11:06:50] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000424 train acc = 1.0000, test acc = 0.0909
[2023-10-26 11:06:53] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000428 train acc = 1.0000, test acc = 0.0939
[2023-10-26 11:06:56] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000420 train acc = 1.0000, test acc = 0.0908
Evaluate 20 random ConvNet, mean = 0.0925 std = 0.0057
-------------------------
[2023-10-26 11:06:56] iter = 0000, loss = 316.0883
[2023-10-26 11:06:58] iter = 0010, loss = 256.4815
[2023-10-26 11:07:00] iter = 0020, loss = 234.7988
[2023-10-26 11:07:02] iter = 0030, loss = 224.3580
[2023-10-26 11:07:04] iter = 0040, loss = 219.5217
[2023-10-26 11:07:05] iter = 0050, loss = 221.2315
[2023-10-26 11:07:07] iter = 0060, loss = 212.7490
[2023-10-26 11:07:09] iter = 0070, loss = 212.7830
[2023-10-26 11:07:11] iter = 0080, loss = 208.3924
[2023-10-26 11:07:13] iter = 0090, loss = 201.0141
[2023-10-26 11:07:15] iter = 0100, loss = 203.4823
[2023-10-26 11:07:17] iter = 0110, loss = 201.9456
[2023-10-26 11:07:19] iter = 0120, loss = 199.5246
[2023-10-26 11:07:21] iter = 0130, loss = 203.1869
[2023-10-26 11:07:23] iter = 0140, loss = 208.3785
[2023-10-26 11:07:25] iter = 0150, loss = 201.4818
[2023-10-26 11:07:27] iter = 0160, loss = 198.1853
[2023-10-26 11:07:29] iter = 0170, loss = 197.4481
[2023-10-26 11:07:31] iter = 0180, loss = 199.9046
[2023-10-26 11:07:32] iter = 0190, loss = 197.8942
[2023-10-26 11:07:34] iter = 0200, loss = 192.3228
[2023-10-26 11:07:36] iter = 0210, loss = 194.1628
[2023-10-26 11:07:38] iter = 0220, loss = 191.2076
[2023-10-26 11:07:40] iter = 0230, loss = 191.4135
[2023-10-26 11:07:42] iter = 0240, loss = 195.0205
[2023-10-26 11:07:44] iter = 0250, loss = 201.9053
[2023-10-26 11:07:46] iter = 0260, loss = 191.1940
[2023-10-26 11:07:48] iter = 0270, loss = 185.3498
[2023-10-26 11:07:50] iter = 0280, loss = 197.3911
[2023-10-26 11:07:52] iter = 0290, loss = 196.4062
[2023-10-26 11:07:54] iter = 0300, loss = 197.2872
[2023-10-26 11:07:56] iter = 0310, loss = 185.1143
[2023-10-26 11:07:58] iter = 0320, loss = 193.2664
[2023-10-26 11:08:00] iter = 0330, loss = 190.6182
[2023-10-26 11:08:01] iter = 0340, loss = 197.7033
[2023-10-26 11:08:03] iter = 0350, loss = 194.0901
[2023-10-26 11:08:05] iter = 0360, loss = 183.8544
[2023-10-26 11:08:07] iter = 0370, loss = 190.7207
[2023-10-26 11:08:09] iter = 0380, loss = 189.7440
[2023-10-26 11:08:11] iter = 0390, loss = 192.5131
[2023-10-26 11:08:13] iter = 0400, loss = 186.6766
[2023-10-26 11:08:15] iter = 0410, loss = 194.9495
[2023-10-26 11:08:17] iter = 0420, loss = 195.5386
[2023-10-26 11:08:19] iter = 0430, loss = 186.8766
[2023-10-26 11:08:21] iter = 0440, loss = 192.6658
[2023-10-26 11:08:23] iter = 0450, loss = 187.4230
[2023-10-26 11:08:25] iter = 0460, loss = 188.9192
[2023-10-26 11:08:27] iter = 0470, loss = 188.1499
[2023-10-26 11:08:29] iter = 0480, loss = 191.1822
[2023-10-26 11:08:31] iter = 0490, loss = 182.6485
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 11:08:35] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000538 train acc = 1.0000, test acc = 0.2888
[2023-10-26 11:08:38] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000578 train acc = 1.0000, test acc = 0.2881
[2023-10-26 11:08:41] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000579 train acc = 1.0000, test acc = 0.2838
[2023-10-26 11:08:44] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000540 train acc = 1.0000, test acc = 0.2862
[2023-10-26 11:08:47] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000523 train acc = 1.0000, test acc = 0.2849
[2023-10-26 11:08:49] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000567 train acc = 1.0000, test acc = 0.2797
[2023-10-26 11:08:52] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000550 train acc = 1.0000, test acc = 0.2852
[2023-10-26 11:08:55] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000565 train acc = 1.0000, test acc = 0.2794
[2023-10-26 11:08:58] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000556 train acc = 1.0000, test acc = 0.2833
[2023-10-26 11:09:01] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000519 train acc = 1.0000, test acc = 0.2887
[2023-10-26 11:09:04] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000550 train acc = 1.0000, test acc = 0.2827
[2023-10-26 11:09:07] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000573 train acc = 1.0000, test acc = 0.2807
[2023-10-26 11:09:10] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000551 train acc = 1.0000, test acc = 0.2771
[2023-10-26 11:09:12] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000540 train acc = 1.0000, test acc = 0.2760
[2023-10-26 11:09:15] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000525 train acc = 1.0000, test acc = 0.2741
[2023-10-26 11:09:18] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000576 train acc = 1.0000, test acc = 0.2850
[2023-10-26 11:09:21] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000575 train acc = 1.0000, test acc = 0.2764
[2023-10-26 11:09:24] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000556 train acc = 1.0000, test acc = 0.2826
[2023-10-26 11:09:27] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000582 train acc = 1.0000, test acc = 0.2787
[2023-10-26 11:09:30] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000567 train acc = 1.0000, test acc = 0.2819
Evaluate 20 random ConvNet, mean = 0.2822 std = 0.0042
-------------------------
[2023-10-26 11:09:30] iter = 0500, loss = 190.7558
[2023-10-26 11:09:32] iter = 0510, loss = 186.6433
[2023-10-26 11:09:34] iter = 0520, loss = 188.0336
[2023-10-26 11:09:36] iter = 0530, loss = 186.6683
[2023-10-26 11:09:37] iter = 0540, loss = 184.8029
[2023-10-26 11:09:39] iter = 0550, loss = 183.7628
[2023-10-26 11:09:41] iter = 0560, loss = 180.3757
[2023-10-26 11:09:43] iter = 0570, loss = 187.6858
[2023-10-26 11:09:45] iter = 0580, loss = 181.6176
[2023-10-26 11:09:47] iter = 0590, loss = 179.8744
[2023-10-26 11:09:49] iter = 0600, loss = 183.5437
[2023-10-26 11:09:51] iter = 0610, loss = 181.9100
[2023-10-26 11:09:53] iter = 0620, loss = 181.6951
[2023-10-26 11:09:55] iter = 0630, loss = 185.1831
[2023-10-26 11:09:57] iter = 0640, loss = 182.6428
[2023-10-26 11:09:59] iter = 0650, loss = 184.3371
[2023-10-26 11:10:01] iter = 0660, loss = 186.6529
[2023-10-26 11:10:03] iter = 0670, loss = 182.9184
[2023-10-26 11:10:05] iter = 0680, loss = 181.3858
[2023-10-26 11:10:06] iter = 0690, loss = 184.0650
[2023-10-26 11:10:08] iter = 0700, loss = 179.8693
[2023-10-26 11:10:10] iter = 0710, loss = 179.3408
[2023-10-26 11:10:12] iter = 0720, loss = 186.0903
[2023-10-26 11:10:14] iter = 0730, loss = 180.1056
[2023-10-26 11:10:16] iter = 0740, loss = 182.3863
[2023-10-26 11:10:18] iter = 0750, loss = 184.6587
[2023-10-26 11:10:20] iter = 0760, loss = 182.1886
[2023-10-26 11:10:22] iter = 0770, loss = 183.1457
[2023-10-26 11:10:24] iter = 0780, loss = 190.5004
[2023-10-26 11:10:26] iter = 0790, loss = 179.4444
[2023-10-26 11:10:28] iter = 0800, loss = 186.2111
[2023-10-26 11:10:30] iter = 0810, loss = 177.1243
[2023-10-26 11:10:32] iter = 0820, loss = 179.9751
[2023-10-26 11:10:34] iter = 0830, loss = 177.2431
[2023-10-26 11:10:36] iter = 0840, loss = 185.3031
[2023-10-26 11:10:37] iter = 0850, loss = 181.1897
[2023-10-26 11:10:39] iter = 0860, loss = 177.2733
[2023-10-26 11:10:41] iter = 0870, loss = 175.8191
[2023-10-26 11:10:43] iter = 0880, loss = 186.4730
[2023-10-26 11:10:45] iter = 0890, loss = 182.3763
[2023-10-26 11:10:47] iter = 0900, loss = 187.1363
[2023-10-26 11:10:49] iter = 0910, loss = 177.3329
[2023-10-26 11:10:51] iter = 0920, loss = 178.2095
[2023-10-26 11:10:53] iter = 0930, loss = 179.8948
[2023-10-26 11:10:55] iter = 0940, loss = 181.0728
[2023-10-26 11:10:57] iter = 0950, loss = 183.0784
[2023-10-26 11:10:59] iter = 0960, loss = 183.3480
[2023-10-26 11:11:01] iter = 0970, loss = 182.2497
[2023-10-26 11:11:03] iter = 0980, loss = 184.3370
[2023-10-26 11:11:04] iter = 0990, loss = 183.7667
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 11:11:09] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000578 train acc = 1.0000, test acc = 0.2762
[2023-10-26 11:11:12] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000588 train acc = 1.0000, test acc = 0.2785
[2023-10-26 11:11:15] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000615 train acc = 1.0000, test acc = 0.2819
[2023-10-26 11:11:18] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000554 train acc = 1.0000, test acc = 0.2832
[2023-10-26 11:11:20] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000544 train acc = 1.0000, test acc = 0.2866
[2023-10-26 11:11:23] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000603 train acc = 1.0000, test acc = 0.2824
[2023-10-26 11:11:26] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000557 train acc = 1.0000, test acc = 0.2759
[2023-10-26 11:11:29] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000541 train acc = 1.0000, test acc = 0.2776
[2023-10-26 11:11:32] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000549 train acc = 1.0000, test acc = 0.3005
[2023-10-26 11:11:35] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000582 train acc = 1.0000, test acc = 0.2791
[2023-10-26 11:11:38] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000552 train acc = 1.0000, test acc = 0.2846
[2023-10-26 11:11:40] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000575 train acc = 1.0000, test acc = 0.2868
[2023-10-26 11:11:43] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000572 train acc = 1.0000, test acc = 0.2780
[2023-10-26 11:11:46] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000557 train acc = 1.0000, test acc = 0.2746
[2023-10-26 11:11:49] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000542 train acc = 1.0000, test acc = 0.2761
[2023-10-26 11:11:52] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000583 train acc = 1.0000, test acc = 0.2822
[2023-10-26 11:11:55] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000609 train acc = 1.0000, test acc = 0.2688
[2023-10-26 11:11:58] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000618 train acc = 1.0000, test acc = 0.2844
[2023-10-26 11:12:01] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000575 train acc = 1.0000, test acc = 0.2849
[2023-10-26 11:12:04] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000569 train acc = 1.0000, test acc = 0.2905
Evaluate 20 random ConvNet, mean = 0.2816 std = 0.0066
-------------------------
[2023-10-26 11:12:04] iter = 1000, loss = 180.3474

==================== Final Results ====================

Run 5 experiments, train on ConvNet, evaluate 100 random ConvNet, mean  = 28.10%  std = 0.65%
