/data/happythgus/newLDA/DC
/data/opt/anaconda3/envs/pytorch1.12.1_p38/bin/python
moana-r4
main.py:95: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
main.py:95: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484810403/work/torch/csrc/utils/tensor_new.cpp:201.)
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
eval_it_pool:  [0, 500, 1000]
Files already downloaded and verified
Files already downloaded and verified

================== Exp 0 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f6fd74d8cd0>, 'dsa': False}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-31 11:39:35] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-31 11:39:41] Evaluate_00: epoch = 0300 train time = 4 s train loss = 0.003670 train acc = 1.0000, test acc = 0.0715
[2023-10-31 11:39:45] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.003672 train acc = 1.0000, test acc = 0.0682
[2023-10-31 11:39:49] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.003697 train acc = 1.0000, test acc = 0.0665
[2023-10-31 11:39:53] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.003643 train acc = 1.0000, test acc = 0.0644
[2023-10-31 11:39:56] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.003690 train acc = 1.0000, test acc = 0.0735
[2023-10-31 11:40:00] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.003745 train acc = 1.0000, test acc = 0.0677
[2023-10-31 11:40:04] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.003564 train acc = 1.0000, test acc = 0.0625
[2023-10-31 11:40:08] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.003662 train acc = 1.0000, test acc = 0.0738
[2023-10-31 11:40:11] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.003650 train acc = 1.0000, test acc = 0.0690
[2023-10-31 11:40:15] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.003669 train acc = 1.0000, test acc = 0.0764
[2023-10-31 11:40:19] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.003583 train acc = 1.0000, test acc = 0.0689
[2023-10-31 11:40:23] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.003642 train acc = 1.0000, test acc = 0.0618
[2023-10-31 11:40:26] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.003661 train acc = 1.0000, test acc = 0.0723
[2023-10-31 11:40:30] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.003687 train acc = 1.0000, test acc = 0.0666
[2023-10-31 11:40:34] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.003649 train acc = 1.0000, test acc = 0.0645
[2023-10-31 11:40:38] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.003793 train acc = 1.0000, test acc = 0.0709
[2023-10-31 11:40:41] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.003554 train acc = 1.0000, test acc = 0.0649
[2023-10-31 11:40:45] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.003664 train acc = 1.0000, test acc = 0.0674
[2023-10-31 11:40:49] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.003630 train acc = 1.0000, test acc = 0.0678
[2023-10-31 11:40:53] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.003613 train acc = 1.0000, test acc = 0.0641
Evaluate 20 random ConvNet, mean = 0.0681 std = 0.0039
-------------------------
[2023-10-31 11:41:00] iter = 0000, loss = inf
[2023-10-31 11:42:07] iter = 0010, loss = inf
[2023-10-31 11:43:14] iter = 0020, loss = nan
[2023-10-31 11:44:22] iter = 0030, loss = inf
[2023-10-31 11:45:29] iter = 0040, loss = inf
[2023-10-31 11:46:37] iter = 0050, loss = inf
[2023-10-31 11:47:44] iter = 0060, loss = inf
[2023-10-31 11:48:51] iter = 0070, loss = inf
[2023-10-31 11:49:58] iter = 0080, loss = inf
[2023-10-31 11:51:05] iter = 0090, loss = inf
[2023-10-31 11:52:11] iter = 0100, loss = inf
[2023-10-31 11:53:17] iter = 0110, loss = inf
[2023-10-31 11:54:24] iter = 0120, loss = nan
[2023-10-31 11:55:32] iter = 0130, loss = inf
[2023-10-31 11:56:39] iter = 0140, loss = inf
[2023-10-31 11:57:47] iter = 0150, loss = inf
[2023-10-31 11:58:54] iter = 0160, loss = inf
[2023-10-31 12:00:01] iter = 0170, loss = inf
[2023-10-31 12:01:08] iter = 0180, loss = nan
[2023-10-31 12:02:15] iter = 0190, loss = inf
[2023-10-31 12:03:23] iter = 0200, loss = inf
[2023-10-31 12:04:30] iter = 0210, loss = nan
[2023-10-31 12:05:37] iter = 0220, loss = inf
[2023-10-31 12:06:45] iter = 0230, loss = nan
[2023-10-31 12:07:51] iter = 0240, loss = nan
[2023-10-31 12:08:59] iter = 0250, loss = inf
[2023-10-31 12:10:06] iter = 0260, loss = inf
[2023-10-31 12:11:13] iter = 0270, loss = inf
[2023-10-31 12:12:20] iter = 0280, loss = inf
[2023-10-31 12:13:27] iter = 0290, loss = inf
[2023-10-31 12:14:34] iter = 0300, loss = inf
[2023-10-31 12:15:41] iter = 0310, loss = inf
[2023-10-31 12:16:49] iter = 0320, loss = inf
[2023-10-31 12:17:56] iter = 0330, loss = inf
[2023-10-31 12:19:03] iter = 0340, loss = inf
[2023-10-31 12:20:11] iter = 0350, loss = inf
[2023-10-31 12:21:18] iter = 0360, loss = inf
[2023-10-31 12:22:25] iter = 0370, loss = inf
[2023-10-31 12:23:33] iter = 0380, loss = inf
[2023-10-31 12:24:40] iter = 0390, loss = inf
[2023-10-31 12:25:47] iter = 0400, loss = nan
[2023-10-31 12:26:55] iter = 0410, loss = inf
[2023-10-31 12:28:01] iter = 0420, loss = inf
[2023-10-31 12:29:08] iter = 0430, loss = nan
[2023-10-31 12:30:16] iter = 0440, loss = nan
[2023-10-31 12:31:23] iter = 0450, loss = nan
[2023-10-31 12:32:30] iter = 0460, loss = inf
[2023-10-31 12:33:38] iter = 0470, loss = nan
[2023-10-31 12:34:45] iter = 0480, loss = inf
[2023-10-31 12:35:52] iter = 0490, loss = nan
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-31 12:36:57] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.008466 train acc = 1.0000, test acc = 0.4046
[2023-10-31 12:37:00] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.008547 train acc = 1.0000, test acc = 0.3984
[2023-10-31 12:37:04] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.008529 train acc = 1.0000, test acc = 0.3972
[2023-10-31 12:37:08] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.008442 train acc = 1.0000, test acc = 0.3935
[2023-10-31 12:37:12] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.008428 train acc = 1.0000, test acc = 0.3941
[2023-10-31 12:37:15] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.008267 train acc = 1.0000, test acc = 0.4095
[2023-10-31 12:37:19] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.008344 train acc = 1.0000, test acc = 0.4032
[2023-10-31 12:37:23] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.008956 train acc = 1.0000, test acc = 0.3881
[2023-10-31 12:37:27] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.008402 train acc = 1.0000, test acc = 0.4063
[2023-10-31 12:37:31] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.008269 train acc = 1.0000, test acc = 0.4052
[2023-10-31 12:37:34] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.008553 train acc = 1.0000, test acc = 0.4012
[2023-10-31 12:37:38] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.008377 train acc = 1.0000, test acc = 0.3978
[2023-10-31 12:37:42] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.008496 train acc = 1.0000, test acc = 0.4032
[2023-10-31 12:37:46] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.008286 train acc = 1.0000, test acc = 0.4005
[2023-10-31 12:37:49] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.008221 train acc = 1.0000, test acc = 0.4027
[2023-10-31 12:37:53] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.008085 train acc = 1.0000, test acc = 0.3861
[2023-10-31 12:37:57] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.008254 train acc = 1.0000, test acc = 0.4098
[2023-10-31 12:38:01] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.008462 train acc = 1.0000, test acc = 0.4089
[2023-10-31 12:38:04] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.008111 train acc = 1.0000, test acc = 0.4191
[2023-10-31 12:38:08] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.008390 train acc = 1.0000, test acc = 0.4125
Evaluate 20 random ConvNet, mean = 0.4021 std = 0.0079
-------------------------
[2023-10-31 12:38:15] iter = 0500, loss = nan
[2023-10-31 12:39:23] iter = 0510, loss = nan
[2023-10-31 12:40:30] iter = 0520, loss = inf
[2023-10-31 12:41:37] iter = 0530, loss = inf
[2023-10-31 12:42:45] iter = 0540, loss = inf
[2023-10-31 12:43:52] iter = 0550, loss = inf
[2023-10-31 12:44:59] iter = 0560, loss = nan
[2023-10-31 12:46:07] iter = 0570, loss = nan
[2023-10-31 12:47:13] iter = 0580, loss = nan
[2023-10-31 12:48:21] iter = 0590, loss = nan
[2023-10-31 12:49:29] iter = 0600, loss = nan
[2023-10-31 12:50:36] iter = 0610, loss = inf
[2023-10-31 12:51:43] iter = 0620, loss = nan
[2023-10-31 12:52:51] iter = 0630, loss = inf
[2023-10-31 12:53:58] iter = 0640, loss = nan
[2023-10-31 12:55:05] iter = 0650, loss = inf
[2023-10-31 12:56:13] iter = 0660, loss = inf
[2023-10-31 12:57:21] iter = 0670, loss = inf
[2023-10-31 12:58:27] iter = 0680, loss = nan
[2023-10-31 12:59:36] iter = 0690, loss = nan
[2023-10-31 13:00:42] iter = 0700, loss = nan
[2023-10-31 13:01:49] iter = 0710, loss = inf
[2023-10-31 13:02:57] iter = 0720, loss = inf
[2023-10-31 13:04:04] iter = 0730, loss = inf
[2023-10-31 13:05:11] iter = 0740, loss = nan
[2023-10-31 13:06:18] iter = 0750, loss = inf
[2023-10-31 13:07:25] iter = 0760, loss = inf
[2023-10-31 13:08:32] iter = 0770, loss = inf
[2023-10-31 13:09:40] iter = 0780, loss = nan
[2023-10-31 13:10:47] iter = 0790, loss = nan
[2023-10-31 13:11:54] iter = 0800, loss = nan
[2023-10-31 13:13:02] iter = 0810, loss = nan
[2023-10-31 13:14:09] iter = 0820, loss = inf
[2023-10-31 13:15:16] iter = 0830, loss = nan
[2023-10-31 13:16:24] iter = 0840, loss = inf
[2023-10-31 13:17:31] iter = 0850, loss = inf
[2023-10-31 13:18:37] iter = 0860, loss = nan
[2023-10-31 13:19:45] iter = 0870, loss = inf
[2023-10-31 13:20:52] iter = 0880, loss = inf
[2023-10-31 13:21:59] iter = 0890, loss = inf
[2023-10-31 13:23:05] iter = 0900, loss = inf
[2023-10-31 13:24:11] iter = 0910, loss = inf
[2023-10-31 13:25:19] iter = 0920, loss = nan
[2023-10-31 13:26:26] iter = 0930, loss = inf
[2023-10-31 13:27:33] iter = 0940, loss = inf
[2023-10-31 13:28:41] iter = 0950, loss = nan
[2023-10-31 13:29:47] iter = 0960, loss = inf
[2023-10-31 13:30:55] iter = 0970, loss = nan
[2023-10-31 13:32:02] iter = 0980, loss = inf
[2023-10-31 13:33:09] iter = 0990, loss = nan
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-31 13:34:14] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.008436 train acc = 1.0000, test acc = 0.4217
[2023-10-31 13:34:17] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.009087 train acc = 1.0000, test acc = 0.4321
[2023-10-31 13:34:21] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.008629 train acc = 1.0000, test acc = 0.4024
[2023-10-31 13:34:25] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.008414 train acc = 1.0000, test acc = 0.4163
[2023-10-31 13:34:29] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.008874 train acc = 1.0000, test acc = 0.4163
[2023-10-31 13:34:32] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.008545 train acc = 1.0000, test acc = 0.4192
[2023-10-31 13:34:36] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.008373 train acc = 1.0000, test acc = 0.4126
[2023-10-31 13:34:40] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.009117 train acc = 1.0000, test acc = 0.4026
[2023-10-31 13:34:44] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.008654 train acc = 1.0000, test acc = 0.4039
[2023-10-31 13:34:48] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.008560 train acc = 1.0000, test acc = 0.3984
[2023-10-31 13:34:51] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.008546 train acc = 1.0000, test acc = 0.4245
[2023-10-31 13:34:55] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.008282 train acc = 1.0000, test acc = 0.4232
[2023-10-31 13:34:59] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.008077 train acc = 1.0000, test acc = 0.4199
[2023-10-31 13:35:02] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.008413 train acc = 1.0000, test acc = 0.4186
[2023-10-31 13:35:06] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.008738 train acc = 1.0000, test acc = 0.4129
[2023-10-31 13:35:10] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.008470 train acc = 1.0000, test acc = 0.4042
[2023-10-31 13:35:14] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.008714 train acc = 1.0000, test acc = 0.3924
[2023-10-31 13:35:17] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.008358 train acc = 1.0000, test acc = 0.4076
[2023-10-31 13:35:21] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.008755 train acc = 1.0000, test acc = 0.4059
[2023-10-31 13:35:25] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.009152 train acc = 1.0000, test acc = 0.3920
Evaluate 20 random ConvNet, mean = 0.4113 std = 0.0107
-------------------------
[2023-10-31 13:35:31] iter = 1000, loss = nan

================== Exp 1 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f6fd74d8cd0>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-31 13:35:48] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-31 13:35:52] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.003677 train acc = 1.0000, test acc = 0.1282
[2023-10-31 13:35:55] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.003700 train acc = 1.0000, test acc = 0.1127
[2023-10-31 13:35:59] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.003677 train acc = 1.0000, test acc = 0.1300
[2023-10-31 13:36:03] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.003607 train acc = 1.0000, test acc = 0.1170
[2023-10-31 13:36:07] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.003789 train acc = 1.0000, test acc = 0.1223
[2023-10-31 13:36:10] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.003562 train acc = 1.0000, test acc = 0.1357
[2023-10-31 13:36:14] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.003696 train acc = 1.0000, test acc = 0.1200
[2023-10-31 13:36:18] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.003611 train acc = 1.0000, test acc = 0.1334
[2023-10-31 13:36:22] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.003644 train acc = 1.0000, test acc = 0.1169
[2023-10-31 13:36:26] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.003723 train acc = 1.0000, test acc = 0.1137
[2023-10-31 13:36:29] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.003589 train acc = 1.0000, test acc = 0.1196
[2023-10-31 13:36:33] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.003622 train acc = 1.0000, test acc = 0.1004
[2023-10-31 13:36:37] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.003682 train acc = 1.0000, test acc = 0.1188
[2023-10-31 13:36:41] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.003725 train acc = 1.0000, test acc = 0.1265
[2023-10-31 13:36:44] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.003686 train acc = 1.0000, test acc = 0.1150
[2023-10-31 13:36:48] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.003700 train acc = 1.0000, test acc = 0.1255
[2023-10-31 13:36:52] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.003638 train acc = 1.0000, test acc = 0.1069
[2023-10-31 13:36:56] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.003669 train acc = 1.0000, test acc = 0.1135
[2023-10-31 13:36:59] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.003716 train acc = 1.0000, test acc = 0.1064
[2023-10-31 13:37:03] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.003574 train acc = 1.0000, test acc = 0.1158
Evaluate 20 random ConvNet, mean = 0.1189 std = 0.0089
-------------------------
[2023-10-31 13:37:10] iter = 0000, loss = inf
[2023-10-31 13:38:17] iter = 0010, loss = inf
[2023-10-31 13:39:24] iter = 0020, loss = inf
[2023-10-31 13:40:31] iter = 0030, loss = nan
[2023-10-31 13:41:37] iter = 0040, loss = nan
[2023-10-31 13:42:44] iter = 0050, loss = inf
[2023-10-31 13:43:51] iter = 0060, loss = nan
[2023-10-31 13:44:58] iter = 0070, loss = inf
[2023-10-31 13:46:05] iter = 0080, loss = inf
[2023-10-31 13:47:12] iter = 0090, loss = inf
[2023-10-31 13:48:20] iter = 0100, loss = inf
[2023-10-31 13:49:26] iter = 0110, loss = nan
[2023-10-31 13:50:33] iter = 0120, loss = inf
[2023-10-31 13:51:41] iter = 0130, loss = inf
[2023-10-31 13:52:48] iter = 0140, loss = inf
[2023-10-31 13:53:55] iter = 0150, loss = inf
[2023-10-31 13:55:02] iter = 0160, loss = inf
[2023-10-31 13:56:09] iter = 0170, loss = inf
[2023-10-31 13:57:16] iter = 0180, loss = inf
[2023-10-31 13:58:24] iter = 0190, loss = inf
[2023-10-31 13:59:30] iter = 0200, loss = inf
[2023-10-31 14:00:37] iter = 0210, loss = nan
[2023-10-31 14:01:44] iter = 0220, loss = inf
[2023-10-31 14:02:51] iter = 0230, loss = inf
[2023-10-31 14:03:58] iter = 0240, loss = inf
[2023-10-31 14:05:05] iter = 0250, loss = nan
[2023-10-31 14:06:12] iter = 0260, loss = inf
[2023-10-31 14:07:19] iter = 0270, loss = inf
[2023-10-31 14:08:27] iter = 0280, loss = inf
[2023-10-31 14:09:34] iter = 0290, loss = inf
[2023-10-31 14:10:42] iter = 0300, loss = nan
[2023-10-31 14:11:50] iter = 0310, loss = inf
[2023-10-31 14:12:57] iter = 0320, loss = nan
[2023-10-31 14:14:04] iter = 0330, loss = nan
[2023-10-31 14:15:12] iter = 0340, loss = inf
[2023-10-31 14:16:19] iter = 0350, loss = inf
[2023-10-31 14:17:27] iter = 0360, loss = nan
[2023-10-31 14:18:34] iter = 0370, loss = inf
[2023-10-31 14:19:41] iter = 0380, loss = nan
[2023-10-31 14:20:49] iter = 0390, loss = inf
[2023-10-31 14:21:56] iter = 0400, loss = inf
[2023-10-31 14:23:03] iter = 0410, loss = inf
[2023-10-31 14:24:10] iter = 0420, loss = inf
[2023-10-31 14:25:17] iter = 0430, loss = inf
[2023-10-31 14:26:24] iter = 0440, loss = inf
[2023-10-31 14:27:32] iter = 0450, loss = inf
[2023-10-31 14:28:39] iter = 0460, loss = nan
[2023-10-31 14:29:47] iter = 0470, loss = inf
[2023-10-31 14:30:54] iter = 0480, loss = inf
[2023-10-31 14:32:02] iter = 0490, loss = nan
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-31 14:33:06] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.009047 train acc = 1.0000, test acc = 0.4083
[2023-10-31 14:33:10] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.008717 train acc = 1.0000, test acc = 0.4048
[2023-10-31 14:33:14] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.008750 train acc = 1.0000, test acc = 0.4196
[2023-10-31 14:33:17] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.008163 train acc = 1.0000, test acc = 0.4168
[2023-10-31 14:33:21] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.008548 train acc = 1.0000, test acc = 0.4223
[2023-10-31 14:33:25] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.008767 train acc = 1.0000, test acc = 0.4070
[2023-10-31 14:33:29] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.008742 train acc = 1.0000, test acc = 0.4131
[2023-10-31 14:33:32] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.008572 train acc = 1.0000, test acc = 0.4134
[2023-10-31 14:33:36] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.008687 train acc = 1.0000, test acc = 0.4191
[2023-10-31 14:33:39] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.008922 train acc = 1.0000, test acc = 0.4079
[2023-10-31 14:33:43] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.008593 train acc = 1.0000, test acc = 0.4218
[2023-10-31 14:33:47] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.008428 train acc = 1.0000, test acc = 0.4089
[2023-10-31 14:33:50] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.008684 train acc = 1.0000, test acc = 0.3986
[2023-10-31 14:33:54] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.008553 train acc = 1.0000, test acc = 0.4061
[2023-10-31 14:33:58] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.008582 train acc = 1.0000, test acc = 0.4153
[2023-10-31 14:34:01] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.008934 train acc = 1.0000, test acc = 0.4043
[2023-10-31 14:34:05] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.008513 train acc = 1.0000, test acc = 0.4230
[2023-10-31 14:34:09] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.008503 train acc = 1.0000, test acc = 0.4246
[2023-10-31 14:34:13] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.008564 train acc = 1.0000, test acc = 0.4112
[2023-10-31 14:34:16] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.008452 train acc = 1.0000, test acc = 0.4114
Evaluate 20 random ConvNet, mean = 0.4129 std = 0.0071
-------------------------
[2023-10-31 14:34:23] iter = 0500, loss = nan
[2023-10-31 14:35:29] iter = 0510, loss = nan
[2023-10-31 14:36:37] iter = 0520, loss = nan
[2023-10-31 14:37:45] iter = 0530, loss = inf
[2023-10-31 14:38:52] iter = 0540, loss = inf
[2023-10-31 14:39:59] iter = 0550, loss = inf
[2023-10-31 14:41:07] iter = 0560, loss = inf
[2023-10-31 14:42:15] iter = 0570, loss = inf
[2023-10-31 14:43:22] iter = 0580, loss = inf
[2023-10-31 14:44:29] iter = 0590, loss = inf
[2023-10-31 14:45:36] iter = 0600, loss = inf
[2023-10-31 14:46:44] iter = 0610, loss = inf
[2023-10-31 14:47:51] iter = 0620, loss = inf
[2023-10-31 14:48:58] iter = 0630, loss = nan
[2023-10-31 14:50:05] iter = 0640, loss = nan
[2023-10-31 14:51:13] iter = 0650, loss = inf
[2023-10-31 14:52:09] iter = 0660, loss = nan
[2023-10-31 14:53:02] iter = 0670, loss = inf
[2023-10-31 14:53:55] iter = 0680, loss = nan
[2023-10-31 14:54:48] iter = 0690, loss = inf
[2023-10-31 14:55:41] iter = 0700, loss = nan
[2023-10-31 14:56:35] iter = 0710, loss = inf
[2023-10-31 14:57:28] iter = 0720, loss = inf
[2023-10-31 14:58:21] iter = 0730, loss = inf
[2023-10-31 14:59:15] iter = 0740, loss = inf
[2023-10-31 15:00:10] iter = 0750, loss = inf
[2023-10-31 15:01:05] iter = 0760, loss = nan
[2023-10-31 15:02:01] iter = 0770, loss = nan
[2023-10-31 15:02:53] iter = 0780, loss = nan
[2023-10-31 15:03:49] iter = 0790, loss = nan
[2023-10-31 15:04:44] iter = 0800, loss = nan
[2023-10-31 15:05:40] iter = 0810, loss = nan
[2023-10-31 15:06:35] iter = 0820, loss = inf
[2023-10-31 15:07:31] iter = 0830, loss = inf
[2023-10-31 15:08:26] iter = 0840, loss = nan
[2023-10-31 15:09:22] iter = 0850, loss = inf
[2023-10-31 15:10:17] iter = 0860, loss = nan
[2023-10-31 15:11:12] iter = 0870, loss = nan
[2023-10-31 15:12:07] iter = 0880, loss = inf
[2023-10-31 15:13:02] iter = 0890, loss = inf
[2023-10-31 15:13:56] iter = 0900, loss = inf
[2023-10-31 15:14:49] iter = 0910, loss = inf
[2023-10-31 15:15:43] iter = 0920, loss = nan
[2023-10-31 15:16:37] iter = 0930, loss = inf
[2023-10-31 15:17:30] iter = 0940, loss = inf
[2023-10-31 15:18:24] iter = 0950, loss = inf
[2023-10-31 15:19:17] iter = 0960, loss = nan
[2023-10-31 15:20:10] iter = 0970, loss = inf
[2023-10-31 15:21:03] iter = 0980, loss = inf
[2023-10-31 15:21:56] iter = 0990, loss = inf
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-31 15:22:47] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.008701 train acc = 1.0000, test acc = 0.4201
[2023-10-31 15:22:50] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.008748 train acc = 1.0000, test acc = 0.4246
[2023-10-31 15:22:54] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.008878 train acc = 1.0000, test acc = 0.4058
[2023-10-31 15:22:57] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.008779 train acc = 1.0000, test acc = 0.4084
[2023-10-31 15:23:00] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.008532 train acc = 1.0000, test acc = 0.4217
[2023-10-31 15:23:04] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.009115 train acc = 1.0000, test acc = 0.4098
[2023-10-31 15:23:07] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.008820 train acc = 1.0000, test acc = 0.4202
[2023-10-31 15:23:10] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.008534 train acc = 1.0000, test acc = 0.4052
[2023-10-31 15:23:13] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.008837 train acc = 1.0000, test acc = 0.3791
[2023-10-31 15:23:17] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.008634 train acc = 1.0000, test acc = 0.4264
[2023-10-31 15:23:20] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.008919 train acc = 1.0000, test acc = 0.4096
[2023-10-31 15:23:23] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.008578 train acc = 1.0000, test acc = 0.4097
[2023-10-31 15:23:27] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.008408 train acc = 1.0000, test acc = 0.4088
[2023-10-31 15:23:30] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.008694 train acc = 1.0000, test acc = 0.4128
[2023-10-31 15:23:33] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.008729 train acc = 1.0000, test acc = 0.3941
[2023-10-31 15:23:36] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.008508 train acc = 1.0000, test acc = 0.4175
[2023-10-31 15:23:40] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.009021 train acc = 1.0000, test acc = 0.4231
[2023-10-31 15:23:43] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.008616 train acc = 1.0000, test acc = 0.3929
[2023-10-31 15:23:46] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.008791 train acc = 1.0000, test acc = 0.4104
[2023-10-31 15:23:49] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.008879 train acc = 1.0000, test acc = 0.4271
Evaluate 20 random ConvNet, mean = 0.4114 std = 0.0120
-------------------------
[2023-10-31 15:23:55] iter = 1000, loss = inf

================== Exp 2 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f6fd74d8cd0>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-31 15:24:11] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-31 15:24:14] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.003746 train acc = 1.0000, test acc = 0.1117
[2023-10-31 15:24:17] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.003710 train acc = 1.0000, test acc = 0.0887
[2023-10-31 15:24:21] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.003625 train acc = 1.0000, test acc = 0.0937
[2023-10-31 15:24:24] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.003635 train acc = 1.0000, test acc = 0.0953
[2023-10-31 15:24:27] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.003694 train acc = 1.0000, test acc = 0.1109
[2023-10-31 15:24:31] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.003695 train acc = 1.0000, test acc = 0.1085
[2023-10-31 15:24:34] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.003814 train acc = 1.0000, test acc = 0.1040
[2023-10-31 15:24:37] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.003616 train acc = 1.0000, test acc = 0.0995
[2023-10-31 15:24:40] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.003751 train acc = 1.0000, test acc = 0.1038
[2023-10-31 15:24:44] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.003620 train acc = 1.0000, test acc = 0.0942
[2023-10-31 15:24:47] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.003553 train acc = 1.0000, test acc = 0.0956
[2023-10-31 15:24:50] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.003674 train acc = 1.0000, test acc = 0.0975
[2023-10-31 15:24:54] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.003588 train acc = 1.0000, test acc = 0.0891
[2023-10-31 15:24:57] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.003693 train acc = 1.0000, test acc = 0.1026
[2023-10-31 15:25:00] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.003660 train acc = 1.0000, test acc = 0.1012
[2023-10-31 15:25:03] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.003654 train acc = 1.0000, test acc = 0.1021
[2023-10-31 15:25:07] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.003698 train acc = 1.0000, test acc = 0.1155
[2023-10-31 15:25:10] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.003724 train acc = 1.0000, test acc = 0.1207
[2023-10-31 15:25:13] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.003682 train acc = 1.0000, test acc = 0.1005
[2023-10-31 15:25:17] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.003661 train acc = 1.0000, test acc = 0.1057
Evaluate 20 random ConvNet, mean = 0.1020 std = 0.0082
-------------------------
[2023-10-31 15:25:22] iter = 0000, loss = inf
[2023-10-31 15:26:15] iter = 0010, loss = nan
[2023-10-31 15:27:08] iter = 0020, loss = inf
[2023-10-31 15:28:01] iter = 0030, loss = inf
[2023-10-31 15:28:54] iter = 0040, loss = inf
[2023-10-31 15:29:47] iter = 0050, loss = inf
[2023-10-31 15:30:41] iter = 0060, loss = inf
[2023-10-31 15:31:34] iter = 0070, loss = inf
[2023-10-31 15:32:27] iter = 0080, loss = inf
[2023-10-31 15:33:20] iter = 0090, loss = nan
[2023-10-31 15:34:13] iter = 0100, loss = inf
[2023-10-31 15:35:06] iter = 0110, loss = inf
[2023-10-31 15:35:59] iter = 0120, loss = nan
[2023-10-31 15:36:52] iter = 0130, loss = nan
[2023-10-31 15:37:45] iter = 0140, loss = inf
[2023-10-31 15:38:38] iter = 0150, loss = inf
[2023-10-31 15:39:31] iter = 0160, loss = inf
[2023-10-31 15:40:24] iter = 0170, loss = nan
[2023-10-31 15:41:18] iter = 0180, loss = nan
[2023-10-31 15:42:10] iter = 0190, loss = nan
[2023-10-31 15:43:03] iter = 0200, loss = inf
[2023-10-31 15:43:57] iter = 0210, loss = nan
[2023-10-31 15:44:50] iter = 0220, loss = inf
[2023-10-31 15:45:43] iter = 0230, loss = inf
[2023-10-31 15:46:36] iter = 0240, loss = inf
[2023-10-31 15:47:29] iter = 0250, loss = inf
[2023-10-31 15:48:22] iter = 0260, loss = inf
[2023-10-31 15:49:15] iter = 0270, loss = inf
[2023-10-31 15:50:08] iter = 0280, loss = inf
[2023-10-31 15:51:00] iter = 0290, loss = inf
[2023-10-31 15:51:54] iter = 0300, loss = nan
[2023-10-31 15:52:47] iter = 0310, loss = inf
[2023-10-31 15:53:39] iter = 0320, loss = nan
[2023-10-31 15:54:32] iter = 0330, loss = inf
[2023-10-31 15:55:25] iter = 0340, loss = inf
[2023-10-31 15:56:18] iter = 0350, loss = inf
[2023-10-31 15:57:12] iter = 0360, loss = inf
[2023-10-31 15:58:05] iter = 0370, loss = inf
[2023-10-31 15:58:58] iter = 0380, loss = inf
[2023-10-31 15:59:52] iter = 0390, loss = inf
[2023-10-31 16:00:45] iter = 0400, loss = inf
[2023-10-31 16:01:38] iter = 0410, loss = inf
[2023-10-31 16:02:31] iter = 0420, loss = inf
[2023-10-31 16:03:24] iter = 0430, loss = inf
[2023-10-31 16:04:17] iter = 0440, loss = inf
[2023-10-31 16:05:10] iter = 0450, loss = inf
[2023-10-31 16:06:03] iter = 0460, loss = inf
[2023-10-31 16:06:56] iter = 0470, loss = nan
[2023-10-31 16:07:49] iter = 0480, loss = inf
[2023-10-31 16:08:42] iter = 0490, loss = nan
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-31 16:09:32] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.009130 train acc = 1.0000, test acc = 0.4073
[2023-10-31 16:09:36] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.008545 train acc = 1.0000, test acc = 0.3943
[2023-10-31 16:09:39] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.008514 train acc = 1.0000, test acc = 0.4199
[2023-10-31 16:09:42] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.008702 train acc = 1.0000, test acc = 0.4050
[2023-10-31 16:09:46] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.008761 train acc = 1.0000, test acc = 0.4138
[2023-10-31 16:09:49] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.008330 train acc = 1.0000, test acc = 0.4037
[2023-10-31 16:09:52] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.008876 train acc = 1.0000, test acc = 0.4109
[2023-10-31 16:09:55] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.008811 train acc = 1.0000, test acc = 0.3924
[2023-10-31 16:09:59] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.008480 train acc = 1.0000, test acc = 0.4189
[2023-10-31 16:10:02] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.008631 train acc = 1.0000, test acc = 0.4139
[2023-10-31 16:10:05] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.008969 train acc = 1.0000, test acc = 0.4048
[2023-10-31 16:10:08] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.008433 train acc = 1.0000, test acc = 0.4026
[2023-10-31 16:10:12] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.008580 train acc = 1.0000, test acc = 0.4169
[2023-10-31 16:10:15] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.008876 train acc = 1.0000, test acc = 0.4142
[2023-10-31 16:10:18] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.008999 train acc = 1.0000, test acc = 0.4087
[2023-10-31 16:10:22] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.008754 train acc = 1.0000, test acc = 0.4044
[2023-10-31 16:10:25] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.008890 train acc = 1.0000, test acc = 0.4158
[2023-10-31 16:10:28] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.008554 train acc = 1.0000, test acc = 0.4100
[2023-10-31 16:10:31] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.008497 train acc = 1.0000, test acc = 0.4079
[2023-10-31 16:10:35] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.008716 train acc = 1.0000, test acc = 0.4089
Evaluate 20 random ConvNet, mean = 0.4087 std = 0.0071
-------------------------
[2023-10-31 16:10:40] iter = 0500, loss = nan
[2023-10-31 16:11:33] iter = 0510, loss = inf
[2023-10-31 16:12:26] iter = 0520, loss = nan
[2023-10-31 16:13:19] iter = 0530, loss = nan
[2023-10-31 16:14:12] iter = 0540, loss = nan
[2023-10-31 16:15:05] iter = 0550, loss = inf
[2023-10-31 16:15:58] iter = 0560, loss = nan
[2023-10-31 16:16:51] iter = 0570, loss = nan
[2023-10-31 16:17:44] iter = 0580, loss = inf
[2023-10-31 16:18:37] iter = 0590, loss = inf
[2023-10-31 16:19:30] iter = 0600, loss = nan
[2023-10-31 16:20:23] iter = 0610, loss = inf
[2023-10-31 16:21:16] iter = 0620, loss = nan
[2023-10-31 16:22:09] iter = 0630, loss = inf
[2023-10-31 16:23:02] iter = 0640, loss = nan
[2023-10-31 16:23:55] iter = 0650, loss = nan
[2023-10-31 16:24:48] iter = 0660, loss = inf
[2023-10-31 16:25:41] iter = 0670, loss = nan
[2023-10-31 16:26:34] iter = 0680, loss = inf
[2023-10-31 16:27:27] iter = 0690, loss = nan
[2023-10-31 16:28:20] iter = 0700, loss = nan
[2023-10-31 16:29:13] iter = 0710, loss = inf
[2023-10-31 16:30:06] iter = 0720, loss = nan
[2023-10-31 16:30:59] iter = 0730, loss = nan
[2023-10-31 16:31:52] iter = 0740, loss = inf
[2023-10-31 16:32:45] iter = 0750, loss = nan
[2023-10-31 16:33:38] iter = 0760, loss = inf
[2023-10-31 16:34:31] iter = 0770, loss = inf
[2023-10-31 16:35:24] iter = 0780, loss = inf
[2023-10-31 16:36:17] iter = 0790, loss = inf
[2023-10-31 16:37:10] iter = 0800, loss = inf
[2023-10-31 16:38:03] iter = 0810, loss = inf
[2023-10-31 16:38:56] iter = 0820, loss = inf
[2023-10-31 16:39:49] iter = 0830, loss = nan
[2023-10-31 16:40:42] iter = 0840, loss = inf
[2023-10-31 16:41:35] iter = 0850, loss = inf
[2023-10-31 16:42:28] iter = 0860, loss = inf
[2023-10-31 16:43:21] iter = 0870, loss = inf
[2023-10-31 16:44:14] iter = 0880, loss = nan
[2023-10-31 16:45:07] iter = 0890, loss = inf
[2023-10-31 16:46:00] iter = 0900, loss = inf
[2023-10-31 16:46:53] iter = 0910, loss = inf
[2023-10-31 16:47:46] iter = 0920, loss = inf
[2023-10-31 16:48:39] iter = 0930, loss = nan
[2023-10-31 16:49:32] iter = 0940, loss = inf
[2023-10-31 16:50:25] iter = 0950, loss = inf
[2023-10-31 16:51:18] iter = 0960, loss = nan
[2023-10-31 16:52:11] iter = 0970, loss = inf
[2023-10-31 16:53:04] iter = 0980, loss = inf
[2023-10-31 16:53:57] iter = 0990, loss = inf
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-31 16:54:49] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.008830 train acc = 1.0000, test acc = 0.4137
[2023-10-31 16:54:53] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.008817 train acc = 1.0000, test acc = 0.4306
[2023-10-31 16:54:56] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.009138 train acc = 1.0000, test acc = 0.4228
[2023-10-31 16:54:59] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.008942 train acc = 1.0000, test acc = 0.4247
[2023-10-31 16:55:03] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.008509 train acc = 1.0000, test acc = 0.4202
[2023-10-31 16:55:06] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.008721 train acc = 1.0000, test acc = 0.4172
[2023-10-31 16:55:09] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.008894 train acc = 1.0000, test acc = 0.4313
[2023-10-31 16:55:13] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.008827 train acc = 1.0000, test acc = 0.4256
[2023-10-31 16:55:16] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.008834 train acc = 1.0000, test acc = 0.4192
[2023-10-31 16:55:19] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.008485 train acc = 1.0000, test acc = 0.4202
[2023-10-31 16:55:23] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.008870 train acc = 1.0000, test acc = 0.4024
[2023-10-31 16:55:26] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.008324 train acc = 1.0000, test acc = 0.4137
[2023-10-31 16:55:29] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.008645 train acc = 1.0000, test acc = 0.4321
[2023-10-31 16:55:33] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.008828 train acc = 1.0000, test acc = 0.4182
[2023-10-31 16:55:36] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.008494 train acc = 1.0000, test acc = 0.4159
[2023-10-31 16:55:39] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.009093 train acc = 1.0000, test acc = 0.4199
[2023-10-31 16:55:42] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.008687 train acc = 1.0000, test acc = 0.4233
[2023-10-31 16:55:46] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.008726 train acc = 1.0000, test acc = 0.4136
[2023-10-31 16:55:49] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.008824 train acc = 1.0000, test acc = 0.4094
[2023-10-31 16:55:52] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.008855 train acc = 1.0000, test acc = 0.4364
Evaluate 20 random ConvNet, mean = 0.4205 std = 0.0080
-------------------------
[2023-10-31 16:55:58] iter = 1000, loss = inf

================== Exp 3 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f6fd74d8cd0>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-31 16:56:14] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-31 16:56:17] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.003754 train acc = 1.0000, test acc = 0.1329
[2023-10-31 16:56:20] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.003867 train acc = 1.0000, test acc = 0.1292
[2023-10-31 16:56:23] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.003697 train acc = 1.0000, test acc = 0.1283
[2023-10-31 16:56:27] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.003734 train acc = 1.0000, test acc = 0.1126
[2023-10-31 16:56:30] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.003733 train acc = 1.0000, test acc = 0.1128
[2023-10-31 16:56:33] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.003680 train acc = 1.0000, test acc = 0.1101
[2023-10-31 16:56:37] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.003719 train acc = 1.0000, test acc = 0.1216
[2023-10-31 16:56:40] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.003686 train acc = 1.0000, test acc = 0.1277
[2023-10-31 16:56:43] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.003574 train acc = 1.0000, test acc = 0.1289
[2023-10-31 16:56:47] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.003618 train acc = 1.0000, test acc = 0.1161
[2023-10-31 16:56:50] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.003746 train acc = 1.0000, test acc = 0.1365
[2023-10-31 16:56:53] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.003672 train acc = 1.0000, test acc = 0.1261
[2023-10-31 16:56:56] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.003810 train acc = 1.0000, test acc = 0.1133
[2023-10-31 16:57:00] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.003717 train acc = 1.0000, test acc = 0.1435
[2023-10-31 16:57:03] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.003654 train acc = 1.0000, test acc = 0.1298
[2023-10-31 16:57:06] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.003690 train acc = 1.0000, test acc = 0.1317
[2023-10-31 16:57:09] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.003657 train acc = 1.0000, test acc = 0.1157
[2023-10-31 16:57:13] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.003674 train acc = 1.0000, test acc = 0.1427
[2023-10-31 16:57:16] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.003595 train acc = 1.0000, test acc = 0.1275
[2023-10-31 16:57:19] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.003616 train acc = 1.0000, test acc = 0.1275
Evaluate 20 random ConvNet, mean = 0.1257 std = 0.0095
-------------------------
[2023-10-31 16:57:25] iter = 0000, loss = inf
[2023-10-31 16:58:18] iter = 0010, loss = inf
[2023-10-31 16:59:11] iter = 0020, loss = nan
[2023-10-31 17:00:04] iter = 0030, loss = nan
[2023-10-31 17:00:57] iter = 0040, loss = inf
[2023-10-31 17:01:50] iter = 0050, loss = inf
[2023-10-31 17:02:43] iter = 0060, loss = inf
[2023-10-31 17:03:36] iter = 0070, loss = inf
[2023-10-31 17:04:28] iter = 0080, loss = inf
[2023-10-31 17:05:22] iter = 0090, loss = inf
[2023-10-31 17:06:15] iter = 0100, loss = inf
[2023-10-31 17:07:08] iter = 0110, loss = nan
[2023-10-31 17:08:01] iter = 0120, loss = nan
[2023-10-31 17:08:54] iter = 0130, loss = inf
[2023-10-31 17:09:46] iter = 0140, loss = nan
[2023-10-31 17:10:40] iter = 0150, loss = inf
[2023-10-31 17:11:32] iter = 0160, loss = inf
[2023-10-31 17:12:25] iter = 0170, loss = inf
[2023-10-31 17:13:19] iter = 0180, loss = inf
[2023-10-31 17:14:12] iter = 0190, loss = inf
[2023-10-31 17:15:04] iter = 0200, loss = nan
[2023-10-31 17:15:58] iter = 0210, loss = inf
[2023-10-31 17:16:51] iter = 0220, loss = nan
[2023-10-31 17:17:44] iter = 0230, loss = nan
[2023-10-31 17:18:37] iter = 0240, loss = nan
[2023-10-31 17:19:30] iter = 0250, loss = inf
[2023-10-31 17:20:23] iter = 0260, loss = inf
[2023-10-31 17:21:16] iter = 0270, loss = inf
[2023-10-31 17:22:09] iter = 0280, loss = nan
[2023-10-31 17:23:02] iter = 0290, loss = inf
[2023-10-31 17:23:56] iter = 0300, loss = inf
[2023-10-31 17:24:49] iter = 0310, loss = inf
[2023-10-31 17:25:43] iter = 0320, loss = inf
[2023-10-31 17:26:36] iter = 0330, loss = inf
[2023-10-31 17:27:29] iter = 0340, loss = nan
[2023-10-31 17:28:22] iter = 0350, loss = inf
[2023-10-31 17:29:16] iter = 0360, loss = inf
[2023-10-31 17:30:09] iter = 0370, loss = inf
[2023-10-31 17:31:02] iter = 0380, loss = inf
[2023-10-31 17:31:56] iter = 0390, loss = nan
[2023-10-31 17:32:49] iter = 0400, loss = nan
[2023-10-31 17:33:43] iter = 0410, loss = inf
[2023-10-31 17:34:36] iter = 0420, loss = inf
[2023-10-31 17:35:30] iter = 0430, loss = inf
[2023-10-31 17:36:23] iter = 0440, loss = nan
[2023-10-31 17:37:16] iter = 0450, loss = inf
[2023-10-31 17:38:10] iter = 0460, loss = nan
[2023-10-31 17:39:03] iter = 0470, loss = nan
[2023-10-31 17:39:57] iter = 0480, loss = nan
[2023-10-31 17:40:51] iter = 0490, loss = nan
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-31 17:41:42] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.008756 train acc = 1.0000, test acc = 0.4101
[2023-10-31 17:41:46] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.008732 train acc = 1.0000, test acc = 0.4011
[2023-10-31 17:41:49] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.008618 train acc = 1.0000, test acc = 0.4125
[2023-10-31 17:41:52] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.008992 train acc = 1.0000, test acc = 0.4000
[2023-10-31 17:41:56] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.008101 train acc = 1.0000, test acc = 0.4072
[2023-10-31 17:41:59] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.008485 train acc = 1.0000, test acc = 0.4070
[2023-10-31 17:42:02] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.008182 train acc = 1.0000, test acc = 0.4101
[2023-10-31 17:42:05] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.008718 train acc = 1.0000, test acc = 0.4101
[2023-10-31 17:42:09] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.008754 train acc = 1.0000, test acc = 0.4115
[2023-10-31 17:42:12] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.008625 train acc = 1.0000, test acc = 0.4153
[2023-10-31 17:42:15] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.008626 train acc = 1.0000, test acc = 0.4178
[2023-10-31 17:42:19] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.008843 train acc = 1.0000, test acc = 0.3987
[2023-10-31 17:42:22] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.008449 train acc = 1.0000, test acc = 0.4115
[2023-10-31 17:42:25] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.009378 train acc = 1.0000, test acc = 0.4153
[2023-10-31 17:42:28] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.008878 train acc = 1.0000, test acc = 0.4107
[2023-10-31 17:42:31] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.008463 train acc = 1.0000, test acc = 0.4035
[2023-10-31 17:42:35] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.008577 train acc = 1.0000, test acc = 0.4055
[2023-10-31 17:42:38] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.008709 train acc = 1.0000, test acc = 0.4036
[2023-10-31 17:42:41] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.008926 train acc = 1.0000, test acc = 0.4018
[2023-10-31 17:42:45] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.008862 train acc = 1.0000, test acc = 0.3975
Evaluate 20 random ConvNet, mean = 0.4075 std = 0.0057
-------------------------
[2023-10-31 17:42:50] iter = 0500, loss = inf
[2023-10-31 17:43:44] iter = 0510, loss = inf
[2023-10-31 17:44:37] iter = 0520, loss = nan
[2023-10-31 17:45:31] iter = 0530, loss = inf
[2023-10-31 17:46:24] iter = 0540, loss = nan
[2023-10-31 17:47:17] iter = 0550, loss = inf
[2023-10-31 17:48:11] iter = 0560, loss = nan
[2023-10-31 17:49:04] iter = 0570, loss = inf
[2023-10-31 17:49:57] iter = 0580, loss = inf
[2023-10-31 17:50:51] iter = 0590, loss = inf
[2023-10-31 17:51:44] iter = 0600, loss = inf
[2023-10-31 17:52:38] iter = 0610, loss = nan
[2023-10-31 17:53:31] iter = 0620, loss = inf
[2023-10-31 17:54:25] iter = 0630, loss = inf
[2023-10-31 17:55:18] iter = 0640, loss = inf
[2023-10-31 17:56:11] iter = 0650, loss = nan
[2023-10-31 17:57:04] iter = 0660, loss = nan
[2023-10-31 17:57:57] iter = 0670, loss = inf
[2023-10-31 17:58:50] iter = 0680, loss = inf
[2023-10-31 17:59:43] iter = 0690, loss = inf
[2023-10-31 18:00:36] iter = 0700, loss = inf
[2023-10-31 18:01:29] iter = 0710, loss = inf
[2023-10-31 18:02:22] iter = 0720, loss = inf
[2023-10-31 18:03:16] iter = 0730, loss = inf
[2023-10-31 18:04:09] iter = 0740, loss = inf
[2023-10-31 18:05:02] iter = 0750, loss = inf
[2023-10-31 18:05:56] iter = 0760, loss = nan
[2023-10-31 18:06:50] iter = 0770, loss = inf
[2023-10-31 18:07:43] iter = 0780, loss = inf
[2023-10-31 18:08:37] iter = 0790, loss = nan
[2023-10-31 18:09:30] iter = 0800, loss = inf
[2023-10-31 18:10:23] iter = 0810, loss = inf
[2023-10-31 18:11:17] iter = 0820, loss = nan
[2023-10-31 18:12:11] iter = 0830, loss = inf
[2023-10-31 18:13:04] iter = 0840, loss = inf
[2023-10-31 18:13:58] iter = 0850, loss = inf
[2023-10-31 18:14:51] iter = 0860, loss = inf
[2023-10-31 18:15:45] iter = 0870, loss = nan
[2023-10-31 18:16:39] iter = 0880, loss = inf
[2023-10-31 18:17:32] iter = 0890, loss = inf
[2023-10-31 18:18:26] iter = 0900, loss = inf
[2023-10-31 18:19:19] iter = 0910, loss = inf
[2023-10-31 18:20:13] iter = 0920, loss = inf
[2023-10-31 18:21:06] iter = 0930, loss = inf
[2023-10-31 18:21:59] iter = 0940, loss = nan
[2023-10-31 18:22:53] iter = 0950, loss = inf
[2023-10-31 18:23:46] iter = 0960, loss = inf
[2023-10-31 18:24:40] iter = 0970, loss = nan
[2023-10-31 18:25:33] iter = 0980, loss = inf
[2023-10-31 18:26:26] iter = 0990, loss = inf
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-31 18:27:18] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.008900 train acc = 1.0000, test acc = 0.4011
[2023-10-31 18:27:21] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.008745 train acc = 1.0000, test acc = 0.4031
[2023-10-31 18:27:25] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.008536 train acc = 1.0000, test acc = 0.4093
[2023-10-31 18:27:28] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.008666 train acc = 1.0000, test acc = 0.4229
[2023-10-31 18:27:31] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.009126 train acc = 1.0000, test acc = 0.4101
[2023-10-31 18:27:35] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.008915 train acc = 1.0000, test acc = 0.4159
[2023-10-31 18:27:38] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.008830 train acc = 1.0000, test acc = 0.4165
[2023-10-31 18:27:41] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.008888 train acc = 1.0000, test acc = 0.4141
[2023-10-31 18:27:44] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.008783 train acc = 1.0000, test acc = 0.4166
[2023-10-31 18:27:48] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.008583 train acc = 1.0000, test acc = 0.4217
[2023-10-31 18:27:51] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.009280 train acc = 1.0000, test acc = 0.4248
[2023-10-31 18:27:54] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.008996 train acc = 1.0000, test acc = 0.4041
[2023-10-31 18:27:58] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.009036 train acc = 1.0000, test acc = 0.4012
[2023-10-31 18:28:01] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.008813 train acc = 1.0000, test acc = 0.4120
[2023-10-31 18:28:04] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.008674 train acc = 1.0000, test acc = 0.4185
[2023-10-31 18:28:08] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.008369 train acc = 1.0000, test acc = 0.4385
[2023-10-31 18:28:11] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.008787 train acc = 1.0000, test acc = 0.4228
[2023-10-31 18:28:14] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.009035 train acc = 1.0000, test acc = 0.4025
[2023-10-31 18:28:17] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.008948 train acc = 1.0000, test acc = 0.4139
[2023-10-31 18:28:21] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.009084 train acc = 1.0000, test acc = 0.4008
Evaluate 20 random ConvNet, mean = 0.4135 std = 0.0096
-------------------------
[2023-10-31 18:28:26] iter = 1000, loss = nan

================== Exp 4 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 10, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 10, 'inner_loop': 50, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f6fd74d8cd0>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-31 18:28:42] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-31 18:28:46] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.003651 train acc = 1.0000, test acc = 0.0835
[2023-10-31 18:28:49] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.003662 train acc = 1.0000, test acc = 0.0799
[2023-10-31 18:28:52] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.003598 train acc = 1.0000, test acc = 0.0822
[2023-10-31 18:28:55] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.003644 train acc = 1.0000, test acc = 0.0910
[2023-10-31 18:28:59] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.003722 train acc = 1.0000, test acc = 0.0898
[2023-10-31 18:29:02] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.003570 train acc = 1.0000, test acc = 0.0995
[2023-10-31 18:29:05] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.003632 train acc = 1.0000, test acc = 0.1082
[2023-10-31 18:29:09] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.003629 train acc = 1.0000, test acc = 0.0894
[2023-10-31 18:29:12] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.003782 train acc = 1.0000, test acc = 0.0897
[2023-10-31 18:29:15] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.003768 train acc = 1.0000, test acc = 0.0819
[2023-10-31 18:29:18] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.003602 train acc = 1.0000, test acc = 0.0875
[2023-10-31 18:29:22] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.003595 train acc = 1.0000, test acc = 0.0860
[2023-10-31 18:29:25] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.003673 train acc = 1.0000, test acc = 0.1107
[2023-10-31 18:29:28] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.003645 train acc = 1.0000, test acc = 0.1050
[2023-10-31 18:29:32] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.003652 train acc = 1.0000, test acc = 0.1287
[2023-10-31 18:29:35] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.003636 train acc = 1.0000, test acc = 0.0856
[2023-10-31 18:29:38] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.003720 train acc = 1.0000, test acc = 0.1035
[2023-10-31 18:29:42] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.003617 train acc = 1.0000, test acc = 0.1008
[2023-10-31 18:29:45] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.003635 train acc = 1.0000, test acc = 0.0986
[2023-10-31 18:29:48] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.003662 train acc = 1.0000, test acc = 0.0881
Evaluate 20 random ConvNet, mean = 0.0945 std = 0.0120
-------------------------
[2023-10-31 18:29:54] iter = 0000, loss = nan
[2023-10-31 18:30:47] iter = 0010, loss = inf
[2023-10-31 18:31:40] iter = 0020, loss = inf
[2023-10-31 18:32:34] iter = 0030, loss = inf
[2023-10-31 18:33:27] iter = 0040, loss = inf
[2023-10-31 18:34:20] iter = 0050, loss = nan
[2023-10-31 18:35:14] iter = 0060, loss = nan
[2023-10-31 18:36:06] iter = 0070, loss = inf
[2023-10-31 18:36:59] iter = 0080, loss = inf
[2023-10-31 18:37:53] iter = 0090, loss = nan
[2023-10-31 18:38:46] iter = 0100, loss = inf
[2023-10-31 18:39:38] iter = 0110, loss = inf
[2023-10-31 18:40:32] iter = 0120, loss = inf
[2023-10-31 18:41:24] iter = 0130, loss = inf
[2023-10-31 18:42:17] iter = 0140, loss = inf
[2023-10-31 18:43:10] iter = 0150, loss = inf
[2023-10-31 18:44:03] iter = 0160, loss = inf
[2023-10-31 18:44:55] iter = 0170, loss = inf
[2023-10-31 18:45:49] iter = 0180, loss = inf
[2023-10-31 18:46:42] iter = 0190, loss = inf
[2023-10-31 18:47:34] iter = 0200, loss = inf
[2023-10-31 18:48:27] iter = 0210, loss = inf
[2023-10-31 18:49:20] iter = 0220, loss = inf
[2023-10-31 18:50:13] iter = 0230, loss = inf
[2023-10-31 18:51:06] iter = 0240, loss = inf
[2023-10-31 18:51:59] iter = 0250, loss = nan
[2023-10-31 18:52:51] iter = 0260, loss = inf
[2023-10-31 18:53:45] iter = 0270, loss = nan
[2023-10-31 18:54:38] iter = 0280, loss = inf
[2023-10-31 18:55:31] iter = 0290, loss = inf
[2023-10-31 18:56:24] iter = 0300, loss = nan
[2023-10-31 18:57:17] iter = 0310, loss = inf
[2023-10-31 18:58:10] iter = 0320, loss = nan
[2023-10-31 18:59:03] iter = 0330, loss = inf
[2023-10-31 18:59:56] iter = 0340, loss = inf
[2023-10-31 19:00:49] iter = 0350, loss = inf
[2023-10-31 19:01:42] iter = 0360, loss = nan
[2023-10-31 19:02:35] iter = 0370, loss = nan
[2023-10-31 19:03:28] iter = 0380, loss = nan
[2023-10-31 19:04:21] iter = 0390, loss = inf
[2023-10-31 19:05:14] iter = 0400, loss = inf
[2023-10-31 19:06:06] iter = 0410, loss = inf
[2023-10-31 19:06:59] iter = 0420, loss = inf
[2023-10-31 19:07:52] iter = 0430, loss = inf
[2023-10-31 19:08:45] iter = 0440, loss = nan
[2023-10-31 19:09:38] iter = 0450, loss = inf
[2023-10-31 19:10:31] iter = 0460, loss = inf
[2023-10-31 19:11:24] iter = 0470, loss = inf
[2023-10-31 19:12:17] iter = 0480, loss = nan
[2023-10-31 19:13:10] iter = 0490, loss = inf
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-31 19:14:01] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.008511 train acc = 1.0000, test acc = 0.4080
[2023-10-31 19:14:04] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.008536 train acc = 1.0000, test acc = 0.4005
[2023-10-31 19:14:07] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.008625 train acc = 1.0000, test acc = 0.4042
[2023-10-31 19:14:11] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.008268 train acc = 1.0000, test acc = 0.4109
[2023-10-31 19:14:14] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.008464 train acc = 1.0000, test acc = 0.4016
[2023-10-31 19:14:17] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.008511 train acc = 1.0000, test acc = 0.4144
[2023-10-31 19:14:21] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.008417 train acc = 1.0000, test acc = 0.4008
[2023-10-31 19:14:24] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.007960 train acc = 1.0000, test acc = 0.4023
[2023-10-31 19:14:27] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.008633 train acc = 1.0000, test acc = 0.4014
[2023-10-31 19:14:30] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.008382 train acc = 1.0000, test acc = 0.3988
[2023-10-31 19:14:34] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.008465 train acc = 1.0000, test acc = 0.4049
[2023-10-31 19:14:37] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.008169 train acc = 1.0000, test acc = 0.3938
[2023-10-31 19:14:40] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.008552 train acc = 1.0000, test acc = 0.3988
[2023-10-31 19:14:43] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.008387 train acc = 1.0000, test acc = 0.4034
[2023-10-31 19:14:47] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.008604 train acc = 1.0000, test acc = 0.4096
[2023-10-31 19:14:50] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.008459 train acc = 1.0000, test acc = 0.4053
[2023-10-31 19:14:53] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.008236 train acc = 1.0000, test acc = 0.4090
[2023-10-31 19:14:56] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.008375 train acc = 1.0000, test acc = 0.4143
[2023-10-31 19:15:00] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.008905 train acc = 1.0000, test acc = 0.4051
[2023-10-31 19:15:03] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.008719 train acc = 1.0000, test acc = 0.3975
Evaluate 20 random ConvNet, mean = 0.4042 std = 0.0054
-------------------------
[2023-10-31 19:15:08] iter = 0500, loss = inf
[2023-10-31 19:16:01] iter = 0510, loss = inf
[2023-10-31 19:16:54] iter = 0520, loss = inf
[2023-10-31 19:17:47] iter = 0530, loss = inf
[2023-10-31 19:18:39] iter = 0540, loss = inf
[2023-10-31 19:19:32] iter = 0550, loss = inf
[2023-10-31 19:20:25] iter = 0560, loss = inf
[2023-10-31 19:21:18] iter = 0570, loss = inf
[2023-10-31 19:22:11] iter = 0580, loss = inf
[2023-10-31 19:23:05] iter = 0590, loss = inf
[2023-10-31 19:24:00] iter = 0600, loss = inf
[2023-10-31 19:24:55] iter = 0610, loss = inf
[2023-10-31 19:25:50] iter = 0620, loss = nan
[2023-10-31 19:26:45] iter = 0630, loss = inf
[2023-10-31 19:27:41] iter = 0640, loss = inf
[2023-10-31 19:28:36] iter = 0650, loss = nan
[2023-10-31 19:29:31] iter = 0660, loss = inf
[2023-10-31 19:30:26] iter = 0670, loss = inf
[2023-10-31 19:31:22] iter = 0680, loss = inf
[2023-10-31 19:32:17] iter = 0690, loss = inf
[2023-10-31 19:33:13] iter = 0700, loss = nan
[2023-10-31 19:34:09] iter = 0710, loss = nan
[2023-10-31 19:35:03] iter = 0720, loss = inf
[2023-10-31 19:35:58] iter = 0730, loss = inf
[2023-10-31 19:36:53] iter = 0740, loss = nan
[2023-10-31 19:37:47] iter = 0750, loss = inf
[2023-10-31 19:38:41] iter = 0760, loss = inf
[2023-10-31 19:39:36] iter = 0770, loss = inf
[2023-10-31 19:40:29] iter = 0780, loss = inf
[2023-10-31 19:41:23] iter = 0790, loss = inf
[2023-10-31 19:42:16] iter = 0800, loss = nan
[2023-10-31 19:43:10] iter = 0810, loss = inf
[2023-10-31 19:44:03] iter = 0820, loss = inf
[2023-10-31 19:44:57] iter = 0830, loss = nan
[2023-10-31 19:45:50] iter = 0840, loss = nan
[2023-10-31 19:46:43] iter = 0850, loss = inf
[2023-10-31 19:47:37] iter = 0860, loss = inf
[2023-10-31 19:48:30] iter = 0870, loss = inf
[2023-10-31 19:49:23] iter = 0880, loss = inf
[2023-10-31 19:50:17] iter = 0890, loss = nan
[2023-10-31 19:51:10] iter = 0900, loss = inf
[2023-10-31 19:52:03] iter = 0910, loss = nan
[2023-10-31 19:52:56] iter = 0920, loss = inf
[2023-10-31 19:53:49] iter = 0930, loss = inf
[2023-10-31 19:54:43] iter = 0940, loss = nan
[2023-10-31 19:55:36] iter = 0950, loss = inf
[2023-10-31 19:56:29] iter = 0960, loss = inf
[2023-10-31 19:57:23] iter = 0970, loss = inf
[2023-10-31 19:58:16] iter = 0980, loss = nan
[2023-10-31 19:59:09] iter = 0990, loss = inf
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-31 20:00:00] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.008610 train acc = 1.0000, test acc = 0.4095
[2023-10-31 20:00:03] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.008575 train acc = 1.0000, test acc = 0.4029
[2023-10-31 20:00:07] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.008227 train acc = 1.0000, test acc = 0.4179
[2023-10-31 20:00:10] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.008596 train acc = 1.0000, test acc = 0.4159
[2023-10-31 20:00:13] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.008686 train acc = 1.0000, test acc = 0.3932
[2023-10-31 20:00:16] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.008553 train acc = 1.0000, test acc = 0.4128
[2023-10-31 20:00:20] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.008670 train acc = 1.0000, test acc = 0.4227
[2023-10-31 20:00:23] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.008274 train acc = 1.0000, test acc = 0.4006
[2023-10-31 20:00:26] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.009154 train acc = 1.0000, test acc = 0.4060
[2023-10-31 20:00:29] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.008421 train acc = 1.0000, test acc = 0.4043
[2023-10-31 20:00:32] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.008354 train acc = 1.0000, test acc = 0.3995
[2023-10-31 20:00:36] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.008399 train acc = 1.0000, test acc = 0.4015
[2023-10-31 20:00:39] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.008567 train acc = 1.0000, test acc = 0.4173
[2023-10-31 20:00:42] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.008682 train acc = 1.0000, test acc = 0.3894
[2023-10-31 20:00:45] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.008492 train acc = 1.0000, test acc = 0.3963
[2023-10-31 20:00:49] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.008767 train acc = 1.0000, test acc = 0.4007
[2023-10-31 20:00:52] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.008314 train acc = 1.0000, test acc = 0.4193
[2023-10-31 20:00:55] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.008639 train acc = 1.0000, test acc = 0.3961
[2023-10-31 20:00:59] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.008637 train acc = 1.0000, test acc = 0.3995
[2023-10-31 20:01:02] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.008193 train acc = 1.0000, test acc = 0.3980
Evaluate 20 random ConvNet, mean = 0.4052 std = 0.0093
-------------------------
[2023-10-31 20:01:07] iter = 1000, loss = nan

==================== Final Results ====================

Run 5 experiments, train on ConvNet, evaluate 100 random ConvNet, mean  = 41.24%  std = 1.12%
