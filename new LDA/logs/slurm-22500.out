/data/happythgus/newLDA/DC
/data/opt/anaconda3/envs/pytorch1.12.1_p38/bin/python
moana-r3
main.py:94: DeprecationWarning: an integer is required (got type numpy.float64).  Implicit conversion to integers using __int__ is deprecated, and may be removed in a future version of Python.
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
main.py:94: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  /opt/conda/conda-bld/pytorch_1659484810403/work/torch/csrc/utils/tensor_new.cpp:201.)
  label_syn = torch.tensor([np.ones(args.ipc)*i for i in range(num_classes)], dtype=torch.long, requires_grad=False, device=args.device).view(-1) # [0,0,0, 1,1,1, ..., 9,9,9]
eval_it_pool:  [0, 500, 1000]
Files already downloaded and verified
Files already downloaded and verified

================== Exp 0 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 1, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 1, 'inner_loop': 1, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f62efca4e20>, 'dsa': False}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-26 22:56:30] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 22:56:35] Evaluate_00: epoch = 0300 train time = 2 s train loss = 0.000401 train acc = 1.0000, test acc = 0.0889
[2023-10-26 22:56:37] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000403 train acc = 1.0000, test acc = 0.0922
[2023-10-26 22:56:40] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000401 train acc = 1.0000, test acc = 0.0878
[2023-10-26 22:56:43] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000411 train acc = 1.0000, test acc = 0.0895
[2023-10-26 22:56:45] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000405 train acc = 1.0000, test acc = 0.1001
[2023-10-26 22:56:48] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000414 train acc = 1.0000, test acc = 0.0887
[2023-10-26 22:56:51] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000405 train acc = 1.0000, test acc = 0.0827
[2023-10-26 22:56:54] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000409 train acc = 1.0000, test acc = 0.0969
[2023-10-26 22:56:56] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000402 train acc = 1.0000, test acc = 0.0964
[2023-10-26 22:56:59] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000404 train acc = 1.0000, test acc = 0.0923
[2023-10-26 22:57:02] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000393 train acc = 1.0000, test acc = 0.1006
[2023-10-26 22:57:05] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000408 train acc = 1.0000, test acc = 0.0756
[2023-10-26 22:57:07] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000392 train acc = 1.0000, test acc = 0.0918
[2023-10-26 22:57:10] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000384 train acc = 1.0000, test acc = 0.1002
[2023-10-26 22:57:13] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000376 train acc = 1.0000, test acc = 0.1029
[2023-10-26 22:57:16] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000413 train acc = 1.0000, test acc = 0.0981
[2023-10-26 22:57:18] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000407 train acc = 1.0000, test acc = 0.1010
[2023-10-26 22:57:21] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000392 train acc = 1.0000, test acc = 0.0849
[2023-10-26 22:57:24] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000425 train acc = 1.0000, test acc = 0.0867
[2023-10-26 22:57:26] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000388 train acc = 1.0000, test acc = 0.0965
Evaluate 20 random ConvNet, mean = 0.0927 std = 0.0070
-------------------------
[2023-10-26 22:57:27] iter = 0000, loss = 238.9464
[2023-10-26 22:57:28] iter = 0010, loss = 233.3605
[2023-10-26 22:57:30] iter = 0020, loss = 220.1617
[2023-10-26 22:57:32] iter = 0030, loss = 209.5950
[2023-10-26 22:57:33] iter = 0040, loss = 194.2573
[2023-10-26 22:57:35] iter = 0050, loss = 177.4701
[2023-10-26 22:57:37] iter = 0060, loss = 182.4844
[2023-10-26 22:57:38] iter = 0070, loss = 182.6166
[2023-10-26 22:57:40] iter = 0080, loss = 175.5232
[2023-10-26 22:57:42] iter = 0090, loss = 167.6139
[2023-10-26 22:57:43] iter = 0100, loss = 184.1494
[2023-10-26 22:57:45] iter = 0110, loss = 165.9099
[2023-10-26 22:57:47] iter = 0120, loss = 166.8715
[2023-10-26 22:57:48] iter = 0130, loss = 167.9744
[2023-10-26 22:57:50] iter = 0140, loss = 169.6517
[2023-10-26 22:57:52] iter = 0150, loss = 179.1334
[2023-10-26 22:57:53] iter = 0160, loss = 165.4573
[2023-10-26 22:57:55] iter = 0170, loss = 163.2485
[2023-10-26 22:57:57] iter = 0180, loss = 163.1451
[2023-10-26 22:57:58] iter = 0190, loss = 161.3807
[2023-10-26 22:58:00] iter = 0200, loss = 168.7260
[2023-10-26 22:58:02] iter = 0210, loss = 167.0004
[2023-10-26 22:58:03] iter = 0220, loss = 152.5336
[2023-10-26 22:58:05] iter = 0230, loss = 158.2981
[2023-10-26 22:58:07] iter = 0240, loss = 152.8810
[2023-10-26 22:58:08] iter = 0250, loss = 161.0066
[2023-10-26 22:58:10] iter = 0260, loss = 153.0774
[2023-10-26 22:58:12] iter = 0270, loss = 161.9433
[2023-10-26 22:58:13] iter = 0280, loss = 163.5220
[2023-10-26 22:58:15] iter = 0290, loss = 153.0512
[2023-10-26 22:58:17] iter = 0300, loss = 154.2450
[2023-10-26 22:58:18] iter = 0310, loss = 147.2029
[2023-10-26 22:58:20] iter = 0320, loss = 145.5313
[2023-10-26 22:58:22] iter = 0330, loss = 148.2762
[2023-10-26 22:58:23] iter = 0340, loss = 155.0266
[2023-10-26 22:58:25] iter = 0350, loss = 147.4728
[2023-10-26 22:58:27] iter = 0360, loss = 158.5804
[2023-10-26 22:58:28] iter = 0370, loss = 149.6494
[2023-10-26 22:58:30] iter = 0380, loss = 154.2900
[2023-10-26 22:58:32] iter = 0390, loss = 150.1965
[2023-10-26 22:58:33] iter = 0400, loss = 151.7266
[2023-10-26 22:58:35] iter = 0410, loss = 151.6839
[2023-10-26 22:58:37] iter = 0420, loss = 148.7574
[2023-10-26 22:58:38] iter = 0430, loss = 162.2082
[2023-10-26 22:58:40] iter = 0440, loss = 147.7566
[2023-10-26 22:58:41] iter = 0450, loss = 146.0109
[2023-10-26 22:58:43] iter = 0460, loss = 141.1142
[2023-10-26 22:58:45] iter = 0470, loss = 146.6237
[2023-10-26 22:58:46] iter = 0480, loss = 139.4583
[2023-10-26 22:58:48] iter = 0490, loss = 145.9987
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 22:58:52] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000613 train acc = 1.0000, test acc = 0.3053
[2023-10-26 22:58:55] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000609 train acc = 1.0000, test acc = 0.2987
[2023-10-26 22:58:58] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000575 train acc = 1.0000, test acc = 0.2810
[2023-10-26 22:59:01] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000559 train acc = 1.0000, test acc = 0.2963
[2023-10-26 22:59:03] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000570 train acc = 1.0000, test acc = 0.3030
[2023-10-26 22:59:06] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000559 train acc = 1.0000, test acc = 0.2938
[2023-10-26 22:59:09] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000626 train acc = 1.0000, test acc = 0.3075
[2023-10-26 22:59:11] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000585 train acc = 1.0000, test acc = 0.3041
[2023-10-26 22:59:14] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000569 train acc = 1.0000, test acc = 0.3215
[2023-10-26 22:59:17] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000531 train acc = 1.0000, test acc = 0.2949
[2023-10-26 22:59:20] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000619 train acc = 1.0000, test acc = 0.2923
[2023-10-26 22:59:22] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000616 train acc = 1.0000, test acc = 0.3005
[2023-10-26 22:59:25] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000606 train acc = 1.0000, test acc = 0.2931
[2023-10-26 22:59:28] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000590 train acc = 1.0000, test acc = 0.3019
[2023-10-26 22:59:31] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000636 train acc = 1.0000, test acc = 0.3026
[2023-10-26 22:59:33] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000623 train acc = 1.0000, test acc = 0.3148
[2023-10-26 22:59:36] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000540 train acc = 1.0000, test acc = 0.3170
[2023-10-26 22:59:39] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000613 train acc = 1.0000, test acc = 0.2987
[2023-10-26 22:59:42] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000588 train acc = 1.0000, test acc = 0.3183
[2023-10-26 22:59:44] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000546 train acc = 1.0000, test acc = 0.2995
Evaluate 20 random ConvNet, mean = 0.3022 std = 0.0097
-------------------------
[2023-10-26 22:59:45] iter = 0500, loss = 145.4874
[2023-10-26 22:59:46] iter = 0510, loss = 144.6051
[2023-10-26 22:59:48] iter = 0520, loss = 144.4394
[2023-10-26 22:59:50] iter = 0530, loss = 144.8150
[2023-10-26 22:59:51] iter = 0540, loss = 150.6862
[2023-10-26 22:59:53] iter = 0550, loss = 142.2548
[2023-10-26 22:59:55] iter = 0560, loss = 142.8162
[2023-10-26 22:59:56] iter = 0570, loss = 151.9073
[2023-10-26 22:59:58] iter = 0580, loss = 156.2477
[2023-10-26 22:59:59] iter = 0590, loss = 155.5200
[2023-10-26 23:00:01] iter = 0600, loss = 146.9799
[2023-10-26 23:00:03] iter = 0610, loss = 151.1180
[2023-10-26 23:00:04] iter = 0620, loss = 142.7180
[2023-10-26 23:00:06] iter = 0630, loss = 147.7849
[2023-10-26 23:00:08] iter = 0640, loss = 145.7029
[2023-10-26 23:00:09] iter = 0650, loss = 142.4528
[2023-10-26 23:00:11] iter = 0660, loss = 142.6270
[2023-10-26 23:00:13] iter = 0670, loss = 144.0296
[2023-10-26 23:00:14] iter = 0680, loss = 145.1052
[2023-10-26 23:00:16] iter = 0690, loss = 152.8205
[2023-10-26 23:00:18] iter = 0700, loss = 143.7441
[2023-10-26 23:00:19] iter = 0710, loss = 140.5846
[2023-10-26 23:00:21] iter = 0720, loss = 144.2418
[2023-10-26 23:00:23] iter = 0730, loss = 155.0573
[2023-10-26 23:00:24] iter = 0740, loss = 142.8282
[2023-10-26 23:00:26] iter = 0750, loss = 146.5896
[2023-10-26 23:00:28] iter = 0760, loss = 148.7027
[2023-10-26 23:00:29] iter = 0770, loss = 150.4242
[2023-10-26 23:00:31] iter = 0780, loss = 133.7243
[2023-10-26 23:00:33] iter = 0790, loss = 140.1914
[2023-10-26 23:00:34] iter = 0800, loss = 146.5449
[2023-10-26 23:00:36] iter = 0810, loss = 139.0581
[2023-10-26 23:00:38] iter = 0820, loss = 141.1932
[2023-10-26 23:00:39] iter = 0830, loss = 134.5395
[2023-10-26 23:00:41] iter = 0840, loss = 142.8888
[2023-10-26 23:00:43] iter = 0850, loss = 130.4599
[2023-10-26 23:00:44] iter = 0860, loss = 135.7307
[2023-10-26 23:00:46] iter = 0870, loss = 145.3900
[2023-10-26 23:00:48] iter = 0880, loss = 143.9983
[2023-10-26 23:00:49] iter = 0890, loss = 125.2178
[2023-10-26 23:00:51] iter = 0900, loss = 139.0543
[2023-10-26 23:00:53] iter = 0910, loss = 154.8503
[2023-10-26 23:00:55] iter = 0920, loss = 131.4787
[2023-10-26 23:00:56] iter = 0930, loss = 139.4165
[2023-10-26 23:00:58] iter = 0940, loss = 135.5170
[2023-10-26 23:00:59] iter = 0950, loss = 135.1823
[2023-10-26 23:01:01] iter = 0960, loss = 140.7288
[2023-10-26 23:01:03] iter = 0970, loss = 143.6179
[2023-10-26 23:01:04] iter = 0980, loss = 136.2952
[2023-10-26 23:01:06] iter = 0990, loss = 135.9496
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 23:01:10] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000606 train acc = 1.0000, test acc = 0.2892
[2023-10-26 23:01:13] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000650 train acc = 1.0000, test acc = 0.3095
[2023-10-26 23:01:16] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000568 train acc = 1.0000, test acc = 0.2871
[2023-10-26 23:01:19] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000619 train acc = 1.0000, test acc = 0.3081
[2023-10-26 23:01:21] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000645 train acc = 1.0000, test acc = 0.3223
[2023-10-26 23:01:24] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000613 train acc = 1.0000, test acc = 0.3061
[2023-10-26 23:01:27] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000595 train acc = 1.0000, test acc = 0.3173
[2023-10-26 23:01:29] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000611 train acc = 1.0000, test acc = 0.3113
[2023-10-26 23:01:32] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000655 train acc = 1.0000, test acc = 0.3149
[2023-10-26 23:01:35] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000598 train acc = 1.0000, test acc = 0.3016
[2023-10-26 23:01:38] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000634 train acc = 1.0000, test acc = 0.2885
[2023-10-26 23:01:40] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000581 train acc = 1.0000, test acc = 0.3057
[2023-10-26 23:01:43] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000637 train acc = 1.0000, test acc = 0.2952
[2023-10-26 23:01:46] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000645 train acc = 1.0000, test acc = 0.3143
[2023-10-26 23:01:49] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000637 train acc = 1.0000, test acc = 0.3029
[2023-10-26 23:01:51] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000611 train acc = 1.0000, test acc = 0.3116
[2023-10-26 23:01:54] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000608 train acc = 1.0000, test acc = 0.3109
[2023-10-26 23:01:57] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000602 train acc = 1.0000, test acc = 0.3140
[2023-10-26 23:02:00] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000638 train acc = 1.0000, test acc = 0.3182
[2023-10-26 23:02:02] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000624 train acc = 1.0000, test acc = 0.3211
Evaluate 20 random ConvNet, mean = 0.3075 std = 0.0103
-------------------------
[2023-10-26 23:02:03] iter = 1000, loss = 136.8204

================== Exp 1 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 1, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 1, 'inner_loop': 1, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f62efca4e20>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-26 23:02:19] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 23:02:21] Evaluate_00: epoch = 0300 train time = 0 s train loss = 0.000409 train acc = 1.0000, test acc = 0.1465
[2023-10-26 23:02:24] Evaluate_01: epoch = 0300 train time = 0 s train loss = 0.000424 train acc = 1.0000, test acc = 0.1187
[2023-10-26 23:02:27] Evaluate_02: epoch = 0300 train time = 0 s train loss = 0.000437 train acc = 1.0000, test acc = 0.1062
[2023-10-26 23:02:29] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000425 train acc = 1.0000, test acc = 0.1059
[2023-10-26 23:02:32] Evaluate_04: epoch = 0300 train time = 0 s train loss = 0.000427 train acc = 1.0000, test acc = 0.1063
[2023-10-26 23:02:35] Evaluate_05: epoch = 0300 train time = 0 s train loss = 0.000418 train acc = 1.0000, test acc = 0.1126
[2023-10-26 23:02:37] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000425 train acc = 1.0000, test acc = 0.1147
[2023-10-26 23:02:40] Evaluate_07: epoch = 0300 train time = 0 s train loss = 0.000402 train acc = 1.0000, test acc = 0.1148
[2023-10-26 23:02:43] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000410 train acc = 1.0000, test acc = 0.1022
[2023-10-26 23:02:45] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000442 train acc = 1.0000, test acc = 0.1002
[2023-10-26 23:02:48] Evaluate_10: epoch = 0300 train time = 0 s train loss = 0.000427 train acc = 1.0000, test acc = 0.1138
[2023-10-26 23:02:51] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000425 train acc = 1.0000, test acc = 0.1130
[2023-10-26 23:02:53] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000409 train acc = 1.0000, test acc = 0.1160
[2023-10-26 23:02:56] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000433 train acc = 1.0000, test acc = 0.1101
[2023-10-26 23:02:59] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000400 train acc = 1.0000, test acc = 0.1115
[2023-10-26 23:03:02] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000432 train acc = 1.0000, test acc = 0.0898
[2023-10-26 23:03:04] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000425 train acc = 1.0000, test acc = 0.0884
[2023-10-26 23:03:07] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000423 train acc = 1.0000, test acc = 0.0995
[2023-10-26 23:03:10] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000425 train acc = 1.0000, test acc = 0.0989
[2023-10-26 23:03:13] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000406 train acc = 1.0000, test acc = 0.1100
Evaluate 20 random ConvNet, mean = 0.1090 std = 0.0119
-------------------------
[2023-10-26 23:03:13] iter = 0000, loss = 238.2390
[2023-10-26 23:03:14] iter = 0010, loss = 221.4988
[2023-10-26 23:03:16] iter = 0020, loss = 204.3150
[2023-10-26 23:03:18] iter = 0030, loss = 188.5971
[2023-10-26 23:03:19] iter = 0040, loss = 195.9905
[2023-10-26 23:03:21] iter = 0050, loss = 191.4883
[2023-10-26 23:03:23] iter = 0060, loss = 178.8740
[2023-10-26 23:03:24] iter = 0070, loss = 179.6781
[2023-10-26 23:03:26] iter = 0080, loss = 181.8330
[2023-10-26 23:03:28] iter = 0090, loss = 176.9197
[2023-10-26 23:03:29] iter = 0100, loss = 187.5453
[2023-10-26 23:03:31] iter = 0110, loss = 182.6524
[2023-10-26 23:03:33] iter = 0120, loss = 174.3532
[2023-10-26 23:03:34] iter = 0130, loss = 166.7743
[2023-10-26 23:03:36] iter = 0140, loss = 180.0140
[2023-10-26 23:03:38] iter = 0150, loss = 174.9369
[2023-10-26 23:03:39] iter = 0160, loss = 164.6407
[2023-10-26 23:03:41] iter = 0170, loss = 167.7219
[2023-10-26 23:03:42] iter = 0180, loss = 147.6059
[2023-10-26 23:03:44] iter = 0190, loss = 168.6719
[2023-10-26 23:03:45] iter = 0200, loss = 160.8465
[2023-10-26 23:03:47] iter = 0210, loss = 156.0658
[2023-10-26 23:03:49] iter = 0220, loss = 164.3272
[2023-10-26 23:03:50] iter = 0230, loss = 155.5867
[2023-10-26 23:03:52] iter = 0240, loss = 157.5889
[2023-10-26 23:03:53] iter = 0250, loss = 161.4427
[2023-10-26 23:03:55] iter = 0260, loss = 156.3868
[2023-10-26 23:03:57] iter = 0270, loss = 159.0186
[2023-10-26 23:03:58] iter = 0280, loss = 162.2678
[2023-10-26 23:04:00] iter = 0290, loss = 150.0258
[2023-10-26 23:04:01] iter = 0300, loss = 150.8297
[2023-10-26 23:04:03] iter = 0310, loss = 150.4882
[2023-10-26 23:04:05] iter = 0320, loss = 153.5424
[2023-10-26 23:04:06] iter = 0330, loss = 151.8416
[2023-10-26 23:04:08] iter = 0340, loss = 156.6177
[2023-10-26 23:04:10] iter = 0350, loss = 151.3458
[2023-10-26 23:04:11] iter = 0360, loss = 150.5565
[2023-10-26 23:04:13] iter = 0370, loss = 151.9240
[2023-10-26 23:04:15] iter = 0380, loss = 146.0621
[2023-10-26 23:04:16] iter = 0390, loss = 151.7321
[2023-10-26 23:04:18] iter = 0400, loss = 156.4171
[2023-10-26 23:04:20] iter = 0410, loss = 151.1777
[2023-10-26 23:04:21] iter = 0420, loss = 145.9674
[2023-10-26 23:04:23] iter = 0430, loss = 153.1031
[2023-10-26 23:04:25] iter = 0440, loss = 151.0241
[2023-10-26 23:04:26] iter = 0450, loss = 149.2958
[2023-10-26 23:04:28] iter = 0460, loss = 143.5876
[2023-10-26 23:04:30] iter = 0470, loss = 154.8014
[2023-10-26 23:04:31] iter = 0480, loss = 140.4651
[2023-10-26 23:04:33] iter = 0490, loss = 142.6702
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 23:04:37] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000605 train acc = 1.0000, test acc = 0.2937
[2023-10-26 23:04:40] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000602 train acc = 1.0000, test acc = 0.2990
[2023-10-26 23:04:43] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000652 train acc = 1.0000, test acc = 0.2993
[2023-10-26 23:04:45] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000571 train acc = 1.0000, test acc = 0.3092
[2023-10-26 23:04:48] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000581 train acc = 1.0000, test acc = 0.2996
[2023-10-26 23:04:51] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000653 train acc = 1.0000, test acc = 0.3041
[2023-10-26 23:04:53] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000574 train acc = 1.0000, test acc = 0.3105
[2023-10-26 23:04:56] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000664 train acc = 1.0000, test acc = 0.3116
[2023-10-26 23:04:59] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000629 train acc = 1.0000, test acc = 0.3057
[2023-10-26 23:05:02] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000583 train acc = 1.0000, test acc = 0.2904
[2023-10-26 23:05:04] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000609 train acc = 1.0000, test acc = 0.3098
[2023-10-26 23:05:07] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000562 train acc = 1.0000, test acc = 0.3048
[2023-10-26 23:05:10] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000597 train acc = 1.0000, test acc = 0.3027
[2023-10-26 23:05:13] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000623 train acc = 1.0000, test acc = 0.3156
[2023-10-26 23:05:15] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000590 train acc = 1.0000, test acc = 0.3174
[2023-10-26 23:05:18] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000567 train acc = 1.0000, test acc = 0.3084
[2023-10-26 23:05:21] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000599 train acc = 1.0000, test acc = 0.3172
[2023-10-26 23:05:23] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000644 train acc = 1.0000, test acc = 0.3040
[2023-10-26 23:05:26] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000589 train acc = 1.0000, test acc = 0.3118
[2023-10-26 23:05:29] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000632 train acc = 1.0000, test acc = 0.3189
Evaluate 20 random ConvNet, mean = 0.3067 std = 0.0076
-------------------------
[2023-10-26 23:05:29] iter = 0500, loss = 146.9898
[2023-10-26 23:05:31] iter = 0510, loss = 145.2677
[2023-10-26 23:05:32] iter = 0520, loss = 145.8889
[2023-10-26 23:05:34] iter = 0530, loss = 156.0043
[2023-10-26 23:05:36] iter = 0540, loss = 156.4108
[2023-10-26 23:05:37] iter = 0550, loss = 144.2689
[2023-10-26 23:05:39] iter = 0560, loss = 147.8467
[2023-10-26 23:05:41] iter = 0570, loss = 154.2988
[2023-10-26 23:05:42] iter = 0580, loss = 140.6207
[2023-10-26 23:05:44] iter = 0590, loss = 133.1652
[2023-10-26 23:05:46] iter = 0600, loss = 145.6555
[2023-10-26 23:05:47] iter = 0610, loss = 149.8260
[2023-10-26 23:05:49] iter = 0620, loss = 135.9306
[2023-10-26 23:05:51] iter = 0630, loss = 148.8476
[2023-10-26 23:05:52] iter = 0640, loss = 145.8034
[2023-10-26 23:05:54] iter = 0650, loss = 138.8731
[2023-10-26 23:05:56] iter = 0660, loss = 148.7044
[2023-10-26 23:05:57] iter = 0670, loss = 146.6513
[2023-10-26 23:05:59] iter = 0680, loss = 146.9833
[2023-10-26 23:06:01] iter = 0690, loss = 144.1412
[2023-10-26 23:06:02] iter = 0700, loss = 146.3522
[2023-10-26 23:06:04] iter = 0710, loss = 145.7833
[2023-10-26 23:06:06] iter = 0720, loss = 143.7078
[2023-10-26 23:06:07] iter = 0730, loss = 145.3035
[2023-10-26 23:06:09] iter = 0740, loss = 141.5176
[2023-10-26 23:06:11] iter = 0750, loss = 139.7133
[2023-10-26 23:06:12] iter = 0760, loss = 144.8874
[2023-10-26 23:06:14] iter = 0770, loss = 140.4693
[2023-10-26 23:06:16] iter = 0780, loss = 139.3275
[2023-10-26 23:06:17] iter = 0790, loss = 143.9709
[2023-10-26 23:06:19] iter = 0800, loss = 139.4956
[2023-10-26 23:06:21] iter = 0810, loss = 144.6739
[2023-10-26 23:06:22] iter = 0820, loss = 141.5642
[2023-10-26 23:06:24] iter = 0830, loss = 145.0112
[2023-10-26 23:06:26] iter = 0840, loss = 143.1473
[2023-10-26 23:06:27] iter = 0850, loss = 139.2976
[2023-10-26 23:06:29] iter = 0860, loss = 142.5616
[2023-10-26 23:06:31] iter = 0870, loss = 142.8707
[2023-10-26 23:06:32] iter = 0880, loss = 139.5009
[2023-10-26 23:06:34] iter = 0890, loss = 153.3088
[2023-10-26 23:06:36] iter = 0900, loss = 140.8105
[2023-10-26 23:06:37] iter = 0910, loss = 135.6853
[2023-10-26 23:06:39] iter = 0920, loss = 141.8882
[2023-10-26 23:06:41] iter = 0930, loss = 144.3177
[2023-10-26 23:06:43] iter = 0940, loss = 141.6925
[2023-10-26 23:06:44] iter = 0950, loss = 152.2119
[2023-10-26 23:06:46] iter = 0960, loss = 142.5597
[2023-10-26 23:06:48] iter = 0970, loss = 145.0207
[2023-10-26 23:06:50] iter = 0980, loss = 141.1930
[2023-10-26 23:06:51] iter = 0990, loss = 135.2885
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 23:06:56] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000645 train acc = 1.0000, test acc = 0.3168
[2023-10-26 23:06:59] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000628 train acc = 1.0000, test acc = 0.3156
[2023-10-26 23:07:02] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000609 train acc = 1.0000, test acc = 0.3145
[2023-10-26 23:07:04] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000591 train acc = 1.0000, test acc = 0.3093
[2023-10-26 23:07:07] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000613 train acc = 1.0000, test acc = 0.3147
[2023-10-26 23:07:10] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000676 train acc = 1.0000, test acc = 0.3092
[2023-10-26 23:07:13] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000640 train acc = 1.0000, test acc = 0.3139
[2023-10-26 23:07:15] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000623 train acc = 1.0000, test acc = 0.3103
[2023-10-26 23:07:18] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000663 train acc = 1.0000, test acc = 0.3100
[2023-10-26 23:07:21] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000646 train acc = 1.0000, test acc = 0.3240
[2023-10-26 23:07:24] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000586 train acc = 1.0000, test acc = 0.3152
[2023-10-26 23:07:26] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000611 train acc = 1.0000, test acc = 0.3080
[2023-10-26 23:07:29] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000563 train acc = 1.0000, test acc = 0.2987
[2023-10-26 23:07:32] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000601 train acc = 1.0000, test acc = 0.3130
[2023-10-26 23:07:35] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000576 train acc = 1.0000, test acc = 0.3037
[2023-10-26 23:07:37] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000621 train acc = 1.0000, test acc = 0.3136
[2023-10-26 23:07:40] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000629 train acc = 1.0000, test acc = 0.3146
[2023-10-26 23:07:43] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000607 train acc = 1.0000, test acc = 0.3171
[2023-10-26 23:07:46] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000667 train acc = 1.0000, test acc = 0.2999
[2023-10-26 23:07:48] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000651 train acc = 1.0000, test acc = 0.3091
Evaluate 20 random ConvNet, mean = 0.3116 std = 0.0058
-------------------------
[2023-10-26 23:07:49] iter = 1000, loss = 147.6996

================== Exp 2 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 1, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 1, 'inner_loop': 1, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f62efca4e20>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-26 23:08:05] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 23:08:07] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000403 train acc = 1.0000, test acc = 0.1019
[2023-10-26 23:08:10] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000395 train acc = 1.0000, test acc = 0.0685
[2023-10-26 23:08:13] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000419 train acc = 1.0000, test acc = 0.0814
[2023-10-26 23:08:16] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000417 train acc = 1.0000, test acc = 0.0576
[2023-10-26 23:08:18] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000418 train acc = 1.0000, test acc = 0.0833
[2023-10-26 23:08:21] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000404 train acc = 1.0000, test acc = 0.0933
[2023-10-26 23:08:24] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000392 train acc = 1.0000, test acc = 0.0736
[2023-10-26 23:08:27] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000419 train acc = 1.0000, test acc = 0.0671
[2023-10-26 23:08:29] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000406 train acc = 1.0000, test acc = 0.1050
[2023-10-26 23:08:32] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000386 train acc = 1.0000, test acc = 0.0790
[2023-10-26 23:08:35] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000420 train acc = 1.0000, test acc = 0.0920
[2023-10-26 23:08:38] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000414 train acc = 1.0000, test acc = 0.0606
[2023-10-26 23:08:40] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000406 train acc = 1.0000, test acc = 0.0807
[2023-10-26 23:08:43] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000403 train acc = 1.0000, test acc = 0.0824
[2023-10-26 23:08:46] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000428 train acc = 1.0000, test acc = 0.0745
[2023-10-26 23:08:49] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000415 train acc = 1.0000, test acc = 0.0721
[2023-10-26 23:08:51] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000426 train acc = 1.0000, test acc = 0.0849
[2023-10-26 23:08:54] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000436 train acc = 1.0000, test acc = 0.0678
[2023-10-26 23:08:57] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000409 train acc = 1.0000, test acc = 0.0692
[2023-10-26 23:09:00] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000433 train acc = 1.0000, test acc = 0.0647
Evaluate 20 random ConvNet, mean = 0.0780 std = 0.0126
-------------------------
[2023-10-26 23:09:00] iter = 0000, loss = 245.9468
[2023-10-26 23:09:02] iter = 0010, loss = 222.2100
[2023-10-26 23:09:03] iter = 0020, loss = 201.9056
[2023-10-26 23:09:05] iter = 0030, loss = 204.4805
[2023-10-26 23:09:07] iter = 0040, loss = 203.2460
[2023-10-26 23:09:09] iter = 0050, loss = 175.1252
[2023-10-26 23:09:10] iter = 0060, loss = 193.1224
[2023-10-26 23:09:12] iter = 0070, loss = 192.8509
[2023-10-26 23:09:14] iter = 0080, loss = 172.0832
[2023-10-26 23:09:16] iter = 0090, loss = 178.1180
[2023-10-26 23:09:18] iter = 0100, loss = 181.2957
[2023-10-26 23:09:19] iter = 0110, loss = 168.0121
[2023-10-26 23:09:21] iter = 0120, loss = 180.6559
[2023-10-26 23:09:23] iter = 0130, loss = 177.9673
[2023-10-26 23:09:25] iter = 0140, loss = 166.8189
[2023-10-26 23:09:27] iter = 0150, loss = 187.0068
[2023-10-26 23:09:28] iter = 0160, loss = 165.1658
[2023-10-26 23:09:30] iter = 0170, loss = 172.8796
[2023-10-26 23:09:32] iter = 0180, loss = 161.7713
[2023-10-26 23:09:34] iter = 0190, loss = 161.6722
[2023-10-26 23:09:36] iter = 0200, loss = 166.3335
[2023-10-26 23:09:37] iter = 0210, loss = 156.7198
[2023-10-26 23:09:39] iter = 0220, loss = 168.2726
[2023-10-26 23:09:41] iter = 0230, loss = 161.3970
[2023-10-26 23:09:43] iter = 0240, loss = 164.1800
[2023-10-26 23:09:44] iter = 0250, loss = 155.9131
[2023-10-26 23:09:46] iter = 0260, loss = 158.1099
[2023-10-26 23:09:48] iter = 0270, loss = 157.5402
[2023-10-26 23:09:50] iter = 0280, loss = 149.0326
[2023-10-26 23:09:52] iter = 0290, loss = 158.6085
[2023-10-26 23:09:53] iter = 0300, loss = 147.7900
[2023-10-26 23:09:55] iter = 0310, loss = 157.0356
[2023-10-26 23:09:57] iter = 0320, loss = 154.6127
[2023-10-26 23:09:58] iter = 0330, loss = 158.9064
[2023-10-26 23:10:00] iter = 0340, loss = 150.8256
[2023-10-26 23:10:02] iter = 0350, loss = 160.8213
[2023-10-26 23:10:04] iter = 0360, loss = 155.3663
[2023-10-26 23:10:05] iter = 0370, loss = 150.0384
[2023-10-26 23:10:07] iter = 0380, loss = 141.3439
[2023-10-26 23:10:09] iter = 0390, loss = 151.9143
[2023-10-26 23:10:10] iter = 0400, loss = 146.7495
[2023-10-26 23:10:12] iter = 0410, loss = 150.3316
[2023-10-26 23:10:14] iter = 0420, loss = 153.2136
[2023-10-26 23:10:16] iter = 0430, loss = 150.1820
[2023-10-26 23:10:17] iter = 0440, loss = 144.3157
[2023-10-26 23:10:19] iter = 0450, loss = 150.6173
[2023-10-26 23:10:21] iter = 0460, loss = 146.5778
[2023-10-26 23:10:22] iter = 0470, loss = 146.6333
[2023-10-26 23:10:24] iter = 0480, loss = 150.9852
[2023-10-26 23:10:26] iter = 0490, loss = 143.5859
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 23:10:30] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000597 train acc = 1.0000, test acc = 0.3077
[2023-10-26 23:10:33] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000579 train acc = 1.0000, test acc = 0.3025
[2023-10-26 23:10:36] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000552 train acc = 1.0000, test acc = 0.3128
[2023-10-26 23:10:38] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000586 train acc = 1.0000, test acc = 0.3199
[2023-10-26 23:10:41] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000565 train acc = 1.0000, test acc = 0.3140
[2023-10-26 23:10:44] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000580 train acc = 1.0000, test acc = 0.2863
[2023-10-26 23:10:47] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000569 train acc = 1.0000, test acc = 0.2979
[2023-10-26 23:10:49] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000567 train acc = 1.0000, test acc = 0.2923
[2023-10-26 23:10:52] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000574 train acc = 1.0000, test acc = 0.3069
[2023-10-26 23:10:55] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000617 train acc = 1.0000, test acc = 0.3000
[2023-10-26 23:10:58] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000580 train acc = 1.0000, test acc = 0.3083
[2023-10-26 23:11:00] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000580 train acc = 1.0000, test acc = 0.3150
[2023-10-26 23:11:03] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000610 train acc = 1.0000, test acc = 0.3076
[2023-10-26 23:11:06] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000576 train acc = 1.0000, test acc = 0.3018
[2023-10-26 23:11:09] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000564 train acc = 1.0000, test acc = 0.2991
[2023-10-26 23:11:11] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000590 train acc = 1.0000, test acc = 0.3108
[2023-10-26 23:11:14] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000579 train acc = 1.0000, test acc = 0.2953
[2023-10-26 23:11:17] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000620 train acc = 1.0000, test acc = 0.3037
[2023-10-26 23:11:20] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000606 train acc = 1.0000, test acc = 0.2991
[2023-10-26 23:11:22] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000590 train acc = 1.0000, test acc = 0.3162
Evaluate 20 random ConvNet, mean = 0.3049 std = 0.0084
-------------------------
[2023-10-26 23:11:23] iter = 0500, loss = 151.0784
[2023-10-26 23:11:24] iter = 0510, loss = 145.1302
[2023-10-26 23:11:26] iter = 0520, loss = 141.7223
[2023-10-26 23:11:28] iter = 0530, loss = 140.4055
[2023-10-26 23:11:30] iter = 0540, loss = 158.0142
[2023-10-26 23:11:31] iter = 0550, loss = 154.3865
[2023-10-26 23:11:33] iter = 0560, loss = 139.3558
[2023-10-26 23:11:35] iter = 0570, loss = 144.4053
[2023-10-26 23:11:37] iter = 0580, loss = 159.5000
[2023-10-26 23:11:39] iter = 0590, loss = 150.3688
[2023-10-26 23:11:40] iter = 0600, loss = 153.4995
[2023-10-26 23:11:42] iter = 0610, loss = 153.0674
[2023-10-26 23:11:44] iter = 0620, loss = 140.3948
[2023-10-26 23:11:46] iter = 0630, loss = 147.0491
[2023-10-26 23:11:48] iter = 0640, loss = 148.4319
[2023-10-26 23:11:49] iter = 0650, loss = 142.3438
[2023-10-26 23:11:51] iter = 0660, loss = 152.1144
[2023-10-26 23:11:53] iter = 0670, loss = 145.1951
[2023-10-26 23:11:55] iter = 0680, loss = 139.9789
[2023-10-26 23:11:57] iter = 0690, loss = 145.4949
[2023-10-26 23:11:58] iter = 0700, loss = 142.0536
[2023-10-26 23:12:00] iter = 0710, loss = 153.7456
[2023-10-26 23:12:02] iter = 0720, loss = 153.2368
[2023-10-26 23:12:03] iter = 0730, loss = 136.9650
[2023-10-26 23:12:05] iter = 0740, loss = 153.6460
[2023-10-26 23:12:07] iter = 0750, loss = 147.1731
[2023-10-26 23:12:09] iter = 0760, loss = 143.3471
[2023-10-26 23:12:11] iter = 0770, loss = 147.5110
[2023-10-26 23:12:12] iter = 0780, loss = 147.9809
[2023-10-26 23:12:14] iter = 0790, loss = 148.6284
[2023-10-26 23:12:16] iter = 0800, loss = 146.3863
[2023-10-26 23:12:18] iter = 0810, loss = 154.7649
[2023-10-26 23:12:20] iter = 0820, loss = 140.0079
[2023-10-26 23:12:21] iter = 0830, loss = 136.1098
[2023-10-26 23:12:23] iter = 0840, loss = 144.3884
[2023-10-26 23:12:25] iter = 0850, loss = 143.0255
[2023-10-26 23:12:27] iter = 0860, loss = 135.5540
[2023-10-26 23:12:29] iter = 0870, loss = 140.4868
[2023-10-26 23:12:30] iter = 0880, loss = 130.1426
[2023-10-26 23:12:32] iter = 0890, loss = 145.0988
[2023-10-26 23:12:34] iter = 0900, loss = 139.4472
[2023-10-26 23:12:35] iter = 0910, loss = 140.1211
[2023-10-26 23:12:37] iter = 0920, loss = 140.5774
[2023-10-26 23:12:39] iter = 0930, loss = 134.0137
[2023-10-26 23:12:41] iter = 0940, loss = 149.9107
[2023-10-26 23:12:43] iter = 0950, loss = 144.2464
[2023-10-26 23:12:44] iter = 0960, loss = 134.7561
[2023-10-26 23:12:46] iter = 0970, loss = 139.3714
[2023-10-26 23:12:48] iter = 0980, loss = 141.1218
[2023-10-26 23:12:50] iter = 0990, loss = 143.8438
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 23:12:54] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000618 train acc = 1.0000, test acc = 0.3118
[2023-10-26 23:12:57] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000586 train acc = 1.0000, test acc = 0.3127
[2023-10-26 23:13:00] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000593 train acc = 1.0000, test acc = 0.3074
[2023-10-26 23:13:03] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000614 train acc = 1.0000, test acc = 0.3075
[2023-10-26 23:13:05] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000645 train acc = 1.0000, test acc = 0.3001
[2023-10-26 23:13:08] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000654 train acc = 1.0000, test acc = 0.3162
[2023-10-26 23:13:11] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000635 train acc = 1.0000, test acc = 0.3134
[2023-10-26 23:13:14] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000648 train acc = 1.0000, test acc = 0.3076
[2023-10-26 23:13:16] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000625 train acc = 1.0000, test acc = 0.3161
[2023-10-26 23:13:19] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000615 train acc = 1.0000, test acc = 0.3037
[2023-10-26 23:13:22] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000617 train acc = 1.0000, test acc = 0.3035
[2023-10-26 23:13:25] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000618 train acc = 1.0000, test acc = 0.3071
[2023-10-26 23:13:28] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000631 train acc = 1.0000, test acc = 0.3161
[2023-10-26 23:13:30] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000664 train acc = 1.0000, test acc = 0.3069
[2023-10-26 23:13:33] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000607 train acc = 1.0000, test acc = 0.3159
[2023-10-26 23:13:36] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000595 train acc = 1.0000, test acc = 0.3082
[2023-10-26 23:13:39] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000651 train acc = 1.0000, test acc = 0.3173
[2023-10-26 23:13:41] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000599 train acc = 1.0000, test acc = 0.3083
[2023-10-26 23:13:44] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000604 train acc = 1.0000, test acc = 0.3071
[2023-10-26 23:13:47] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000646 train acc = 1.0000, test acc = 0.3117
Evaluate 20 random ConvNet, mean = 0.3099 std = 0.0048
-------------------------
[2023-10-26 23:13:47] iter = 1000, loss = 135.6781

================== Exp 3 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 1, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 1, 'inner_loop': 1, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f62efca4e20>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-26 23:14:03] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 23:14:06] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000423 train acc = 1.0000, test acc = 0.1122
[2023-10-26 23:14:08] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000413 train acc = 1.0000, test acc = 0.0998
[2023-10-26 23:14:11] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000432 train acc = 1.0000, test acc = 0.1186
[2023-10-26 23:14:14] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000431 train acc = 1.0000, test acc = 0.1141
[2023-10-26 23:14:17] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000427 train acc = 1.0000, test acc = 0.1271
[2023-10-26 23:14:19] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000428 train acc = 1.0000, test acc = 0.1091
[2023-10-26 23:14:22] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000442 train acc = 1.0000, test acc = 0.1198
[2023-10-26 23:14:25] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000408 train acc = 1.0000, test acc = 0.0971
[2023-10-26 23:14:28] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000431 train acc = 1.0000, test acc = 0.1229
[2023-10-26 23:14:30] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000398 train acc = 1.0000, test acc = 0.1102
[2023-10-26 23:14:33] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000400 train acc = 1.0000, test acc = 0.1128
[2023-10-26 23:14:36] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000430 train acc = 1.0000, test acc = 0.1239
[2023-10-26 23:14:39] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000410 train acc = 1.0000, test acc = 0.1278
[2023-10-26 23:14:41] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000441 train acc = 1.0000, test acc = 0.1217
[2023-10-26 23:14:44] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000424 train acc = 1.0000, test acc = 0.1013
[2023-10-26 23:14:47] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000422 train acc = 1.0000, test acc = 0.1274
[2023-10-26 23:14:50] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000413 train acc = 1.0000, test acc = 0.1147
[2023-10-26 23:14:52] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000415 train acc = 1.0000, test acc = 0.1249
[2023-10-26 23:14:55] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000427 train acc = 1.0000, test acc = 0.1351
[2023-10-26 23:14:58] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000446 train acc = 1.0000, test acc = 0.1308
Evaluate 20 random ConvNet, mean = 0.1176 std = 0.0103
-------------------------
[2023-10-26 23:14:58] iter = 0000, loss = 250.3829
[2023-10-26 23:15:00] iter = 0010, loss = 217.6738
[2023-10-26 23:15:02] iter = 0020, loss = 201.6951
[2023-10-26 23:15:03] iter = 0030, loss = 205.4195
[2023-10-26 23:15:05] iter = 0040, loss = 195.1357
[2023-10-26 23:15:07] iter = 0050, loss = 193.1692
[2023-10-26 23:15:09] iter = 0060, loss = 181.1452
[2023-10-26 23:15:10] iter = 0070, loss = 181.3898
[2023-10-26 23:15:12] iter = 0080, loss = 173.2101
[2023-10-26 23:15:14] iter = 0090, loss = 175.0508
[2023-10-26 23:15:16] iter = 0100, loss = 166.6227
[2023-10-26 23:15:18] iter = 0110, loss = 167.2830
[2023-10-26 23:15:19] iter = 0120, loss = 175.8533
[2023-10-26 23:15:21] iter = 0130, loss = 162.1838
[2023-10-26 23:15:23] iter = 0140, loss = 174.4535
[2023-10-26 23:15:25] iter = 0150, loss = 165.6068
[2023-10-26 23:15:26] iter = 0160, loss = 171.1482
[2023-10-26 23:15:28] iter = 0170, loss = 163.7188
[2023-10-26 23:15:30] iter = 0180, loss = 158.5257
[2023-10-26 23:15:32] iter = 0190, loss = 165.4875
[2023-10-26 23:15:34] iter = 0200, loss = 160.0646
[2023-10-26 23:15:35] iter = 0210, loss = 166.1301
[2023-10-26 23:15:37] iter = 0220, loss = 155.6662
[2023-10-26 23:15:39] iter = 0230, loss = 163.6342
[2023-10-26 23:15:41] iter = 0240, loss = 151.7310
[2023-10-26 23:15:42] iter = 0250, loss = 156.6804
[2023-10-26 23:15:44] iter = 0260, loss = 149.1457
[2023-10-26 23:15:46] iter = 0270, loss = 162.9879
[2023-10-26 23:15:48] iter = 0280, loss = 162.3509
[2023-10-26 23:15:50] iter = 0290, loss = 158.5446
[2023-10-26 23:15:51] iter = 0300, loss = 150.9306
[2023-10-26 23:15:53] iter = 0310, loss = 162.7428
[2023-10-26 23:15:55] iter = 0320, loss = 159.4989
[2023-10-26 23:15:57] iter = 0330, loss = 154.8183
[2023-10-26 23:15:59] iter = 0340, loss = 145.0716
[2023-10-26 23:16:00] iter = 0350, loss = 153.5767
[2023-10-26 23:16:02] iter = 0360, loss = 155.6595
[2023-10-26 23:16:04] iter = 0370, loss = 155.3347
[2023-10-26 23:16:06] iter = 0380, loss = 156.6715
[2023-10-26 23:16:07] iter = 0390, loss = 150.3782
[2023-10-26 23:16:09] iter = 0400, loss = 152.0014
[2023-10-26 23:16:11] iter = 0410, loss = 140.1106
[2023-10-26 23:16:13] iter = 0420, loss = 149.2083
[2023-10-26 23:16:15] iter = 0430, loss = 168.0982
[2023-10-26 23:16:16] iter = 0440, loss = 149.0113
[2023-10-26 23:16:18] iter = 0450, loss = 151.6032
[2023-10-26 23:16:20] iter = 0460, loss = 146.6283
[2023-10-26 23:16:22] iter = 0470, loss = 147.0514
[2023-10-26 23:16:24] iter = 0480, loss = 148.1800
[2023-10-26 23:16:25] iter = 0490, loss = 151.7813
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 23:16:30] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000595 train acc = 1.0000, test acc = 0.2918
[2023-10-26 23:16:33] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000604 train acc = 1.0000, test acc = 0.3000
[2023-10-26 23:16:35] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000598 train acc = 1.0000, test acc = 0.2951
[2023-10-26 23:16:38] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000551 train acc = 1.0000, test acc = 0.2986
[2023-10-26 23:16:41] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000613 train acc = 1.0000, test acc = 0.2970
[2023-10-26 23:16:44] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000584 train acc = 1.0000, test acc = 0.3053
[2023-10-26 23:16:46] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000555 train acc = 1.0000, test acc = 0.2897
[2023-10-26 23:16:49] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000580 train acc = 1.0000, test acc = 0.3150
[2023-10-26 23:16:52] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000553 train acc = 1.0000, test acc = 0.3087
[2023-10-26 23:16:55] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000571 train acc = 1.0000, test acc = 0.3158
[2023-10-26 23:16:57] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000600 train acc = 1.0000, test acc = 0.3105
[2023-10-26 23:17:00] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000578 train acc = 1.0000, test acc = 0.3055
[2023-10-26 23:17:03] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000579 train acc = 1.0000, test acc = 0.2898
[2023-10-26 23:17:06] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000527 train acc = 1.0000, test acc = 0.2998
[2023-10-26 23:17:09] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000558 train acc = 1.0000, test acc = 0.3214
[2023-10-26 23:17:11] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000589 train acc = 1.0000, test acc = 0.3015
[2023-10-26 23:17:14] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000599 train acc = 1.0000, test acc = 0.3083
[2023-10-26 23:17:17] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000616 train acc = 1.0000, test acc = 0.3002
[2023-10-26 23:17:20] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000565 train acc = 1.0000, test acc = 0.2847
[2023-10-26 23:17:22] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000596 train acc = 1.0000, test acc = 0.3095
Evaluate 20 random ConvNet, mean = 0.3024 std = 0.0094
-------------------------
[2023-10-26 23:17:23] iter = 0500, loss = 140.8201
[2023-10-26 23:17:24] iter = 0510, loss = 141.0363
[2023-10-26 23:17:26] iter = 0520, loss = 151.0874
[2023-10-26 23:17:28] iter = 0530, loss = 149.7705
[2023-10-26 23:17:30] iter = 0540, loss = 151.3420
[2023-10-26 23:17:31] iter = 0550, loss = 147.8272
[2023-10-26 23:17:33] iter = 0560, loss = 135.1644
[2023-10-26 23:17:35] iter = 0570, loss = 151.9040
[2023-10-26 23:17:37] iter = 0580, loss = 146.8421
[2023-10-26 23:17:38] iter = 0590, loss = 147.2164
[2023-10-26 23:17:40] iter = 0600, loss = 148.6483
[2023-10-26 23:17:42] iter = 0610, loss = 159.3228
[2023-10-26 23:17:44] iter = 0620, loss = 145.8631
[2023-10-26 23:17:45] iter = 0630, loss = 143.8785
[2023-10-26 23:17:47] iter = 0640, loss = 140.5006
[2023-10-26 23:17:49] iter = 0650, loss = 147.5889
[2023-10-26 23:17:51] iter = 0660, loss = 150.8182
[2023-10-26 23:17:53] iter = 0670, loss = 139.2614
[2023-10-26 23:17:54] iter = 0680, loss = 133.3569
[2023-10-26 23:17:56] iter = 0690, loss = 138.7523
[2023-10-26 23:17:58] iter = 0700, loss = 137.6367
[2023-10-26 23:18:00] iter = 0710, loss = 146.5540
[2023-10-26 23:18:01] iter = 0720, loss = 150.1625
[2023-10-26 23:18:03] iter = 0730, loss = 144.9034
[2023-10-26 23:18:05] iter = 0740, loss = 147.2866
[2023-10-26 23:18:06] iter = 0750, loss = 146.4278
[2023-10-26 23:18:08] iter = 0760, loss = 144.3743
[2023-10-26 23:18:10] iter = 0770, loss = 145.4775
[2023-10-26 23:18:12] iter = 0780, loss = 145.3504
[2023-10-26 23:18:13] iter = 0790, loss = 145.3588
[2023-10-26 23:18:15] iter = 0800, loss = 148.5480
[2023-10-26 23:18:17] iter = 0810, loss = 145.7396
[2023-10-26 23:18:18] iter = 0820, loss = 149.4421
[2023-10-26 23:18:20] iter = 0830, loss = 141.4219
[2023-10-26 23:18:22] iter = 0840, loss = 139.4975
[2023-10-26 23:18:24] iter = 0850, loss = 139.0678
[2023-10-26 23:18:25] iter = 0860, loss = 141.7272
[2023-10-26 23:18:27] iter = 0870, loss = 149.5899
[2023-10-26 23:18:29] iter = 0880, loss = 133.8720
[2023-10-26 23:18:31] iter = 0890, loss = 154.3059
[2023-10-26 23:18:32] iter = 0900, loss = 135.6177
[2023-10-26 23:18:34] iter = 0910, loss = 147.0969
[2023-10-26 23:18:36] iter = 0920, loss = 140.8667
[2023-10-26 23:18:38] iter = 0930, loss = 141.4757
[2023-10-26 23:18:39] iter = 0940, loss = 149.0372
[2023-10-26 23:18:41] iter = 0950, loss = 141.2163
[2023-10-26 23:18:43] iter = 0960, loss = 141.0925
[2023-10-26 23:18:44] iter = 0970, loss = 139.2555
[2023-10-26 23:18:46] iter = 0980, loss = 142.6777
[2023-10-26 23:18:48] iter = 0990, loss = 135.3715
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 23:18:52] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000590 train acc = 1.0000, test acc = 0.3198
[2023-10-26 23:18:55] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000652 train acc = 1.0000, test acc = 0.3151
[2023-10-26 23:18:58] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000598 train acc = 1.0000, test acc = 0.3084
[2023-10-26 23:19:00] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000612 train acc = 1.0000, test acc = 0.3094
[2023-10-26 23:19:03] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000571 train acc = 1.0000, test acc = 0.2957
[2023-10-26 23:19:06] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000629 train acc = 1.0000, test acc = 0.3171
[2023-10-26 23:19:09] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000621 train acc = 1.0000, test acc = 0.3020
[2023-10-26 23:19:11] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000631 train acc = 1.0000, test acc = 0.3143
[2023-10-26 23:19:14] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000633 train acc = 1.0000, test acc = 0.3039
[2023-10-26 23:19:17] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000619 train acc = 1.0000, test acc = 0.3243
[2023-10-26 23:19:20] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000629 train acc = 1.0000, test acc = 0.3035
[2023-10-26 23:19:22] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000598 train acc = 1.0000, test acc = 0.3071
[2023-10-26 23:19:25] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000647 train acc = 1.0000, test acc = 0.3083
[2023-10-26 23:19:28] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000608 train acc = 1.0000, test acc = 0.2926
[2023-10-26 23:19:31] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000621 train acc = 1.0000, test acc = 0.3110
[2023-10-26 23:19:33] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000592 train acc = 1.0000, test acc = 0.3170
[2023-10-26 23:19:36] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000614 train acc = 1.0000, test acc = 0.3122
[2023-10-26 23:19:39] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000634 train acc = 1.0000, test acc = 0.3100
[2023-10-26 23:19:41] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000651 train acc = 1.0000, test acc = 0.3140
[2023-10-26 23:19:44] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000632 train acc = 1.0000, test acc = 0.3032
Evaluate 20 random ConvNet, mean = 0.3094 std = 0.0077
-------------------------
[2023-10-26 23:19:44] iter = 1000, loss = 144.9351

================== Exp 4 ==================
 
Hyper-parameters: 
 {'method': 'DC', 'dataset': 'CIFAR10', 'model': 'ConvNet', 'ipc': 1, 'eval_mode': 'S', 'num_exp': 5, 'num_eval': 20, 'epoch_eval_train': 300, 'Iteration': 1000, 'lr_img': 0.1, 'lr_net': 0.01, 'batch_real': 256, 'batch_train': 256, 'init': 'noise', 'dsa_strategy': 'None', 'data_path': 'data', 'save_path': 'result', 'dis_metric': 'ours', 'outer_loop': 1, 'inner_loop': 1, 'device': 'cuda', 'dsa_param': <utils.ParamDiffAug object at 0x7f62efca4e20>, 'dsa': False, 'dc_aug_param': None}
Evaluation model pool:  ['ConvNet']
class c = 0: 5000 real images
class c = 1: 5000 real images
class c = 2: 5000 real images
class c = 3: 5000 real images
class c = 4: 5000 real images
class c = 5: 5000 real images
class c = 6: 5000 real images
class c = 7: 5000 real images
class c = 8: 5000 real images
class c = 9: 5000 real images
real images channel 0, mean = -0.0000, std = 1.2211
real images channel 1, mean = -0.0002, std = 1.2211
real images channel 2, mean = 0.0002, std = 1.3014
initialize synthetic data from random noise
[2023-10-26 23:20:00] training begins
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 0
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 23:20:03] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000411 train acc = 1.0000, test acc = 0.0705
[2023-10-26 23:20:06] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000398 train acc = 1.0000, test acc = 0.0702
[2023-10-26 23:20:09] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000424 train acc = 1.0000, test acc = 0.0658
[2023-10-26 23:20:11] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000421 train acc = 1.0000, test acc = 0.0823
[2023-10-26 23:20:14] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000411 train acc = 1.0000, test acc = 0.1158
[2023-10-26 23:20:17] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000420 train acc = 1.0000, test acc = 0.0767
[2023-10-26 23:20:20] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000412 train acc = 1.0000, test acc = 0.0796
[2023-10-26 23:20:22] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000417 train acc = 1.0000, test acc = 0.0724
[2023-10-26 23:20:25] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000412 train acc = 1.0000, test acc = 0.0797
[2023-10-26 23:20:28] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000422 train acc = 1.0000, test acc = 0.0766
[2023-10-26 23:20:31] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000428 train acc = 1.0000, test acc = 0.0727
[2023-10-26 23:20:33] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000408 train acc = 1.0000, test acc = 0.0676
[2023-10-26 23:20:36] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000425 train acc = 1.0000, test acc = 0.0830
[2023-10-26 23:20:39] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000392 train acc = 1.0000, test acc = 0.0697
[2023-10-26 23:20:42] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000406 train acc = 1.0000, test acc = 0.0758
[2023-10-26 23:20:44] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000401 train acc = 1.0000, test acc = 0.0761
[2023-10-26 23:20:47] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000412 train acc = 1.0000, test acc = 0.0666
[2023-10-26 23:20:50] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000400 train acc = 1.0000, test acc = 0.0696
[2023-10-26 23:20:53] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000395 train acc = 1.0000, test acc = 0.1019
[2023-10-26 23:20:55] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000384 train acc = 1.0000, test acc = 0.0683
Evaluate 20 random ConvNet, mean = 0.0770 std = 0.0119
-------------------------
[2023-10-26 23:20:56] iter = 0000, loss = 245.7286
[2023-10-26 23:20:58] iter = 0010, loss = 223.8470
[2023-10-26 23:20:59] iter = 0020, loss = 204.2574
[2023-10-26 23:21:01] iter = 0030, loss = 198.6630
[2023-10-26 23:21:03] iter = 0040, loss = 192.3830
[2023-10-26 23:21:04] iter = 0050, loss = 193.9953
[2023-10-26 23:21:06] iter = 0060, loss = 187.0069
[2023-10-26 23:21:08] iter = 0070, loss = 183.3323
[2023-10-26 23:21:09] iter = 0080, loss = 185.9453
[2023-10-26 23:21:11] iter = 0090, loss = 176.9886
[2023-10-26 23:21:13] iter = 0100, loss = 182.0826
[2023-10-26 23:21:14] iter = 0110, loss = 177.2551
[2023-10-26 23:21:16] iter = 0120, loss = 164.0667
[2023-10-26 23:21:18] iter = 0130, loss = 166.1875
[2023-10-26 23:21:19] iter = 0140, loss = 167.8306
[2023-10-26 23:21:21] iter = 0150, loss = 176.5435
[2023-10-26 23:21:23] iter = 0160, loss = 161.6339
[2023-10-26 23:21:25] iter = 0170, loss = 162.3882
[2023-10-26 23:21:26] iter = 0180, loss = 169.4136
[2023-10-26 23:21:28] iter = 0190, loss = 157.3245
[2023-10-26 23:21:30] iter = 0200, loss = 161.5688
[2023-10-26 23:21:31] iter = 0210, loss = 163.0991
[2023-10-26 23:21:33] iter = 0220, loss = 158.8043
[2023-10-26 23:21:35] iter = 0230, loss = 160.2562
[2023-10-26 23:21:37] iter = 0240, loss = 159.7387
[2023-10-26 23:21:39] iter = 0250, loss = 144.8076
[2023-10-26 23:21:40] iter = 0260, loss = 155.2436
[2023-10-26 23:21:42] iter = 0270, loss = 157.8107
[2023-10-26 23:21:44] iter = 0280, loss = 172.8963
[2023-10-26 23:21:46] iter = 0290, loss = 161.1140
[2023-10-26 23:21:47] iter = 0300, loss = 161.3387
[2023-10-26 23:21:49] iter = 0310, loss = 153.2958
[2023-10-26 23:21:51] iter = 0320, loss = 145.4249
[2023-10-26 23:21:53] iter = 0330, loss = 163.5898
[2023-10-26 23:21:54] iter = 0340, loss = 149.5597
[2023-10-26 23:21:56] iter = 0350, loss = 148.1821
[2023-10-26 23:21:58] iter = 0360, loss = 151.8562
[2023-10-26 23:22:00] iter = 0370, loss = 145.5454
[2023-10-26 23:22:02] iter = 0380, loss = 154.7571
[2023-10-26 23:22:03] iter = 0390, loss = 157.4948
[2023-10-26 23:22:05] iter = 0400, loss = 150.0128
[2023-10-26 23:22:07] iter = 0410, loss = 144.8564
[2023-10-26 23:22:08] iter = 0420, loss = 153.9250
[2023-10-26 23:22:10] iter = 0430, loss = 152.0865
[2023-10-26 23:22:12] iter = 0440, loss = 150.8374
[2023-10-26 23:22:14] iter = 0450, loss = 148.0155
[2023-10-26 23:22:15] iter = 0460, loss = 139.8263
[2023-10-26 23:22:17] iter = 0470, loss = 155.6446
[2023-10-26 23:22:19] iter = 0480, loss = 147.1373
[2023-10-26 23:22:21] iter = 0490, loss = 156.3751
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 500
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 23:22:25] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000596 train acc = 1.0000, test acc = 0.3082
[2023-10-26 23:22:27] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000592 train acc = 1.0000, test acc = 0.2989
[2023-10-26 23:22:30] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000588 train acc = 1.0000, test acc = 0.3093
[2023-10-26 23:22:33] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000575 train acc = 1.0000, test acc = 0.3189
[2023-10-26 23:22:36] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000577 train acc = 1.0000, test acc = 0.3132
[2023-10-26 23:22:38] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000589 train acc = 1.0000, test acc = 0.3157
[2023-10-26 23:22:41] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000562 train acc = 1.0000, test acc = 0.3119
[2023-10-26 23:22:44] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000582 train acc = 1.0000, test acc = 0.3080
[2023-10-26 23:22:47] Evaluate_08: epoch = 0300 train time = 0 s train loss = 0.000594 train acc = 1.0000, test acc = 0.3161
[2023-10-26 23:22:49] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000567 train acc = 1.0000, test acc = 0.3179
[2023-10-26 23:22:52] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000552 train acc = 1.0000, test acc = 0.3070
[2023-10-26 23:22:55] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000594 train acc = 1.0000, test acc = 0.3043
[2023-10-26 23:22:58] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000568 train acc = 1.0000, test acc = 0.2978
[2023-10-26 23:23:00] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000543 train acc = 1.0000, test acc = 0.3143
[2023-10-26 23:23:03] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000593 train acc = 1.0000, test acc = 0.3104
[2023-10-26 23:23:06] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000605 train acc = 1.0000, test acc = 0.3071
[2023-10-26 23:23:09] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000595 train acc = 1.0000, test acc = 0.3059
[2023-10-26 23:23:11] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000567 train acc = 1.0000, test acc = 0.3076
[2023-10-26 23:23:14] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000594 train acc = 1.0000, test acc = 0.3044
[2023-10-26 23:23:17] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000575 train acc = 1.0000, test acc = 0.3167
Evaluate 20 random ConvNet, mean = 0.3097 std = 0.0058
-------------------------
[2023-10-26 23:23:17] iter = 0500, loss = 150.2146
[2023-10-26 23:23:19] iter = 0510, loss = 149.9232
[2023-10-26 23:23:21] iter = 0520, loss = 137.7884
[2023-10-26 23:23:22] iter = 0530, loss = 145.3328
[2023-10-26 23:23:24] iter = 0540, loss = 137.7695
[2023-10-26 23:23:26] iter = 0550, loss = 146.7349
[2023-10-26 23:23:28] iter = 0560, loss = 151.9870
[2023-10-26 23:23:30] iter = 0570, loss = 152.6542
[2023-10-26 23:23:31] iter = 0580, loss = 149.2774
[2023-10-26 23:23:33] iter = 0590, loss = 146.9039
[2023-10-26 23:23:35] iter = 0600, loss = 144.1059
[2023-10-26 23:23:37] iter = 0610, loss = 145.2113
[2023-10-26 23:23:38] iter = 0620, loss = 145.1402
[2023-10-26 23:23:40] iter = 0630, loss = 139.2861
[2023-10-26 23:23:42] iter = 0640, loss = 137.5994
[2023-10-26 23:23:44] iter = 0650, loss = 145.3919
[2023-10-26 23:23:46] iter = 0660, loss = 141.9435
[2023-10-26 23:23:47] iter = 0670, loss = 140.9782
[2023-10-26 23:23:49] iter = 0680, loss = 144.1505
[2023-10-26 23:23:51] iter = 0690, loss = 153.8268
[2023-10-26 23:23:53] iter = 0700, loss = 142.3350
[2023-10-26 23:23:55] iter = 0710, loss = 148.7076
[2023-10-26 23:23:56] iter = 0720, loss = 146.2019
[2023-10-26 23:23:58] iter = 0730, loss = 150.1288
[2023-10-26 23:24:00] iter = 0740, loss = 150.3014
[2023-10-26 23:24:02] iter = 0750, loss = 136.1651
[2023-10-26 23:24:03] iter = 0760, loss = 132.3706
[2023-10-26 23:24:05] iter = 0770, loss = 136.5493
[2023-10-26 23:24:07] iter = 0780, loss = 131.5663
[2023-10-26 23:24:09] iter = 0790, loss = 137.4103
[2023-10-26 23:24:11] iter = 0800, loss = 153.6600
[2023-10-26 23:24:12] iter = 0810, loss = 150.5981
[2023-10-26 23:24:14] iter = 0820, loss = 141.7249
[2023-10-26 23:24:16] iter = 0830, loss = 139.2306
[2023-10-26 23:24:18] iter = 0840, loss = 139.8428
[2023-10-26 23:24:20] iter = 0850, loss = 137.5419
[2023-10-26 23:24:21] iter = 0860, loss = 150.6532
[2023-10-26 23:24:23] iter = 0870, loss = 138.2507
[2023-10-26 23:24:25] iter = 0880, loss = 152.3376
[2023-10-26 23:24:27] iter = 0890, loss = 144.3150
[2023-10-26 23:24:28] iter = 0900, loss = 137.7043
[2023-10-26 23:24:30] iter = 0910, loss = 132.7231
[2023-10-26 23:24:32] iter = 0920, loss = 142.7301
[2023-10-26 23:24:34] iter = 0930, loss = 143.1066
[2023-10-26 23:24:35] iter = 0940, loss = 147.9822
[2023-10-26 23:24:37] iter = 0950, loss = 137.3955
[2023-10-26 23:24:39] iter = 0960, loss = 131.6906
[2023-10-26 23:24:41] iter = 0970, loss = 142.5705
[2023-10-26 23:24:43] iter = 0980, loss = 144.0118
[2023-10-26 23:24:44] iter = 0990, loss = 138.5298
-------------------------
Evaluation
model_train = ConvNet, model_eval = ConvNet, iteration = 1000
DC augmentation parameters: 
 {'crop': 4, 'scale': 0.2, 'rotate': 45, 'noise': 0.001, 'strategy': 'none'}
[2023-10-26 23:24:49] Evaluate_00: epoch = 0300 train time = 1 s train loss = 0.000650 train acc = 1.0000, test acc = 0.3069
[2023-10-26 23:24:51] Evaluate_01: epoch = 0300 train time = 1 s train loss = 0.000574 train acc = 1.0000, test acc = 0.3007
[2023-10-26 23:24:54] Evaluate_02: epoch = 0300 train time = 1 s train loss = 0.000664 train acc = 1.0000, test acc = 0.3039
[2023-10-26 23:24:57] Evaluate_03: epoch = 0300 train time = 1 s train loss = 0.000624 train acc = 1.0000, test acc = 0.3122
[2023-10-26 23:25:00] Evaluate_04: epoch = 0300 train time = 1 s train loss = 0.000583 train acc = 1.0000, test acc = 0.3190
[2023-10-26 23:25:02] Evaluate_05: epoch = 0300 train time = 1 s train loss = 0.000597 train acc = 1.0000, test acc = 0.3146
[2023-10-26 23:25:05] Evaluate_06: epoch = 0300 train time = 1 s train loss = 0.000617 train acc = 1.0000, test acc = 0.3071
[2023-10-26 23:25:08] Evaluate_07: epoch = 0300 train time = 1 s train loss = 0.000624 train acc = 1.0000, test acc = 0.3083
[2023-10-26 23:25:11] Evaluate_08: epoch = 0300 train time = 1 s train loss = 0.000651 train acc = 1.0000, test acc = 0.3229
[2023-10-26 23:25:14] Evaluate_09: epoch = 0300 train time = 1 s train loss = 0.000624 train acc = 1.0000, test acc = 0.3174
[2023-10-26 23:25:16] Evaluate_10: epoch = 0300 train time = 1 s train loss = 0.000601 train acc = 1.0000, test acc = 0.3180
[2023-10-26 23:25:19] Evaluate_11: epoch = 0300 train time = 1 s train loss = 0.000646 train acc = 1.0000, test acc = 0.3222
[2023-10-26 23:25:22] Evaluate_12: epoch = 0300 train time = 1 s train loss = 0.000615 train acc = 1.0000, test acc = 0.3143
[2023-10-26 23:25:25] Evaluate_13: epoch = 0300 train time = 1 s train loss = 0.000642 train acc = 1.0000, test acc = 0.3239
[2023-10-26 23:25:27] Evaluate_14: epoch = 0300 train time = 1 s train loss = 0.000637 train acc = 1.0000, test acc = 0.3107
[2023-10-26 23:25:30] Evaluate_15: epoch = 0300 train time = 1 s train loss = 0.000603 train acc = 1.0000, test acc = 0.3030
[2023-10-26 23:25:33] Evaluate_16: epoch = 0300 train time = 1 s train loss = 0.000588 train acc = 1.0000, test acc = 0.3040
[2023-10-26 23:25:36] Evaluate_17: epoch = 0300 train time = 1 s train loss = 0.000599 train acc = 1.0000, test acc = 0.3132
[2023-10-26 23:25:38] Evaluate_18: epoch = 0300 train time = 1 s train loss = 0.000598 train acc = 1.0000, test acc = 0.3050
[2023-10-26 23:25:41] Evaluate_19: epoch = 0300 train time = 1 s train loss = 0.000675 train acc = 1.0000, test acc = 0.2944
Evaluate 20 random ConvNet, mean = 0.3111 std = 0.0079
-------------------------
[2023-10-26 23:25:41] iter = 1000, loss = 144.8845

==================== Final Results ====================

Run 5 experiments, train on ConvNet, evaluate 100 random ConvNet, mean  = 30.99%  std = 0.77%
